!function($){var touchTimeout,tapTimeout,swipeTimeout,longTapTimeout,gesture,down,up,move,eventMap,touch={},initialized=!1;function longTap(){longTapTimeout=null,touch.last&&(touch.el.trigger("longTap"),touch={})}function cancelLongTap(){longTapTimeout&&clearTimeout(longTapTimeout),longTapTimeout=null}function cancelAll(){touchTimeout&&clearTimeout(touchTimeout),tapTimeout&&clearTimeout(tapTimeout),swipeTimeout&&clearTimeout(swipeTimeout),longTapTimeout&&clearTimeout(longTapTimeout),touchTimeout=tapTimeout=swipeTimeout=longTapTimeout=null,touch={}}function isPrimaryTouch(event){return("touch"==event.pointerType||event.pointerType==event.MSPOINTER_TYPE_TOUCH)&&event.isPrimary}function isPointerEventType(e,type){return e.type=="pointer"+type||e.type.toLowerCase()=="mspointer"+type}function setup(__eventMap){var now,delta,firstTouch,_isPointerType,deltaX=0,deltaY=0;initialized&&($(document).off(eventMap.down,down).off(eventMap.up,up).off(eventMap.move,move).off(eventMap.cancel,cancelAll),$(window).off("scroll",cancelAll),cancelAll(),initialized=!1),(eventMap=__eventMap&&"down"in __eventMap?__eventMap:"ontouchstart"in document?{down:"touchstart",up:"touchend",move:"touchmove",cancel:"touchcancel"}:"onpointerdown"in document?{down:"pointerdown",up:"pointerup",move:"pointermove",cancel:"pointercancel"}:"onmspointerdown"in document&&{down:"MSPointerDown",up:"MSPointerUp",move:"MSPointerMove",cancel:"MSPointerCancel"})&&("MSGesture"in window&&((gesture=new MSGesture).target=document.body,$(document).bind("MSGestureEnd",function(e){var swipeDirectionFromVelocity=1<e.velocityX?"Right":e.velocityX<-1?"Left":1<e.velocityY?"Down":e.velocityY<-1?"Up":null;swipeDirectionFromVelocity&&(touch.el.trigger("swipe"),touch.el.trigger("swipe"+swipeDirectionFromVelocity))})),down=function(e){(_isPointerType=isPointerEventType(e,"down"))&&!isPrimaryTouch(e)||(firstTouch=_isPointerType?e:e.touches[0],e.touches&&1===e.touches.length&&touch.x2&&(touch.x2=void 0,touch.y2=void 0),now=Date.now(),delta=now-(touch.last||now),touch.el=$("tagName"in firstTouch.target?firstTouch.target:firstTouch.target.parentNode),touchTimeout&&clearTimeout(touchTimeout),touch.x1=firstTouch.pageX,touch.y1=firstTouch.pageY,0<delta&&delta<=250&&(touch.isDoubleTap=!0),touch.last=now,longTapTimeout=setTimeout(longTap,750),gesture&&_isPointerType&&gesture.addPointer(e.pointerId))},move=function(e){(_isPointerType=isPointerEventType(e,"move"))&&!isPrimaryTouch(e)||(firstTouch=_isPointerType?e:e.touches[0],cancelLongTap(),touch.x2=firstTouch.pageX,touch.y2=firstTouch.pageY,deltaX+=Math.abs(touch.x1-touch.x2),deltaY+=Math.abs(touch.y1-touch.y2))},up=function(e){(_isPointerType=isPointerEventType(e,"up"))&&!isPrimaryTouch(e)||(cancelLongTap(),touch.x2&&30<Math.abs(touch.x1-touch.x2)||touch.y2&&30<Math.abs(touch.y1-touch.y2)?swipeTimeout=setTimeout(function(){var x1,x2,y1,y2;touch.el&&(touch.el.trigger("swipe"),touch.el.trigger("swipe"+(x1=touch.x1,x2=touch.x2,y1=touch.y1,y2=touch.y2,Math.abs(x1-x2)>=Math.abs(y1-y2)?0<x1-x2?"Left":"Right":0<y1-y2?"Up":"Down"))),touch={}},0):"last"in touch&&(deltaX<30&&deltaY<30?tapTimeout=setTimeout(function(){var event=$.Event("tap");event.cancelTouch=cancelAll,touch.el&&touch.el.trigger(event),touch.isDoubleTap?(touch.el&&touch.el.trigger("doubleTap"),touch={}):touchTimeout=setTimeout(function(){touchTimeout=null,touch.el&&touch.el.trigger("singleTap"),touch={}},250)},0):touch={}),deltaX=deltaY=0)},$(document).on(eventMap.up,up).on(eventMap.down,down).on(eventMap.move,move),$(document).on(eventMap.cancel,cancelAll),$(window).on("scroll",cancelAll),initialized=!0)}["swipe","swipeLeft","swipeRight","swipeUp","swipeDown","doubleTap","tap","singleTap","longTap"].forEach(function(eventName){$.fn[eventName]=function(callback){return this.on(eventName,callback)}}),$.touch={setup:setup},$(document).ready(setup)}(Zepto);