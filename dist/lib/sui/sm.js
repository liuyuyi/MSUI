$.smVersion="0.6.2",function($){"use strict";$.smConfig=$.extend({autoInit:!1,showPageLoadingIndicator:!0,router:!0,swipePanel:"left",swipePanelOnlyClose:!0},$.config)}(Zepto),function($){"use strict";$.compareVersion=function(a,b){var as=a.split("."),bs=b.split(".");if(a===b)return 0;for(var i=0;i<as.length;i++){var x=parseInt(as[i]);if(!bs[i])return 1;var y=parseInt(bs[i]);if(x<y)return-1;if(y<x)return 1}return-1},$.getCurrentPage=function(){return $(".page-current")[0]||$(".page")[0]||document.body}}(Zepto),function($){"use strict";function __dealCssEvent(eventNameArr,callback){var i,events=eventNameArr,dom=this;function fireCallBack(e){if(e.target===this)for(callback.call(this,e),i=0;i<events.length;i++)dom.off(events[i],fireCallBack)}if(callback)for(i=0;i<events.length;i++)dom.on(events[i],fireCallBack)}["width","height"].forEach(function(dimension){var Dimension=dimension.replace(/./,function(m){return m[0].toUpperCase()});$.fn["outer"+Dimension]=function(margin){var elem=this;if(elem){var size=elem[dimension]();return{width:["left","right"],height:["top","bottom"]}[dimension].forEach(function(side){margin&&(size+=parseInt(elem.css("margin-"+side),10))}),size}return null}}),$.support={touch:!!("ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch)},$.touchEvents={start:$.support.touch?"touchstart":"mousedown",move:$.support.touch?"touchmove":"mousemove",end:$.support.touch?"touchend":"mouseup"},$.getTranslate=function(el,axis){var matrix,curTransform,curStyle,transformMatrix;return void 0===axis&&(axis="x"),curStyle=window.getComputedStyle(el,null),window.WebKitCSSMatrix?transformMatrix=new WebKitCSSMatrix("none"===curStyle.webkitTransform?"":curStyle.webkitTransform):matrix=(transformMatrix=curStyle.MozTransform||curStyle.transform||curStyle.getPropertyValue("transform").replace("translate(","matrix(1, 0, 0, 1,")).toString().split(","),"x"===axis&&(curTransform=window.WebKitCSSMatrix?transformMatrix.m41:16===matrix.length?parseFloat(matrix[12]):parseFloat(matrix[4])),"y"===axis&&(curTransform=window.WebKitCSSMatrix?transformMatrix.m42:16===matrix.length?parseFloat(matrix[13]):parseFloat(matrix[5])),curTransform||0},$.requestAnimationFrame=function(callback){return requestAnimationFrame?requestAnimationFrame(callback):webkitRequestAnimationFrame?webkitRequestAnimationFrame(callback):mozRequestAnimationFrame?mozRequestAnimationFrame(callback):setTimeout(callback,1e3/60)},$.cancelAnimationFrame=function(id){return cancelAnimationFrame?cancelAnimationFrame(id):webkitCancelAnimationFrame?webkitCancelAnimationFrame(id):mozCancelAnimationFrame?mozCancelAnimationFrame(id):clearTimeout(id)},$.fn.dataset=function(){var dataset={},ds=this[0].dataset;for(var key in ds){var item=dataset[key]=ds[key];"false"===item?dataset[key]=!1:"true"===item?dataset[key]=!0:parseFloat(item)===1*item&&(dataset[key]=1*item)}return $.extend({},dataset,this[0].__eleData)},$.fn.data=function(key,value){var tmpData=$(this).dataset();if(!key)return tmpData;if(void 0===value){var dataVal=tmpData[key],__eD=this[0].__eleData;return __eD&&key in __eD?__eD[key]:dataVal}for(var i=0;i<this.length;i++){var el=this[i];key in tmpData&&delete el.dataset[key],el.__eleData||(el.__eleData={}),el.__eleData[key]=value}return this},$.fn.animationEnd=function(callback){return __dealCssEvent.call(this,["webkitAnimationEnd","animationend"],callback),this},$.fn.transitionEnd=function(callback){return __dealCssEvent.call(this,["webkitTransitionEnd","transitionend"],callback),this},$.fn.transition=function(duration){"string"!=typeof duration&&(duration+="ms");for(var i=0;i<this.length;i++){var elStyle=this[i].style;elStyle.webkitTransitionDuration=elStyle.MozTransitionDuration=elStyle.transitionDuration=duration}return this},$.fn.transform=function(transform){for(var i=0;i<this.length;i++){var elStyle=this[i].style;elStyle.webkitTransform=elStyle.MozTransform=elStyle.transform=transform}return this},$.fn.prevAll=function(selector){var prevEls=[],el=this[0];if(!el)return $([]);for(;el.previousElementSibling;){var prev=el.previousElementSibling;selector?$(prev).is(selector)&&prevEls.push(prev):prevEls.push(prev),el=prev}return $(prevEls)},$.fn.nextAll=function(selector){var nextEls=[],el=this[0];if(!el)return $([]);for(;el.nextElementSibling;){var next=el.nextElementSibling;selector?$(next).is(selector)&&nextEls.push(next):nextEls.push(next),el=next}return $(nextEls)},$.fn.show=function(){var elementDisplay={};return this.each(function(){var nodeName,element,display;"none"===this.style.display&&(this.style.display=""),getComputedStyle(this,"").getPropertyValue("display"),this.style.display=(nodeName=this.nodeName,elementDisplay[nodeName]||(element=document.createElement(nodeName),document.body.appendChild(element),display=getComputedStyle(element,"").getPropertyValue("display"),element.parentNode.removeChild(element),"none"===display&&(display="block"),elementDisplay[nodeName]=display),elementDisplay[nodeName])})}}(Zepto),function($){"use strict";var device={},ua=navigator.userAgent,android=ua.match(/(Android);?[\s\/]+([\d.]+)?/),ipad=ua.match(/(iPad).*OS\s([\d_]+)/),ipod=ua.match(/(iPod)(.*OS\s([\d_]+))?/),iphone=!ipad&&ua.match(/(iPhone\sOS)\s([\d_]+)/);if(device.ios=device.android=device.iphone=device.ipad=device.androidChrome=!1,android&&(device.os="android",device.osVersion=android[2],device.android=!0,device.androidChrome=0<=ua.toLowerCase().indexOf("chrome")),(ipad||iphone||ipod)&&(device.os="ios",device.ios=!0),iphone&&!ipod&&(device.osVersion=iphone[2].replace(/_/g,"."),device.iphone=!0),ipad&&(device.osVersion=ipad[2].replace(/_/g,"."),device.ipad=!0),ipod&&(device.osVersion=ipod[3]?ipod[3].replace(/_/g,"."):null,device.iphone=!0),device.ios&&device.osVersion&&0<=ua.indexOf("Version/")&&"10"===device.osVersion.split(".")[0]&&(device.osVersion=ua.toLowerCase().split("version/")[1].split(" ")[0]),device.webView=(iphone||ipad||ipod)&&ua.match(/.*AppleWebKit(?!.*Safari)/i),device.os&&"ios"===device.os){var osVersionArr=device.osVersion.split(".");device.minimalUi=!device.webView&&(ipod||iphone)&&(1*osVersionArr[0]==7?1<=1*osVersionArr[1]:7<1*osVersionArr[0])&&0<$('meta[name="viewport"]').length&&0<=$('meta[name="viewport"]').attr("content").indexOf("minimal-ui")}var windowWidth=$(window).width(),windowHeight=$(window).height();device.statusBar=!1,device.webView&&windowWidth*windowHeight==screen.width*screen.height?device.statusBar=!0:device.statusBar=!1;var classNames=[];if(device.pixelRatio=window.devicePixelRatio||1,classNames.push("pixel-ratio-"+Math.floor(device.pixelRatio)),2<=device.pixelRatio&&classNames.push("retina"),device.os&&(classNames.push(device.os,device.os+"-"+device.osVersion.split(".")[0],device.os+"-"+device.osVersion.replace(/\./g,"-")),"ios"===device.os))for(var i=parseInt(device.osVersion.split(".")[0],10)-1;6<=i;i--)classNames.push("ios-gt-"+i);device.statusBar?classNames.push("with-statusbar-overlay"):$("html").removeClass("with-statusbar-overlay"),0<classNames.length&&$("html").addClass(classNames.join(" ")),device.isWeixin=/MicroMessenger/i.test(ua),$.device=device}(Zepto),function(){"use strict";function FastClick(layer,options){var oldOnClick;if(options=options||{},this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=options.touchBoundary||10,this.layer=layer,this.tapDelay=options.tapDelay||200,this.tapTimeout=options.tapTimeout||700,!FastClick.notNeeded(layer)){for(var methods=["onMouse","onClick","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel"],i=0,l=methods.length;i<l;i++)this[methods[i]]=bind(this[methods[i]],this);deviceIsAndroid&&(layer.addEventListener("mouseover",this.onMouse,!0),layer.addEventListener("mousedown",this.onMouse,!0),layer.addEventListener("mouseup",this.onMouse,!0)),layer.addEventListener("click",this.onClick,!0),layer.addEventListener("touchstart",this.onTouchStart,!1),layer.addEventListener("touchmove",this.onTouchMove,!1),layer.addEventListener("touchend",this.onTouchEnd,!1),layer.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(layer.removeEventListener=function(type,callback,capture){var rmv=Node.prototype.removeEventListener;"click"===type?rmv.call(layer,type,callback.hijacked||callback,capture):rmv.call(layer,type,callback,capture)},layer.addEventListener=function(type,callback,capture){var adv=Node.prototype.addEventListener;"click"===type?adv.call(layer,type,callback.hijacked||(callback.hijacked=function(event){event.propagationStopped||callback(event)}),capture):adv.call(layer,type,callback,capture)}),"function"==typeof layer.onclick&&(oldOnClick=layer.onclick,layer.addEventListener("click",function(event){oldOnClick(event)},!1),layer.onclick=null)}function bind(method,context){return function(){return method.apply(context,arguments)}}}var deviceIsWindowsPhone=0<=navigator.userAgent.indexOf("Windows Phone"),deviceIsAndroid=0<navigator.userAgent.indexOf("Android")&&!deviceIsWindowsPhone,deviceIsIOS=/iP(ad|hone|od)/.test(navigator.userAgent)&&!deviceIsWindowsPhone,deviceIsIOS4=deviceIsIOS&&/OS 4_\d(_\d)?/.test(navigator.userAgent),deviceIsIOSWithBadTarget=deviceIsIOS&&/OS [6-7]_\d/.test(navigator.userAgent),deviceIsBlackBerry10=0<navigator.userAgent.indexOf("BB10"),isCompositeLabel=!1;FastClick.prototype.needsClick=function(target){for(var parent=target;parent&&"BODY"!==parent.tagName.toUpperCase();){if("LABEL"===parent.tagName.toUpperCase()&&(isCompositeLabel=!0,/\bneedsclick\b/.test(parent.className)))return!0;parent=parent.parentNode}switch(target.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(target.disabled)return!0;break;case"input":if(deviceIsIOS&&"file"===target.type||target.disabled)return!0;break;case"label":case"iframe":case"video":return!0}return/\bneedsclick\b/.test(target.className)},FastClick.prototype.needsFocus=function(target){switch(target.nodeName.toLowerCase()){case"textarea":return!0;case"select":return!deviceIsAndroid;case"input":switch(target.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!target.disabled&&!target.readOnly;default:return/\bneedsfocus\b/.test(target.className)}},FastClick.prototype.sendClick=function(targetElement,event){var clickEvent,touch;document.activeElement&&document.activeElement!==targetElement&&document.activeElement.blur(),touch=event.changedTouches[0],(clickEvent=document.createEvent("MouseEvents")).initMouseEvent(this.determineEventType(targetElement),!0,!0,window,1,touch.screenX,touch.screenY,touch.clientX,touch.clientY,!1,!1,!1,!1,0,null),clickEvent.forwardedTouchEvent=!0,targetElement.dispatchEvent(clickEvent)},FastClick.prototype.determineEventType=function(targetElement){return deviceIsAndroid&&"select"===targetElement.tagName.toLowerCase()?"mousedown":"click"},FastClick.prototype.focus=function(targetElement){var length;deviceIsIOS&&targetElement.setSelectionRange&&-1===["date","time","month","number","email"].indexOf(targetElement.type)?(length=targetElement.value.length,targetElement.setSelectionRange(length,length)):targetElement.focus()},FastClick.prototype.updateScrollParent=function(targetElement){var scrollParent,parentElement;if(!(scrollParent=targetElement.fastClickScrollParent)||!scrollParent.contains(targetElement)){parentElement=targetElement;do{if(parentElement.scrollHeight>parentElement.offsetHeight){scrollParent=parentElement,targetElement.fastClickScrollParent=parentElement;break}parentElement=parentElement.parentElement}while(parentElement)}scrollParent&&(scrollParent.fastClickLastScrollTop=scrollParent.scrollTop)},FastClick.prototype.getTargetElementFromEventTarget=function(eventTarget){return eventTarget.nodeType===Node.TEXT_NODE?eventTarget.parentNode:eventTarget},FastClick.prototype.onTouchStart=function(event){var targetElement,touch,selection;if(1<event.targetTouches.length)return!0;if(targetElement=this.getTargetElementFromEventTarget(event.target),touch=event.targetTouches[0],deviceIsIOS){if((selection=window.getSelection()).rangeCount&&!selection.isCollapsed)return!0;if(!deviceIsIOS4){if(touch.identifier&&touch.identifier===this.lastTouchIdentifier)return event.preventDefault(),!1;this.lastTouchIdentifier=touch.identifier,this.updateScrollParent(targetElement)}}return this.trackingClick=!0,this.trackingClickStart=event.timeStamp,this.targetElement=targetElement,this.touchStartX=touch.pageX,this.touchStartY=touch.pageY,event.timeStamp-this.lastClickTime<this.tapDelay&&event.preventDefault(),!0},FastClick.prototype.touchHasMoved=function(event){var touch=event.changedTouches[0],boundary=this.touchBoundary;return Math.abs(touch.pageX-this.touchStartX)>boundary||Math.abs(touch.pageY-this.touchStartY)>boundary},FastClick.prototype.onTouchMove=function(event){return this.trackingClick&&(this.targetElement!==this.getTargetElementFromEventTarget(event.target)||this.touchHasMoved(event))&&(this.trackingClick=!1,this.targetElement=null),!0},FastClick.prototype.findControl=function(labelElement){return void 0!==labelElement.control?labelElement.control:labelElement.htmlFor?document.getElementById(labelElement.htmlFor):labelElement.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},FastClick.prototype.onTouchEnd=function(event){var forElement,trackingClickStart,targetTagName,scrollParent,touch,targetElement=this.targetElement;if(!this.trackingClick)return!0;if(event.timeStamp-this.lastClickTime<this.tapDelay)return this.cancelNextClick=!0;if(event.timeStamp-this.trackingClickStart>this.tapTimeout)return!0;if(-1!==["date","time","month"].indexOf(event.target.type))return!1;if(this.cancelNextClick=!1,this.lastClickTime=event.timeStamp,trackingClickStart=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,deviceIsIOSWithBadTarget&&(touch=event.changedTouches[0],(targetElement=document.elementFromPoint(touch.pageX-window.pageXOffset,touch.pageY-window.pageYOffset)||targetElement).fastClickScrollParent=this.targetElement.fastClickScrollParent),"label"===(targetTagName=targetElement.tagName.toLowerCase())){if(forElement=this.findControl(targetElement)){if(this.focus(targetElement),deviceIsAndroid)return!1;targetElement=forElement}}else if(this.needsFocus(targetElement))return 100<event.timeStamp-trackingClickStart||deviceIsIOS&&window.top!==window&&"input"===targetTagName?this.targetElement=null:(this.focus(targetElement),this.sendClick(targetElement,event),deviceIsIOS&&"select"===targetTagName||(this.targetElement=null,event.preventDefault())),!1;return!(!deviceIsIOS||deviceIsIOS4||!(scrollParent=targetElement.fastClickScrollParent)||scrollParent.fastClickLastScrollTop===scrollParent.scrollTop)||(this.needsClick(targetElement)||(event.preventDefault(),this.sendClick(targetElement,event)),!1)},FastClick.prototype.onTouchCancel=function(){this.trackingClick=!1,this.targetElement=null},FastClick.prototype.onMouse=function(event){return!this.targetElement||(!!event.forwardedTouchEvent||(!event.cancelable||(!(!this.needsClick(this.targetElement)||this.cancelNextClick)||(event.stopImmediatePropagation?event.stopImmediatePropagation():event.propagationStopped=!0,event.stopPropagation(),isCompositeLabel||event.preventDefault(),!1))))},FastClick.prototype.onClick=function(event){var permitted;return this.trackingClick?(this.targetElement=null,!(this.trackingClick=!1)):"submit"===event.target.type&&0===event.detail||((permitted=this.onMouse(event))||(this.targetElement=null),permitted)},FastClick.prototype.destroy=function(){var layer=this.layer;deviceIsAndroid&&(layer.removeEventListener("mouseover",this.onMouse,!0),layer.removeEventListener("mousedown",this.onMouse,!0),layer.removeEventListener("mouseup",this.onMouse,!0)),layer.removeEventListener("click",this.onClick,!0),layer.removeEventListener("touchstart",this.onTouchStart,!1),layer.removeEventListener("touchmove",this.onTouchMove,!1),layer.removeEventListener("touchend",this.onTouchEnd,!1),layer.removeEventListener("touchcancel",this.onTouchCancel,!1)},FastClick.notNeeded=function(layer){var metaViewport,chromeVersion,blackberryVersion;if(void 0===window.ontouchstart)return!0;if(chromeVersion=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]){if(!deviceIsAndroid)return!0;if(metaViewport=document.querySelector("meta[name=viewport]")){if(-1!==metaViewport.content.indexOf("user-scalable=no"))return!0;if(31<chromeVersion&&document.documentElement.scrollWidth<=window.outerWidth)return!0}}if(deviceIsBlackBerry10&&10<=(blackberryVersion=navigator.userAgent.match(/Version\/([0-9]*)\.([0-9]*)/))[1]&&3<=blackberryVersion[2]&&(metaViewport=document.querySelector("meta[name=viewport]"))){if(-1!==metaViewport.content.indexOf("user-scalable=no"))return!0;if(document.documentElement.scrollWidth<=window.outerWidth)return!0}return"none"===layer.style.msTouchAction||"manipulation"===layer.style.touchAction||(!!(27<=+(/Firefox\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]&&(metaViewport=document.querySelector("meta[name=viewport]"))&&(-1!==metaViewport.content.indexOf("user-scalable=no")||document.documentElement.scrollWidth<=window.outerWidth))||("none"===layer.style.touchAction||"manipulation"===layer.style.touchAction))},FastClick.attach=function(layer,options){return new FastClick(layer,options)},window.FastClick=FastClick}(),function($){"use strict";var _modalTemplateTempDiv=document.createElement("div");$.modalStack=[],$.modalStackClearQueue=function(){$.modalStack.length&&$.modalStack.shift()()},$.modal=function(params){var modalHTML,buttonsHTML="";if((params=params||{}).buttons&&0<params.buttons.length)for(var i=0;i<params.buttons.length;i++)buttonsHTML+='<span class="modal-button'+(params.buttons[i].bold?" modal-button-bold":"")+'">'+params.buttons[i].text+"</span>";var extraClass=params.extraClass||"",titleHTML=params.title?'<div class="modal-title">'+params.title+"</div>":"",textHTML=params.text?'<div class="modal-text">'+params.text+"</div>":"",afterTextHTML=params.afterText?params.afterText:"";modalHTML='<div class="modal '+extraClass+" "+(params.buttons&&0!==params.buttons.length?"":"modal-no-buttons")+'"><div class="modal-inner">'+(titleHTML+textHTML+afterTextHTML)+'</div><div class="modal-buttons '+(params.verticalButtons?"modal-buttons-vertical":"")+'">'+buttonsHTML+"</div></div>",_modalTemplateTempDiv.innerHTML=modalHTML;var modal=$(_modalTemplateTempDiv).children();return $(defaults.modalContainer).append(modal[0]),modal.find(".modal-button").each(function(index,el){$(el).on("click",function(e){!1!==params.buttons[index].close&&$.closeModal(modal),params.buttons[index].onClick&&params.buttons[index].onClick(modal,e),params.onClick&&params.onClick(modal,index)})}),$.openModal(modal),modal[0]},$.alert=function(text,title,callbackOk){return"function"==typeof title&&(callbackOk=arguments[1],title=void 0),$.modal({text:text||"",title:void 0===title?defaults.modalTitle:title,buttons:[{text:defaults.modalButtonOk,bold:!0,onClick:callbackOk}]})},$.confirm=function(text,title,callbackOk,callbackCancel){return"function"==typeof title&&(callbackCancel=arguments[2],callbackOk=arguments[1],title=void 0),$.modal({text:text||"",title:void 0===title?defaults.modalTitle:title,buttons:[{text:defaults.modalButtonCancel,onClick:callbackCancel},{text:defaults.modalButtonOk,bold:!0,onClick:callbackOk}]})},$.prompt=function(text,title,callbackOk,callbackCancel){return"function"==typeof title&&(callbackCancel=arguments[2],callbackOk=arguments[1],title=void 0),$.modal({text:text||"",title:void 0===title?defaults.modalTitle:title,afterText:'<input type="text" class="modal-text-input">',buttons:[{text:defaults.modalButtonCancel},{text:defaults.modalButtonOk,bold:!0}],onClick:function(modal,index){0===index&&callbackCancel&&callbackCancel($(modal).find(".modal-text-input").val()),1===index&&callbackOk&&callbackOk($(modal).find(".modal-text-input").val())}})},$.modalLogin=function(text,title,callbackOk,callbackCancel){return"function"==typeof title&&(callbackCancel=arguments[2],callbackOk=arguments[1],title=void 0),$.modal({text:text||"",title:void 0===title?defaults.modalTitle:title,afterText:'<input type="text" name="modal-username" placeholder="'+defaults.modalUsernamePlaceholder+'" class="modal-text-input modal-text-input-double"><input type="password" name="modal-password" placeholder="'+defaults.modalPasswordPlaceholder+'" class="modal-text-input modal-text-input-double">',buttons:[{text:defaults.modalButtonCancel},{text:defaults.modalButtonOk,bold:!0}],onClick:function(modal,index){var username=$(modal).find('.modal-text-input[name="modal-username"]').val(),password=$(modal).find('.modal-text-input[name="modal-password"]').val();0===index&&callbackCancel&&callbackCancel(username,password),1===index&&callbackOk&&callbackOk(username,password)}})},$.modalPassword=function(text,title,callbackOk,callbackCancel){return"function"==typeof title&&(callbackCancel=arguments[2],callbackOk=arguments[1],title=void 0),$.modal({text:text||"",title:void 0===title?defaults.modalTitle:title,afterText:'<input type="password" name="modal-password" placeholder="'+defaults.modalPasswordPlaceholder+'" class="modal-text-input">',buttons:[{text:defaults.modalButtonCancel},{text:defaults.modalButtonOk,bold:!0}],onClick:function(modal,index){var password=$(modal).find('.modal-text-input[name="modal-password"]').val();0===index&&callbackCancel&&callbackCancel(password),1===index&&callbackOk&&callbackOk(password)}})},$.showPreloader=function(title){return $.hidePreloader(),$.showPreloader.preloaderModal=$.modal({title:title||defaults.modalPreloaderTitle,text:'<div class="preloader"></div>'}),$.showPreloader.preloaderModal},$.hidePreloader=function(){$.showPreloader.preloaderModal&&$.closeModal($.showPreloader.preloaderModal)},$.showIndicator=function(){$(".preloader-indicator-modal")[0]||$(defaults.modalContainer).append('<div class="preloader-indicator-overlay"></div><div class="preloader-indicator-modal"><span class="preloader preloader-white"></span></div>')},$.hideIndicator=function(){$(".preloader-indicator-overlay, .preloader-indicator-modal").remove()},$.actions=function(params){var modal,modalHTML;0<(params=params||[]).length&&!$.isArray(params[0])&&(params=[params]);for(var buttonsHTML="",i=0;i<params.length;i++)for(var j=0;j<params[i].length;j++){0===j&&(buttonsHTML+='<div class="actions-modal-group">');var button=params[i][j],buttonClass=button.label?"actions-modal-label":"actions-modal-button";button.bold&&(buttonClass+=" actions-modal-button-bold"),button.color&&(buttonClass+=" color-"+button.color),button.bg&&(buttonClass+=" bg-"+button.bg),button.disabled&&(buttonClass+=" disabled"),buttonsHTML+='<span class="'+buttonClass+'">'+button.text+"</span>",j===params[i].length-1&&(buttonsHTML+="</div>")}return modalHTML='<div class="actions-modal">'+buttonsHTML+"</div>",_modalTemplateTempDiv.innerHTML=modalHTML,modal=$(_modalTemplateTempDiv).children(),$(defaults.modalContainer).append(modal[0]),".actions-modal-group",".actions-modal-button",modal.find(".actions-modal-group").each(function(index,el){var groupIndex=index;$(el).children().each(function(index,el){var clickTarget,buttonIndex=index,buttonParams=params[groupIndex][buttonIndex];$(el).is(".actions-modal-button")&&(clickTarget=$(el)),clickTarget&&clickTarget.on("click",function(e){!1!==buttonParams.close&&$.closeModal(modal),buttonParams.onClick&&buttonParams.onClick(modal,e)})})}),$.openModal(modal),modal[0]},$.popup=function(modal,removeOnClose){if(void 0===removeOnClose&&(removeOnClose=!0),"string"==typeof modal&&0<=modal.indexOf("<")){var _modal=document.createElement("div");if(_modal.innerHTML=modal.trim(),!(0<_modal.childNodes.length))return!1;modal=_modal.childNodes[0],removeOnClose&&modal.classList.add("remove-on-close"),$(defaults.modalContainer).append(modal)}return 0!==(modal=$(modal)).length&&("block"!==modal.css("display")?(modal.show(),modal.find(".content").scroller("refresh"),0<modal.find("."+defaults.viewClass).length&&$.sizeNavbars(modal.find("."+defaults.viewClass)[0]),$.openModal(modal),modal[0]):void 0)},$.pickerModal=function(pickerModal,removeOnClose){if(void 0===removeOnClose&&(removeOnClose=!0),"string"==typeof pickerModal&&0<=pickerModal.indexOf("<")){if(!(0<(pickerModal=$(pickerModal)).length))return!1;removeOnClose&&pickerModal.addClass("remove-on-close"),$(defaults.modalContainer).append(pickerModal[0])}return 0!==(pickerModal=$(pickerModal)).length&&(pickerModal.show(),$.openModal(pickerModal),pickerModal[0])},$.loginScreen=function(modal){return modal||(modal=".login-screen"),0!==(modal=$(modal)).length&&(modal.show(),0<modal.find("."+defaults.viewClass).length&&$.sizeNavbars(modal.find("."+defaults.viewClass)[0]),$.openModal(modal),modal[0])},$.toast=function(msg,duration,extraclass){$(".toast").remove();var $toast=$('<div class="modal toast '+(extraclass||"")+'">'+msg+"</div>").appendTo(document.body);$.openModal($toast,function(){setTimeout(function(){$.closeModal($toast)},duration||1e3)})},$.openModal=function(modal,cb){var isModal=(modal=$(modal)).hasClass("modal"),isNotToast=!modal.hasClass("toast");if(!($(".modal.modal-in:not(.modal-out)").length&&defaults.modalStack&&isModal&&isNotToast)){var overlay,isPopup=modal.hasClass("popup"),isLoginScreen=modal.hasClass("login-screen"),isPickerModal=modal.hasClass("picker-modal"),isToast=modal.hasClass("toast");isModal&&modal.show(),isLoginScreen||isPickerModal||isToast||(0!==$(".modal-overlay").length||isPopup||$(defaults.modalContainer).append('<div class="modal-overlay"></div>'),0===$(".popup-overlay").length&&isPopup&&$(defaults.modalContainer).append('<div class="popup-overlay"></div>'),overlay=$(isPopup?".popup-overlay":".modal-overlay"));modal[0].clientLeft;return modal.trigger("open"),isPickerModal&&$(defaults.modalContainer).addClass("with-picker-modal"),isLoginScreen||isPickerModal||isToast||overlay.addClass("modal-overlay-visible"),modal.removeClass("modal-out").addClass("modal-in").transitionEnd(function(e){modal.hasClass("modal-out")?modal.trigger("closed"):modal.trigger("opened")}),"function"==typeof cb&&cb.call(this),!0}$.modalStack.push(function(){$.openModal(modal,cb)})},$.closeModal=function(modal){if(void 0===(modal=$(modal||".modal-in"))||0!==modal.length){var isModal=modal.hasClass("modal"),isPopup=modal.hasClass("popup"),isToast=modal.hasClass("toast"),isLoginScreen=modal.hasClass("login-screen"),isPickerModal=modal.hasClass("picker-modal"),removeOnClose=modal.hasClass("remove-on-close"),overlay=$(isPopup?".popup-overlay":".modal-overlay");return isPopup?modal.length===$(".popup.modal-in").length&&overlay.removeClass("modal-overlay-visible").remove():isPickerModal||isToast||overlay.removeClass("modal-overlay-visible"),modal.trigger("close"),isPickerModal&&($(defaults.modalContainer).removeClass("with-picker-modal"),$(defaults.modalContainer).addClass("picker-modal-closing")),modal.removeClass("modal-in").addClass("modal-out").transitionEnd(function(e){modal.hasClass("modal-out")?modal.trigger("closed"):modal.trigger("opened"),isPickerModal&&$(defaults.modalContainer).removeClass("picker-modal-closing"),isPopup||isLoginScreen||isPickerModal?(modal.removeClass("modal-out").hide(),removeOnClose&&0<modal.length&&modal.remove()):modal.remove()}),isModal&&defaults.modalStack&&$.modalStackClearQueue(),!0}},$(document).on("click"," .modal-overlay, .popup-overlay, .close-popup, .open-popup, .close-picker",function(e){var popup,clicked=$(this),clickedData=(clicked.attr("href"),clicked.dataset());clicked.hasClass("open-popup")&&(popup=clickedData.popup?clickedData.popup:".popup",$.popup(popup)),clicked.hasClass("close-popup")&&(popup=clickedData.popup?clickedData.popup:".popup.modal-in",$.closeModal(popup)),clicked.hasClass("modal-overlay")&&(0<$(".modal.modal-in").length&&defaults.modalCloseByOutside&&$.closeModal(".modal.modal-in"),0<$(".actions-modal.modal-in").length&&defaults.actionsCloseByOutside&&$.closeModal(".actions-modal.modal-in")),clicked.hasClass("popup-overlay")&&0<$(".popup.modal-in").length&&defaults.popupCloseByOutside&&$.closeModal(".popup.modal-in"),Public.hideMask()});var defaults=$.modal.prototype.defaults={modalStack:!0,modalButtonOk:"确定",modalButtonCancel:"取消",modalPreloaderTitle:"加载中",modalContainer:document.body}}(Zepto),function($){"use strict";var Calendar=function(params){var p=this,defaults={monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],monthNamesShort:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],dayNames:["周日","周一","周二","周三","周四","周五","周六"],dayNamesShort:["周日","周一","周二","周三","周四","周五","周六"],firstDay:1,weekendDays:[0,6],multiple:!1,dateFormat:"yyyy-mm-dd",direction:"horizontal",minDate:null,maxDate:null,touchMove:!0,animate:!0,closeOnSelect:!0,monthPicker:!0,monthPickerTemplate:'<div class="picker-calendar-month-picker"><a href="#" class="link icon-only picker-calendar-prev-month"><i class="icon icon-prev"></i></a><div class="current-month-value"></div><a href="#" class="link icon-only picker-calendar-next-month"><i class="icon icon-next"></i></a></div>',yearPicker:!0,yearPickerTemplate:'<div class="picker-calendar-year-picker"><a href="#" class="link icon-only picker-calendar-prev-year"><i class="icon icon-prev"></i></a><span class="current-year-value"></span><a href="#" class="link icon-only picker-calendar-next-year"><i class="icon icon-next"></i></a></div>',weekHeader:!0,scrollToInput:!0,inputReadOnly:!0,toolbar:!0,toolbarCloseText:"Done",toolbarTemplate:'<div class="toolbar"><div class="toolbar-inner">{{monthPicker}}{{yearPicker}}</div></div>'};for(var def in params=params||{},defaults)void 0===params[def]&&(params[def]=defaults[def]);p.params=params,p.initialized=!1,p.inline=!!p.params.container,p.isH="horizontal"===p.params.direction;var inverter=(p.isH,1);function formatDate(date){var year=(date=new Date(date)).getFullYear(),month=date.getMonth(),month1=month+1,day=date.getDate(),weekDay=date.getDay();return p.params.dateFormat.replace(/yyyy/g,year).replace(/yy/g,(year+"").substring(2)).replace(/mm/g,month1<10?"0"+month1:month1).replace(/m/g,month1).replace(/MM/g,p.params.monthNames[month]).replace(/M/g,p.params.monthNamesShort[month]).replace(/dd/g,day<10?"0"+day:day).replace(/d/g,day).replace(/DD/g,p.params.dayNames[weekDay]).replace(/D/g,p.params.dayNamesShort[weekDay])}function openOnInput(e){if(e.preventDefault(),$.device.isWeixin&&$.device.android&&p.params.inputReadOnly&&(this.focus(),this.blur()),!p.opened&&(p.open(),p.params.scrollToInput)){var pageContent=p.input.parents(".content");if(0===pageContent.length)return;var newPaddingBottom,paddingTop=parseInt(pageContent.css("padding-top"),10),paddingBottom=parseInt(pageContent.css("padding-bottom"),10),pageHeight=pageContent[0].offsetHeight-paddingTop-p.container.height(),pageScrollHeight=pageContent[0].scrollHeight-paddingTop-p.container.height(),inputTop=p.input.offset().top-paddingTop+p.input[0].offsetHeight;if(pageHeight<inputTop){var scrollTop=pageContent.scrollTop()+inputTop-pageHeight;pageScrollHeight<scrollTop+pageHeight&&(newPaddingBottom=scrollTop+pageHeight-pageScrollHeight+paddingBottom,pageHeight===pageScrollHeight&&(newPaddingBottom=p.container.height()),pageContent.css({"padding-bottom":newPaddingBottom+"px"})),pageContent.scrollTop(scrollTop,300)}}}function closeOnHTMLClick(e){p.input&&0<p.input.length?e.target!==p.input[0]&&0===$(e.target).parents(".picker-modal").length&&p.close():0===$(e.target).parents(".picker-modal").length&&p.close()}return p.animating=!1,p.addValue=function(value){if(p.params.multiple){var inValuesIndex;p.value||(p.value=[]);for(var i=0;i<p.value.length;i++)new Date(value).getTime()===new Date(p.value[i]).getTime()&&(inValuesIndex=i);void 0===inValuesIndex?p.value.push(value):p.value.splice(inValuesIndex,1),p.updateValue()}else p.value=[value],p.updateValue()},p.setValue=function(arrValues){p.value=arrValues,p.updateValue()},p.updateValue=function(){var i,inputValue;for(p.wrapper.find(".picker-calendar-day-selected").removeClass("picker-calendar-day-selected"),i=0;i<p.value.length;i++){var valueDate=new Date(p.value[i]);p.wrapper.find('.picker-calendar-day[data-date="'+valueDate.getFullYear()+"-"+valueDate.getMonth()+"-"+valueDate.getDate()+'"]').addClass("picker-calendar-day-selected")}if(p.params.onChange&&p.params.onChange(p,p.value,p.value.map(formatDate)),p.input&&0<p.input.length){if(p.params.formatValue)inputValue=p.params.formatValue(p,p.value);else{for(inputValue=[],i=0;i<p.value.length;i++)inputValue.push(formatDate(p.value[i]));inputValue=inputValue.join(", ")}$(p.input).val(inputValue),$(p.input).trigger("change")}},p.initCalendarEvents=function(){var isTouched,isMoved,touchStartX,touchStartY,touchCurrentX,touchCurrentY,touchStartTime,currentTranslate,wrapperWidth,wrapperHeight,percentage,touchesDiff,isScrolling,allowItemClick=!0;function handleTouchStart(e){isMoved||isTouched||(isTouched=!0,touchStartX=touchCurrentY="touchstart"===e.type?e.targetTouches[0].pageX:e.pageX,touchStartY=touchCurrentY="touchstart"===e.type?e.targetTouches[0].pageY:e.pageY,touchStartTime=(new Date).getTime(),allowItemClick=!(percentage=0),isScrolling=void 0,currentTranslate=p.monthsTranslate)}function handleTouchMove(e){isTouched&&(touchCurrentX="touchmove"===e.type?e.targetTouches[0].pageX:e.pageX,touchCurrentY="touchmove"===e.type?e.targetTouches[0].pageY:e.pageY,void 0===isScrolling&&(isScrolling=!!(isScrolling||Math.abs(touchCurrentY-touchStartY)>Math.abs(touchCurrentX-touchStartX))),p.isH&&isScrolling?isTouched=!1:(e.preventDefault(),p.animating?isTouched=!1:(allowItemClick=!1,isMoved||(isMoved=!0,wrapperWidth=p.wrapper[0].offsetWidth,wrapperHeight=p.wrapper[0].offsetHeight,p.wrapper.transition(0)),e.preventDefault(),touchesDiff=p.isH?touchCurrentX-touchStartX:touchCurrentY-touchStartY,percentage=touchesDiff/(p.isH?wrapperWidth:wrapperHeight),currentTranslate=100*(p.monthsTranslate*inverter+percentage),p.wrapper.transform("translate3d("+(p.isH?currentTranslate:0)+"%, "+(p.isH?0:currentTranslate)+"%, 0)"))))}function handleTouchEnd(e){isTouched&&isMoved?(isTouched=isMoved=!1,(new Date).getTime()-touchStartTime<300?Math.abs(touchesDiff)<10?p.resetMonth():10<=touchesDiff?p.prevMonth():p.nextMonth():percentage<=-.5?p.nextMonth():.5<=percentage?p.prevMonth():p.resetMonth(),setTimeout(function(){allowItemClick=!0},100)):isTouched=isMoved=!1}function handleDayClick(e){if(allowItemClick){var day=$(e.target).parents(".picker-calendar-day");if(0===day.length&&$(e.target).hasClass("picker-calendar-day")&&(day=$(e.target)),0!==day.length&&(!day.hasClass("picker-calendar-day-selected")||p.params.multiple)&&!day.hasClass("picker-calendar-day-disabled")){day.hasClass("picker-calendar-day-next")&&p.nextMonth(),day.hasClass("picker-calendar-day-prev")&&p.prevMonth();var dateYear=day.attr("data-year"),dateMonth=day.attr("data-month"),dateDay=day.attr("data-day");p.params.onDayClick&&p.params.onDayClick(p,day[0],dateYear,dateMonth,dateDay),p.addValue(new Date(dateYear,dateMonth,dateDay).getTime()),p.params.closeOnSelect&&p.close()}}}p.container.find(".picker-calendar-prev-month").on("click",p.prevMonth),p.container.find(".picker-calendar-next-month").on("click",p.nextMonth),p.container.find(".picker-calendar-prev-year").on("click",p.prevYear),p.container.find(".picker-calendar-next-year").on("click",p.nextYear),p.wrapper.on("click",handleDayClick),p.params.touchMove&&(p.wrapper.on($.touchEvents.start,handleTouchStart),p.wrapper.on($.touchEvents.move,handleTouchMove),p.wrapper.on($.touchEvents.end,handleTouchEnd)),p.container[0].f7DestroyCalendarEvents=function(){p.container.find(".picker-calendar-prev-month").off("click",p.prevMonth),p.container.find(".picker-calendar-next-month").off("click",p.nextMonth),p.container.find(".picker-calendar-prev-year").off("click",p.prevYear),p.container.find(".picker-calendar-next-year").off("click",p.nextYear),p.wrapper.off("click",handleDayClick),p.params.touchMove&&(p.wrapper.off($.touchEvents.start,handleTouchStart),p.wrapper.off($.touchEvents.move,handleTouchMove),p.wrapper.off($.touchEvents.end,handleTouchEnd))}},p.destroyCalendarEvents=function(colContainer){"f7DestroyCalendarEvents"in p.container[0]&&p.container[0].f7DestroyCalendarEvents()},p.daysInMonth=function(date){var d=new Date(date);return new Date(d.getFullYear(),d.getMonth()+1,0).getDate()},p.monthHTML=function(date,offset){var year=(date=new Date(date)).getFullYear(),month=date.getMonth();date.getDate();"next"===offset&&(date=11===month?new Date(year+1,0):new Date(year,month+1,1)),"prev"===offset&&(date=0===month?new Date(year-1,11):new Date(year,month-1,1)),"next"!==offset&&"prev"!==offset||(month=date.getMonth(),year=date.getFullYear());var daysInPrevMonth=p.daysInMonth(new Date(date.getFullYear(),date.getMonth()).getTime()-864e6),daysInMonth=p.daysInMonth(date),firstDayOfMonthIndex=new Date(date.getFullYear(),date.getMonth()).getDay();0===firstDayOfMonthIndex&&(firstDayOfMonthIndex=7);var dayDate,i,j,currentValues=[],monthHTML="",dayIndex=p.params.firstDay-1+0,today=(new Date).setHours(0,0,0,0),minDate=p.params.minDate?new Date(p.params.minDate).getTime():null,maxDate=p.params.maxDate?new Date(p.params.maxDate).getTime():null;if(p.value&&p.value.length)for(i=0;i<p.value.length;i++)currentValues.push(new Date(p.value[i]).setHours(0,0,0,0));for(i=1;i<=6;i++){var rowHTML="";for(j=1;j<=7;j++){var col=j,dayNumber=++dayIndex-firstDayOfMonthIndex,addClass="";dayNumber<0?(dayNumber=daysInPrevMonth+dayNumber+1,addClass+=" picker-calendar-day-prev",dayDate=new Date(month-1<0?year-1:year,month-1<0?11:month-1,dayNumber).getTime()):daysInMonth<(dayNumber+=1)?(dayNumber-=daysInMonth,addClass+=" picker-calendar-day-next",dayDate=new Date(11<month+1?year+1:year,11<month+1?0:month+1,dayNumber).getTime()):dayDate=new Date(year,month,dayNumber).getTime(),dayDate===today&&(addClass+=" picker-calendar-day-today"),0<=currentValues.indexOf(dayDate)&&(addClass+=" picker-calendar-day-selected"),0<=p.params.weekendDays.indexOf(col-1)&&(addClass+=" picker-calendar-day-weekend"),(minDate&&dayDate<minDate||maxDate&&maxDate<dayDate)&&(addClass+=" picker-calendar-day-disabled");var dayYear=(dayDate=new Date(dayDate)).getFullYear(),dayMonth=dayDate.getMonth();rowHTML+='<div data-year="'+dayYear+'" data-month="'+dayMonth+'" data-day="'+dayNumber+'" class="picker-calendar-day'+addClass+'" data-date="'+dayYear+"-"+dayMonth+"-"+dayNumber+'"><span>'+dayNumber+"</span></div>"}monthHTML+='<div class="picker-calendar-row">'+rowHTML+"</div>"}return monthHTML='<div class="picker-calendar-month" data-year="'+year+'" data-month="'+month+'">'+monthHTML+"</div>"},p.animating=!1,p.updateCurrentMonthYear=function(dir){void 0===dir?(p.currentMonth=parseInt(p.months.eq(1).attr("data-month"),10),p.currentYear=parseInt(p.months.eq(1).attr("data-year"),10)):(p.currentMonth=parseInt(p.months.eq("next"===dir?p.months.length-1:0).attr("data-month"),10),p.currentYear=parseInt(p.months.eq("next"===dir?p.months.length-1:0).attr("data-year"),10)),p.container.find(".current-month-value").text(p.params.monthNames[p.currentMonth]),p.container.find(".current-year-value").text(p.currentYear)},p.onMonthChangeStart=function(dir){p.updateCurrentMonthYear(dir),p.months.removeClass("picker-calendar-month-current picker-calendar-month-prev picker-calendar-month-next");var currentIndex="next"===dir?p.months.length-1:0;p.months.eq(currentIndex).addClass("picker-calendar-month-current"),p.months.eq("next"===dir?currentIndex-1:currentIndex+1).addClass("next"===dir?"picker-calendar-month-prev":"picker-calendar-month-next"),p.params.onMonthYearChangeStart&&p.params.onMonthYearChangeStart(p,p.currentYear,p.currentMonth)},p.onMonthChangeEnd=function(dir,rebuildBoth){var nextMonthHTML,prevMonthHTML,newMonthHTML;p.animating=!1,p.wrapper.find(".picker-calendar-month:not(.picker-calendar-month-prev):not(.picker-calendar-month-current):not(.picker-calendar-month-next)").remove(),void 0===dir&&(dir="next",rebuildBoth=!0),rebuildBoth?(p.wrapper.find(".picker-calendar-month-next, .picker-calendar-month-prev").remove(),prevMonthHTML=p.monthHTML(new Date(p.currentYear,p.currentMonth),"prev"),nextMonthHTML=p.monthHTML(new Date(p.currentYear,p.currentMonth),"next")):newMonthHTML=p.monthHTML(new Date(p.currentYear,p.currentMonth),dir),("next"===dir||rebuildBoth)&&p.wrapper.append(newMonthHTML||nextMonthHTML),("prev"===dir||rebuildBoth)&&p.wrapper.prepend(newMonthHTML||prevMonthHTML),p.months=p.wrapper.find(".picker-calendar-month"),p.setMonthsTranslate(p.monthsTranslate),p.params.onMonthAdd&&p.params.onMonthAdd(p,"next"===dir?p.months.eq(p.months.length-1)[0]:p.months.eq(0)[0]),p.params.onMonthYearChangeEnd&&p.params.onMonthYearChangeEnd(p,p.currentYear,p.currentMonth)},p.setMonthsTranslate=function(translate){translate=translate||p.monthsTranslate||0,void 0===p.monthsTranslate&&(p.monthsTranslate=translate),p.months.removeClass("picker-calendar-month-current picker-calendar-month-prev picker-calendar-month-next");var prevMonthTranslate=100*-(translate+1)*inverter,currentMonthTranslate=100*-translate*inverter,nextMonthTranslate=100*-(translate-1)*inverter;p.months.eq(0).transform("translate3d("+(p.isH?prevMonthTranslate:0)+"%, "+(p.isH?0:prevMonthTranslate)+"%, 0)").addClass("picker-calendar-month-prev"),p.months.eq(1).transform("translate3d("+(p.isH?currentMonthTranslate:0)+"%, "+(p.isH?0:currentMonthTranslate)+"%, 0)").addClass("picker-calendar-month-current"),p.months.eq(2).transform("translate3d("+(p.isH?nextMonthTranslate:0)+"%, "+(p.isH?0:nextMonthTranslate)+"%, 0)").addClass("picker-calendar-month-next")},p.nextMonth=function(transition){void 0!==transition&&"object"!=typeof transition||(transition="",p.params.animate||(transition=0));var nextMonth=parseInt(p.months.eq(p.months.length-1).attr("data-month"),10),nextYear=parseInt(p.months.eq(p.months.length-1).attr("data-year"),10),nextDateTime=new Date(nextYear,nextMonth).getTime(),transitionEndCallback=!p.animating;if(p.params.maxDate&&nextDateTime>new Date(p.params.maxDate).getTime())return p.resetMonth();if(p.monthsTranslate--,nextMonth===p.currentMonth){var nextMonthTranslate=100*-p.monthsTranslate*inverter,nextMonthHTML=$(p.monthHTML(nextDateTime,"next")).transform("translate3d("+(p.isH?nextMonthTranslate:0)+"%, "+(p.isH?0:nextMonthTranslate)+"%, 0)").addClass("picker-calendar-month-next");p.wrapper.append(nextMonthHTML[0]),p.months=p.wrapper.find(".picker-calendar-month"),p.params.onMonthAdd&&p.params.onMonthAdd(p,p.months.eq(p.months.length-1)[0])}p.animating=!0,p.onMonthChangeStart("next");var translate=100*p.monthsTranslate*inverter;p.wrapper.transition(transition).transform("translate3d("+(p.isH?translate:0)+"%, "+(p.isH?0:translate)+"%, 0)"),transitionEndCallback&&p.wrapper.transitionEnd(function(){p.onMonthChangeEnd("next")}),p.params.animate||p.onMonthChangeEnd("next")},p.prevMonth=function(transition){void 0!==transition&&"object"!=typeof transition||(transition="",p.params.animate||(transition=0));var prevMonth=parseInt(p.months.eq(0).attr("data-month"),10),prevYear=parseInt(p.months.eq(0).attr("data-year"),10),prevDateTime=new Date(prevYear,prevMonth+1,-1).getTime(),transitionEndCallback=!p.animating;if(p.params.minDate&&prevDateTime<new Date(p.params.minDate).getTime())return p.resetMonth();if(p.monthsTranslate++,prevMonth===p.currentMonth){var prevMonthTranslate=100*-p.monthsTranslate*inverter,prevMonthHTML=$(p.monthHTML(prevDateTime,"prev")).transform("translate3d("+(p.isH?prevMonthTranslate:0)+"%, "+(p.isH?0:prevMonthTranslate)+"%, 0)").addClass("picker-calendar-month-prev");p.wrapper.prepend(prevMonthHTML[0]),p.months=p.wrapper.find(".picker-calendar-month"),p.params.onMonthAdd&&p.params.onMonthAdd(p,p.months.eq(0)[0])}p.animating=!0,p.onMonthChangeStart("prev");var translate=100*p.monthsTranslate*inverter;p.wrapper.transition(transition).transform("translate3d("+(p.isH?translate:0)+"%, "+(p.isH?0:translate)+"%, 0)"),transitionEndCallback&&p.wrapper.transitionEnd(function(){p.onMonthChangeEnd("prev")}),p.params.animate||p.onMonthChangeEnd("prev")},p.resetMonth=function(transition){void 0===transition&&(transition="");var translate=100*p.monthsTranslate*inverter;p.wrapper.transition(transition).transform("translate3d("+(p.isH?translate:0)+"%, "+(p.isH?0:translate)+"%, 0)")},p.setYearMonth=function(year,month,transition){var targetDate;if(void 0===year&&(year=p.currentYear),void 0===month&&(month=p.currentMonth),void 0!==transition&&"object"!=typeof transition||(transition="",p.params.animate||(transition=0)),targetDate=year<p.currentYear?new Date(year,month+1,-1).getTime():new Date(year,month).getTime(),p.params.maxDate&&targetDate>new Date(p.params.maxDate).getTime())return!1;if(p.params.minDate&&targetDate<new Date(p.params.minDate).getTime())return!1;var currentDate=new Date(p.currentYear,p.currentMonth).getTime(),dir=currentDate<targetDate?"next":"prev",newMonthHTML=p.monthHTML(new Date(year,month));p.monthsTranslate=p.monthsTranslate||0;var monthTranslate,wrapperTranslate,prevTranslate=p.monthsTranslate,transitionEndCallback=!p.animating;currentDate<targetDate?(p.monthsTranslate--,p.animating||p.months.eq(p.months.length-1).remove(),p.wrapper.append(newMonthHTML),p.months=p.wrapper.find(".picker-calendar-month"),monthTranslate=100*-(prevTranslate-1)*inverter,p.months.eq(p.months.length-1).transform("translate3d("+(p.isH?monthTranslate:0)+"%, "+(p.isH?0:monthTranslate)+"%, 0)").addClass("picker-calendar-month-next")):(p.monthsTranslate++,p.animating||p.months.eq(0).remove(),p.wrapper.prepend(newMonthHTML),p.months=p.wrapper.find(".picker-calendar-month"),monthTranslate=100*-(prevTranslate+1)*inverter,p.months.eq(0).transform("translate3d("+(p.isH?monthTranslate:0)+"%, "+(p.isH?0:monthTranslate)+"%, 0)").addClass("picker-calendar-month-prev")),p.params.onMonthAdd&&p.params.onMonthAdd(p,"next"===dir?p.months.eq(p.months.length-1)[0]:p.months.eq(0)[0]),p.animating=!0,p.onMonthChangeStart(dir),wrapperTranslate=100*p.monthsTranslate*inverter,p.wrapper.transition(transition).transform("translate3d("+(p.isH?wrapperTranslate:0)+"%, "+(p.isH?0:wrapperTranslate)+"%, 0)"),transitionEndCallback&&p.wrapper.transitionEnd(function(){p.onMonthChangeEnd(dir,!0)}),p.params.animate||p.onMonthChangeEnd(dir)},p.nextYear=function(){p.setYearMonth(p.currentYear+1)},p.prevYear=function(){p.setYearMonth(p.currentYear-1)},p.layout=function(){var pickerHTML,pickerClass,i,layoutDate=p.value&&p.value.length?p.value[0]:(new Date).setHours(0,0,0,0),monthsHTML='<div class="picker-calendar-months"><div class="picker-calendar-months-wrapper">'+(p.monthHTML(layoutDate,"prev")+p.monthHTML(layoutDate)+p.monthHTML(layoutDate,"next"))+"</div></div>",weekHeaderHTML="";if(p.params.weekHeader){for(i=0;i<7;i++){var weekDayIndex=6<i+p.params.firstDay?i-7+p.params.firstDay:i+p.params.firstDay,dayName=p.params.dayNamesShort[weekDayIndex];weekHeaderHTML+='<div class="picker-calendar-week-day '+(0<=p.params.weekendDays.indexOf(weekDayIndex)?"picker-calendar-week-day-weekend":"")+'"> '+dayName+"</div>"}weekHeaderHTML='<div class="picker-calendar-week-days">'+weekHeaderHTML+"</div>"}pickerClass="picker-modal picker-calendar "+(p.params.cssClass||"");var toolbarHTML=p.params.toolbar?p.params.toolbarTemplate.replace(/{{closeText}}/g,p.params.toolbarCloseText):"";p.params.toolbar&&(toolbarHTML=p.params.toolbarTemplate.replace(/{{closeText}}/g,p.params.toolbarCloseText).replace(/{{monthPicker}}/g,p.params.monthPicker?p.params.monthPickerTemplate:"").replace(/{{yearPicker}}/g,p.params.yearPicker?p.params.yearPickerTemplate:"")),pickerHTML='<div class="'+pickerClass+'">'+toolbarHTML+'<div class="picker-modal-inner">'+weekHeaderHTML+monthsHTML+"</div></div>",p.pickerHTML=pickerHTML},p.params.input&&(p.input=$(p.params.input),0<p.input.length&&(p.params.inputReadOnly&&p.input.prop("readOnly",!0),p.inline||p.input.on("click",openOnInput))),p.inline||$("html").on("click",closeOnHTMLClick),p.opened=!1,p.open=function(){var updateValue=!1;p.opened||(p.value||p.params.value&&(p.value=p.params.value,updateValue=!0),p.layout(),p.inline?(p.container=$(p.pickerHTML),p.container.addClass("picker-modal-inline"),$(p.params.container).append(p.container)):(p.container=$($.pickerModal(p.pickerHTML)),$(p.container).on("close",function(){p.opened=!1,p.input&&0<p.input.length&&p.input.parents(".content").css({"padding-bottom":""}),p.params.onClose&&p.params.onClose(p),p.destroyCalendarEvents()})),(p.container[0].f7Calendar=p).wrapper=p.container.find(".picker-calendar-months-wrapper"),p.months=p.wrapper.find(".picker-calendar-month"),p.updateCurrentMonthYear(),p.monthsTranslate=0,p.setMonthsTranslate(),p.initCalendarEvents(),updateValue&&p.updateValue()),p.opened=!0,p.initialized=!0,p.params.onMonthAdd&&p.months.each(function(){p.params.onMonthAdd(p,this)}),p.params.onOpen&&p.params.onOpen(p)},p.close=function(){p.opened&&!p.inline&&$.closeModal(p.container)},p.destroy=function(){p.close(),p.params.input&&0<p.input.length&&p.input.off("click",openOnInput),$("html").off("click",closeOnHTMLClick)},p.inline&&p.open(),p};$.fn.calendar=function(params){return this.each(function(){var $this=$(this);if($this[0]){var p={};"INPUT"===$this[0].tagName.toUpperCase()?p.input=$this:p.container=$this,new Calendar($.extend(p,params))}})},$.initCalendar=function(content){$(content||document.body).find("[data-toggle='date']").each(function(){$(this).calendar()})}}(Zepto),function($){"use strict";var MultiSelect=function(params){this.opt=params,this.chooseSelectArr=[]};MultiSelect.prototype={constructor:MultiSelect,init:function(){this.handleBind()},handleBind:function(){var self=this;self.opt.elem;$(document).on("click","#multi-select",function(){0===$(".modal-overlay").length&&$("body").append('<div class="modal-overlay"></div>'),$(".modal-overlay").addClass("modal-overlay-visible"),self.showModal()})},checkInitItem:function(name){for(var initItems=this.chooseSelectArr,len=initItems.length,i=0;i<len;i++)if(initItems[i]===name)return!0;return!1},showModal:function(){for(var shtml,self=this,select=self.opt.select,liHtml="",i=0,len=select.length;i<len;i++){var id=(new Date).getTime()+"_"+i,name=select[i];liHtml+='<li>                                <div class="label-checked-box">                                        <input type="checkbox" id="check-'+id+'" '+(self.checkInitItem(name)?"checked":"")+' value="'+name+'">                                        <label for="check-'+id+'">                                            <span class="name">'+name+"</span>                                        </label>                                </div>                            </li>"}shtml='<div class="modal diy-modal modal-out" style="display:block">                        <div class="modal-inner">                            <ul>'+liHtml+"</ul>                        </div>                    </div>",$("body").append(shtml),$(".diy-modal").trigger("open"),$(".diy-modal").removeClass("modal-out").addClass("modal-in"),$(".diy-modal input").off().on("change",function(){self.getCheckedItem()}),$(".modal-overlay-visible").on("click",function(){$(".diy-modal").addClass("modal-out"),$(".diy-modal").trigger("close"),$(this).off().removeClass("modal-overlay-visible"),$(".diy-modal input").off(),$(".diy-modal").remove()})},getCheckedItem:function(){var self=this,$elem=self.opt.elem,inputChecked=$(".diy-modal input:checked"),len=inputChecked.length,shtml="",title=self.opt.title;self.chooseSelectArr=[];for(var i=0;i<len;i++){var name=$(inputChecked[i]).val();shtml+='<span class="lable">'+name+' <i class="iconfont icon-shanchu" data-name="'+name+'"></i></span>',self.chooseSelectArr.push(name)}$elem.attr("data-items",self.chooseSelectArr),$(".multi-select-list").empty().append(shtml),""===shtml&&$(".multi-select-list").text(title),$(".multi-select-list").off().on("click",".icon-shanchu",function(){$(this).parent(".lable").remove();var thisItem=$(this).attr("data-name"),items=$elem.attr("data-items");items=items.split(","),self.chooseSelectArr=[];for(var i=0,len=items.length;i<len;i++)items[i]!==thisItem&&self.chooseSelectArr.push(items[i]);$elem.attr("data-items",self.chooseSelectArr),0===self.chooseSelectArr.length&&$(".multi-select-list").text(title)})}},$.fn.multiSelect=function(params){return this.each(function(){var $this=$(this);if($this[0]){var p={};p.elem=$this,p.select=["X3","Q5","X3M","X3C","Q5S","X3T","Q5C","VP1000U"],p.title="选择设备型号",new MultiSelect($.extend(p,params)).init()}})}}(Zepto),function($){"use strict";var Picker=function(params){var p=this,defaults={updateValuesOnMomentum:!1,updateValuesOnTouchmove:!0,rotateEffect:!1,momentumRatio:7,freeMode:!1,scrollToInput:!0,inputReadOnly:!0,toolbar:!0,toolbarCloseText:"确定",toolbarTemplate:'<header class="bar bar-nav">                <button class="button button-link pull-right close-picker">确定</button>                <h1 class="title">请选择</h1>                </header>'};for(var def in params=params||{},defaults)void 0===params[def]&&(params[def]=defaults[def]);p.params=params,p.cols=[],p.initialized=!1,p.inline=!!p.params.container;var originBug=$.device.ios||0<=navigator.userAgent.toLowerCase().indexOf("safari")&&navigator.userAgent.toLowerCase().indexOf("chrome")<0&&!$.device.android;function resizeCols(){if(p.opened)for(var i=0;i<p.cols.length;i++)p.cols[i].divider||(p.cols[i].calcSize(),p.cols[i].setValue(p.cols[i].value,0,!1))}function openOnInput(e){if(e.preventDefault(),$.device.isWeixin&&$.device.android&&p.params.inputReadOnly&&(this.focus(),this.blur()),!(p.opened||0<$(".picker-columns").length)&&(p.open(),p.params.scrollToInput)){var pageContent=p.input.parents(".content");if(0===pageContent.length)return;var newPaddingBottom,paddingTop=parseInt(pageContent.css("padding-top"),10),paddingBottom=parseInt(pageContent.css("padding-bottom"),10),pageHeight=pageContent[0].offsetHeight-paddingTop-p.container.height(),pageScrollHeight=pageContent[0].scrollHeight-paddingTop-p.container.height(),inputTop=p.input.offset().top-paddingTop+p.input[0].offsetHeight;if(pageHeight<inputTop){var scrollTop=pageContent.scrollTop()+inputTop-pageHeight;pageScrollHeight<scrollTop+pageHeight&&(newPaddingBottom=scrollTop+pageHeight-pageScrollHeight+paddingBottom,pageHeight===pageScrollHeight&&(newPaddingBottom=p.container.height()),pageContent.css({"padding-bottom":newPaddingBottom+"px"})),pageContent.scrollTop(scrollTop,300)}}}function closeOnHTMLClick(e){p.opened&&(p.input&&0<p.input.length?e.target!==p.input[0]&&0===$(e.target).parents(".picker-modal").length&&p.close():0===$(e.target).parents(".picker-modal").length&&p.close())}return p.setValue=function(arrValues,transition){for(var valueIndex=0,i=0;i<p.cols.length;i++)p.cols[i]&&!p.cols[i].divider&&(p.cols[i].setValue(arrValues[valueIndex],transition),valueIndex++)},p.updateValue=function(){for(var newValue=[],newDisplayValue=[],i=0;i<p.cols.length;i++)p.cols[i].divider||(newValue.push(p.cols[i].value),newDisplayValue.push(p.cols[i].displayValue));0<=newValue.indexOf(void 0)||(p.value=newValue,p.displayValue=newDisplayValue,p.params.onChange&&p.params.onChange(p,p.value,p.displayValue),p.input&&0<p.input.length&&($(p.input).val(p.params.formatValue?p.params.formatValue(p,p.value,p.displayValue):p.value.join(" ")),$(p.input).trigger("change")))},p.initPickerCol=function(colElement,updateItems){var colContainer=$(colElement),colIndex=colContainer.index(),col=p.cols[colIndex];if(!col.divider){var itemHeight,itemsHeight,minTranslate,maxTranslate;col.container=colContainer,col.wrapper=col.container.find(".picker-items-col-wrapper"),col.items=col.wrapper.find(".picker-item"),col.replaceValues=function(values,displayValues){col.destroyEvents(),col.values=values,col.displayValues=displayValues;var newItemsHTML=p.columnHTML(col,!0);col.wrapper.html(newItemsHTML),col.items=col.wrapper.find(".picker-item"),col.calcSize(),col.setValue(col.values[0],0,!0),col.initEvents()},col.calcSize=function(){var colWidth,colHeight;p.params.rotateEffect&&(col.container.removeClass("picker-items-col-absolute"),col.width||col.container.css({width:""})),colWidth=0,colHeight=col.container[0].offsetHeight,col.wrapper[0].offsetHeight,itemHeight=col.items[0].offsetHeight,itemsHeight=itemHeight*col.items.length,minTranslate=colHeight/2-itemsHeight+itemHeight/2,maxTranslate=colHeight/2-itemHeight/2,col.width&&(colWidth=col.width,parseInt(colWidth,10)===colWidth&&(colWidth+="px"),col.container.css({width:colWidth})),p.params.rotateEffect&&(col.width||(col.items.each(function(){var item=$(this);item.css({width:"auto"}),colWidth=Math.max(colWidth,item[0].offsetWidth),item.css({width:""})}),col.container.css({width:colWidth+2+"px"})),col.container.addClass("picker-items-col-absolute"))},col.calcSize(),col.wrapper.transform("translate3d(0,"+maxTranslate+"px,0)").transition(0);var animationFrameId;col.setValue=function(newValue,transition,valueCallbacks){void 0===transition&&(transition="");var newActiveIndex=col.wrapper.find('.picker-item[data-picker-value="'+newValue+'"]').index();if(void 0!==newActiveIndex&&-1!==newActiveIndex){var newTranslate=-newActiveIndex*itemHeight+maxTranslate;col.wrapper.transition(transition),col.wrapper.transform("translate3d(0,"+newTranslate+"px,0)"),p.params.updateValuesOnMomentum&&col.activeIndex&&col.activeIndex!==newActiveIndex&&($.cancelAnimationFrame(animationFrameId),col.wrapper.transitionEnd(function(){$.cancelAnimationFrame(animationFrameId)}),updateDuringScroll()),col.updateItems(newActiveIndex,newTranslate,transition,valueCallbacks)}},col.updateItems=function(activeIndex,translate,transition,valueCallbacks){void 0===translate&&(translate=$.getTranslate(col.wrapper[0],"y")),void 0===activeIndex&&(activeIndex=-Math.round((translate-maxTranslate)/itemHeight)),activeIndex<0&&(activeIndex=0),activeIndex>=col.items.length&&(activeIndex=col.items.length-1);var previousActiveIndex=col.activeIndex;col.activeIndex=activeIndex,col.wrapper.find(".picker-selected").removeClass("picker-selected"),p.params.rotateEffect&&col.items.transition(transition);var selectedItem=col.items.eq(activeIndex).addClass("picker-selected").transform("");if((valueCallbacks||void 0===valueCallbacks)&&(col.value=selectedItem.attr("data-picker-value"),col.displayValue=col.displayValues?col.displayValues[activeIndex]:col.value,previousActiveIndex!==activeIndex&&(col.onChange&&col.onChange(p,col.value,col.displayValue),p.updateValue())),p.params.rotateEffect){Math.floor((translate-maxTranslate)/itemHeight);col.items.each(function(){var item=$(this),percentage=(item.index()*itemHeight-(maxTranslate-translate))/itemHeight,itemsFit=Math.ceil(col.height/itemHeight/2)+1,angle=-18*percentage;180<angle&&(angle=180),angle<-180&&(angle=-180),Math.abs(percentage)>itemsFit?item.addClass("picker-item-far"):item.removeClass("picker-item-far"),item.transform("translate3d(0, "+(-translate+maxTranslate)+"px, "+(originBug?-110:0)+"px) rotateX("+angle+"deg)")})}},updateItems&&col.updateItems(0,maxTranslate,0);var isTouched,isMoved,touchStartY,touchCurrentY,touchStartTime,touchEndTime,startTranslate,returnTo,currentTranslate,prevTranslate,velocityTranslate,velocityTime,allowItemClick=!0;col.initEvents=function(detach){var method=detach?"off":"on";col.container[method]($.touchEvents.start,handleTouchStart),col.container[method]($.touchEvents.move,handleTouchMove),col.container[method]($.touchEvents.end,handleTouchEnd),col.items[method]("click",handleClick)},col.destroyEvents=function(){col.initEvents(!0)},col.container[0].f7DestroyPickerCol=function(){col.destroyEvents()},col.initEvents()}function updateDuringScroll(){animationFrameId=$.requestAnimationFrame(function(){col.updateItems(void 0,void 0,0),updateDuringScroll()})}function handleTouchStart(e){isMoved||isTouched||(e.preventDefault(),isTouched=!0,touchStartY=touchCurrentY="touchstart"===e.type?e.targetTouches[0].pageY:e.pageY,touchStartTime=(new Date).getTime(),allowItemClick=!0,startTranslate=currentTranslate=$.getTranslate(col.wrapper[0],"y"))}function handleTouchMove(e){isTouched&&(e.preventDefault(),allowItemClick=!1,touchCurrentY="touchmove"===e.type?e.targetTouches[0].pageY:e.pageY,isMoved||($.cancelAnimationFrame(animationFrameId),isMoved=!0,startTranslate=currentTranslate=$.getTranslate(col.wrapper[0],"y"),col.wrapper.transition(0)),e.preventDefault(),returnTo=void 0,(currentTranslate=startTranslate+(touchCurrentY-touchStartY))<minTranslate&&(currentTranslate=minTranslate-Math.pow(minTranslate-currentTranslate,.8),returnTo="min"),maxTranslate<currentTranslate&&(currentTranslate=maxTranslate+Math.pow(currentTranslate-maxTranslate,.8),returnTo="max"),col.wrapper.transform("translate3d(0,"+currentTranslate+"px,0)"),col.updateItems(void 0,currentTranslate,0,p.params.updateValuesOnTouchmove),velocityTranslate=currentTranslate-prevTranslate||currentTranslate,velocityTime=(new Date).getTime(),prevTranslate=currentTranslate)}function handleTouchEnd(e){if(isTouched&&isMoved){var newTranslate;isTouched=isMoved=!1,col.wrapper.transition(""),returnTo&&("min"===returnTo?col.wrapper.transform("translate3d(0,"+minTranslate+"px,0)"):col.wrapper.transform("translate3d(0,"+maxTranslate+"px,0)")),300<(touchEndTime=(new Date).getTime())-touchStartTime?newTranslate=currentTranslate:(Math.abs(velocityTranslate/(touchEndTime-velocityTime)),newTranslate=currentTranslate+velocityTranslate*p.params.momentumRatio),newTranslate=Math.max(Math.min(newTranslate,maxTranslate),minTranslate);var activeIndex=-Math.floor((newTranslate-maxTranslate)/itemHeight);p.params.freeMode||(newTranslate=-activeIndex*itemHeight+maxTranslate),col.wrapper.transform("translate3d(0,"+parseInt(newTranslate,10)+"px,0)"),col.updateItems(activeIndex,newTranslate,"",!0),p.params.updateValuesOnMomentum&&(updateDuringScroll(),col.wrapper.transitionEnd(function(){$.cancelAnimationFrame(animationFrameId)})),setTimeout(function(){allowItemClick=!0},100)}else isTouched=isMoved=!1}function handleClick(e){if(allowItemClick){$.cancelAnimationFrame(animationFrameId);var value=$(this).attr("data-picker-value");col.setValue(value)}}},p.destroyPickerCol=function(colContainer){"f7DestroyPickerCol"in(colContainer=$(colContainer))[0]&&colContainer[0].f7DestroyPickerCol()},$(window).on("resize",resizeCols),p.columnHTML=function(col,onlyItems){var columnItemsHTML="",columnHTML="";if(col.divider)columnHTML+='<div class="picker-items-col picker-items-col-divider '+(col.textAlign?"picker-items-col-"+col.textAlign:"")+" "+(col.cssClass||"")+'">'+col.content+"</div>";else{for(var j=0;j<col.values.length;j++)columnItemsHTML+='<div class="picker-item" data-picker-value="'+col.values[j]+'">'+(col.displayValues?col.displayValues[j]:col.values[j])+"</div>";columnHTML+='<div class="picker-items-col '+(col.textAlign?"picker-items-col-"+col.textAlign:"")+" "+(col.cssClass||"")+'"><div class="picker-items-col-wrapper">'+columnItemsHTML+"</div></div>"}return onlyItems?columnItemsHTML:columnHTML},p.layout=function(){var pickerHTML,i;p.cols=[];var colsHTML="";for(i=0;i<p.params.cols.length;i++){var col=p.params.cols[i];colsHTML+=p.columnHTML(p.params.cols[i]),p.cols.push(col)}pickerHTML='<div class="'+("picker-modal picker-columns "+(p.params.cssClass||"")+(p.params.rotateEffect?" picker-3d":""))+'">'+(p.params.toolbar?p.params.toolbarTemplate.replace(/{{closeText}}/g,p.params.toolbarCloseText):"")+'<div class="picker-modal-inner picker-items">'+colsHTML+'<div class="picker-center-highlight"></div></div></div>',p.pickerHTML=pickerHTML},p.params.input&&(p.input=$(p.params.input),0<p.input.length&&(p.params.inputReadOnly&&p.input.prop("readOnly",!0),p.inline||p.input.on("click",openOnInput))),p.inline||$("html").on("click",closeOnHTMLClick),p.opened=!1,p.open=function(){p.opened||(p.layout(),Public.showMask(),p.inline?(p.container=$(p.pickerHTML),p.container.addClass("picker-modal-inline"),$(p.params.container).append(p.container),p.opened=!0):(p.container=$($.pickerModal(p.pickerHTML)),$(p.container).one("opened",function(){p.opened=!0}).on("close",function(){p.opened=!1,p.input&&0<p.input.length&&p.input.parents(".content").css({"padding-bottom":""}),p.params.onClose&&p.params.onClose(p),p.container.find(".picker-items-col").each(function(){p.destroyPickerCol(this)})})),(p.container[0].f7Picker=p).container.find(".picker-items-col").each(function(){var updateItems=!0;(!p.initialized&&p.params.value||p.initialized&&p.value)&&(updateItems=!1),p.initPickerCol(this,updateItems)}),p.initialized?p.value&&p.setValue(p.value,0):p.params.value&&p.setValue(p.params.value,0)),p.initialized=!0,p.params.onOpen&&p.params.onOpen(p)},p.close=function(){p.opened&&!p.inline&&($.closeModal(p.container),Public.hideMask())},p.destroy=function(){p.close(),p.params.input&&0<p.input.length&&p.input.off("click",openOnInput),$("html").off("click",closeOnHTMLClick),$(window).off("resize",resizeCols)},p.inline&&p.open(),p};$(document).on("click",".close-picker",function(){var pickerToClose=$(".picker-modal.modal-in");$.closeModal(pickerToClose)}),$.fn.picker=function(params){var args=arguments;return this.each(function(){if(this){var $this=$(this),picker=$this.data("picker");if(!picker){var p=$.extend({input:this,value:$this.val()?$this.val().split(" "):""},params);picker=new Picker(p),$this.data("picker",picker)}"string"==typeof params&&picker[params].apply(picker,Array.prototype.slice.call(args,1))}})}}(Zepto),function($){"use strict";var today=new Date,getDays=function(max){for(var days=[],i=1;i<=(max||31);i++)days.push(i<10?"0"+i:i);return days},formatNumber=function(n){return n<10?"0"+n:n},initMonthes="01 02 03 04 05 06 07 08 09 10 11 12".split(" "),initYears=function(){for(var arr=[],i=1950;i<=2030;i++)arr.push(i);return arr}(),defaults={rotateEffect:!1,value:[today.getFullYear(),formatNumber(today.getMonth()+1),formatNumber(today.getDate()),today.getHours(),formatNumber(today.getMinutes()),formatNumber(today.getSeconds())],onChange:function(picker,values,displayValues){var month,year,int_d,d,days=(month=picker.cols[1].value,year=picker.cols[0].value,int_d=new Date(year,parseInt(month)+1-1,1),d=new Date(int_d-1),getDays(d.getDate())),currentValue=picker.cols[2].value;currentValue>days.length&&(currentValue=days.length),picker.cols[2].setValue(currentValue)},formatValue:function(p,values,displayValues){var value="",format=p.params.format;return"YYYY-MM-DD"===format?value=displayValues[0]+"-"+values[1]+"-"+values[2]:"YYYY-MM-DD hh:mm:ss"===format?value=displayValues[0]+"-"+values[1]+"-"+values[2]+" "+values[3]+":"+values[4]+":"+values[5]:"YYYY-MM-DD hh:mm"===format?value=displayValues[0]+"-"+values[1]+"-"+values[2]+" "+values[3]+":"+values[4]:"hh:mm:ss"===format&&(value=values[3]+":"+values[4]+":"+values[5]),value},onOpen:function(p){$(p.input).val(p.params.formatValue(p,p.value,p.value))},cols:[{values:initYears},{values:initMonthes},{values:getDays()},{divider:!0,content:"  "},{values:function(){for(var arr=[],i=0;i<=23;i++)arr.push(i<10?"0"+i:i);return arr}()},{divider:!0,content:":"},{values:function(){for(var arr=[],i=0;i<=59;i++)arr.push(i<10?"0"+i:i);return arr}()},{divider:!0,content:":"},{values:function(){for(var arr=[],i=0;i<=59;i++)arr.push(i<10?"0"+i:i);return arr}()}]};$.fn.datetimePicker=function(params){return this.each(function(){if(this){var format,cols,p=$.extend(defaults,params);p.cols=(format=p.format,cols=[],"YYYY-MM-DD"===format?cols=[{values:initYears},{values:initMonthes},{values:getDays()}]:"YYYY-MM-DD hh:mm:ss"===format?cols=[{values:initYears},{values:initMonthes},{values:getDays()},{divider:!0,content:"  "},{values:function(){for(var arr=[],i=0;i<=23;i++)arr.push(i<10?"0"+i:i);return arr}()},{divider:!0,content:":"},{values:function(){for(var arr=[],i=0;i<=59;i++)arr.push(i<10?"0"+i:i);return arr}()},{divider:!0,content:":"},{values:function(){for(var arr=[],i=0;i<=59;i++)arr.push(i<10?"0"+i:i);return arr}()}]:"YYYY-MM-DD hh:mm"===format?cols=[{values:initYears},{values:initMonthes},{values:getDays()},{divider:!0,content:"  "},{values:function(){for(var arr=[],i=0;i<=23;i++)arr.push(i<10?"0"+i:i);return arr}()},{divider:!0,content:":"},{values:function(){for(var arr=[],i=0;i<=59;i++)arr.push(i<10?"0"+i:i);return arr}()}]:"hh:mm:ss"===format&&(cols=[{values:function(){for(var arr=[],i=0;i<=23;i++)arr.push(i<10?"0"+i:i);return arr}()},{divider:!0,content:":"},{values:function(){for(var arr=[],i=0;i<=59;i++)arr.push(i<10?"0"+i:i);return arr}()}]),cols),$(this).picker(p)}})}}(Zepto),function(window){"use strict";var rAF=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback){window.setTimeout(callback,1e3/60)},utils=function(){var me={},_elementStyle=document.createElement("div").style,_vendor=function(){for(var vendors=["t","webkitT","MozT","msT","OT"],i=0,l=vendors.length;i<l;i++)if(vendors[i]+"ransform"in _elementStyle)return vendors[i].substr(0,vendors[i].length-1);return!1}();function _prefixStyle(style){return!1!==_vendor&&(""===_vendor?style:_vendor+style.charAt(0).toUpperCase()+style.substr(1))}me.getTime=Date.now||function(){return(new Date).getTime()},me.extend=function(target,obj){for(var i in obj)target[i]=obj[i]},me.addEvent=function(el,type,fn,capture){el.addEventListener(type,fn,!!capture)},me.removeEvent=function(el,type,fn,capture){el.removeEventListener(type,fn,!!capture)},me.prefixPointerEvent=function(pointerEvent){return window.MSPointerEvent?"MSPointer"+pointerEvent.charAt(9).toUpperCase()+pointerEvent.substr(10):pointerEvent},me.momentum=function(current,start,time,lowerMargin,wrapperSize,deceleration,self){var destination,duration,distance=current-start,speed=Math.abs(distance)/time;duration=(speed=1.5<(speed/=2)?1.5:speed)/(deceleration=void 0===deceleration?6e-4:deceleration),(destination=current+speed*speed/(2*deceleration)*(distance<0?-1:1))<lowerMargin?(destination=wrapperSize?lowerMargin-wrapperSize/2.5*(speed/8):lowerMargin,distance=Math.abs(destination-current),duration=distance/speed):0<destination&&(destination=wrapperSize?wrapperSize/2.5*(speed/8):0,distance=Math.abs(current)+destination,duration=distance/speed);var t=+new Date,l=t;return rAF(function eventTrigger(){50<+new Date-l&&(self._execEvent("scroll"),l=+new Date),+new Date-t<duration&&rAF(eventTrigger)}),{destination:Math.round(destination),duration:duration}};var _transform=_prefixStyle("transform");return me.extend(me,{hasTransform:!1!==_transform,hasPerspective:_prefixStyle("perspective")in _elementStyle,hasTouch:"ontouchstart"in window,hasPointer:window.PointerEvent||window.MSPointerEvent,hasTransition:_prefixStyle("transition")in _elementStyle}),me.isBadAndroid=/Android /.test(window.navigator.appVersion)&&!/Chrome\/\d/.test(window.navigator.appVersion)&&!1,me.extend(me.style={},{transform:_transform,transitionTimingFunction:_prefixStyle("transitionTimingFunction"),transitionDuration:_prefixStyle("transitionDuration"),transitionDelay:_prefixStyle("transitionDelay"),transformOrigin:_prefixStyle("transformOrigin")}),me.hasClass=function(e,c){return new RegExp("(^|\\s)"+c+"(\\s|$)").test(e.className)},me.addClass=function(e,c){if(!me.hasClass(e,c)){var newclass=e.className.split(" ");newclass.push(c),e.className=newclass.join(" ")}},me.removeClass=function(e,c){if(me.hasClass(e,c)){var re=new RegExp("(^|\\s)"+c+"(\\s|$)","g");e.className=e.className.replace(re," ")}},me.offset=function(el){for(var left=-el.offsetLeft,top=-el.offsetTop;el=el.offsetParent;)left-=el.offsetLeft,top-=el.offsetTop;return{left:left,top:top}},me.preventDefaultException=function(el,exceptions){for(var i in exceptions)if(exceptions[i].test(el[i]))return!0;return!1},me.extend(me.eventType={},{touchstart:1,touchmove:1,touchend:1,mousedown:2,mousemove:2,mouseup:2,pointerdown:3,pointermove:3,pointerup:3,MSPointerDown:3,MSPointerMove:3,MSPointerUp:3}),me.extend(me.ease={},{quadratic:{style:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",fn:function(k){return k*(2-k)}},circular:{style:"cubic-bezier(0.1, 0.57, 0.1, 1)",fn:function(k){return Math.sqrt(1- --k*k)}},back:{style:"cubic-bezier(0.175, 0.885, 0.32, 1.275)",fn:function(k){return(k-=1)*k*(5*k+4)+1}},bounce:{style:"",fn:function(k){return(k/=1)<1/2.75?7.5625*k*k:k<2/2.75?7.5625*(k-=1.5/2.75)*k+.75:k<2.5/2.75?7.5625*(k-=2.25/2.75)*k+.9375:7.5625*(k-=2.625/2.75)*k+.984375}},elastic:{style:"",fn:function(k){return 0===k?0:1===k?1:.4*Math.pow(2,-10*k)*Math.sin((k-.055)*(2*Math.PI)/.22)+1}}}),me.tap=function(e,eventName){var ev=document.createEvent("Event");ev.initEvent(eventName,!0,!0),ev.pageX=e.pageX,ev.pageY=e.pageY,e.target.dispatchEvent(ev)},me.click=function(e){var ev,target=e.target;/(SELECT|INPUT|TEXTAREA)/i.test(target.tagName)||((ev=document.createEvent("MouseEvents")).initMouseEvent("click",!0,!0,e.view,1,target.screenX,target.screenY,target.clientX,target.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,0,null),ev._constructed=!0,target.dispatchEvent(ev))},me}();function IScroll(el,options){for(var i in this.wrapper="string"==typeof el?document.querySelector(el):el,this.scroller=$(this.wrapper).find(".content-inner")[0],this.scrollerStyle=this.scroller&&this.scroller.style,this.options={resizeScrollbars:!0,mouseWheelSpeed:20,snapThreshold:.334,startX:0,startY:0,scrollY:!0,directionLockThreshold:5,momentum:!0,bounce:!0,bounceTime:600,bounceEasing:"",preventDefault:!0,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},HWCompositing:!0,useTransition:!0,useTransform:!0,eventPassthrough:void 0},options)this.options[i]=options[i];this.translateZ=this.options.HWCompositing&&utils.hasPerspective?" translateZ(0)":"",this.options.useTransition=utils.hasTransition&&this.options.useTransition,this.options.useTransform=utils.hasTransform&&this.options.useTransform,this.options.eventPassthrough=!0===this.options.eventPassthrough?"vertical":this.options.eventPassthrough,this.options.preventDefault=!this.options.eventPassthrough&&this.options.preventDefault,this.options.scrollY="vertical"!==this.options.eventPassthrough&&this.options.scrollY,this.options.scrollX="horizontal"!==this.options.eventPassthrough&&this.options.scrollX,this.options.freeScroll=this.options.freeScroll&&!this.options.eventPassthrough,this.options.directionLockThreshold=this.options.eventPassthrough?0:this.options.directionLockThreshold,this.options.bounceEasing="string"==typeof this.options.bounceEasing?utils.ease[this.options.bounceEasing]||utils.ease.circular:this.options.bounceEasing,this.options.resizePolling=void 0===this.options.resizePolling?60:this.options.resizePolling,!0===this.options.tap&&(this.options.tap="tap"),"scale"===this.options.shrinkScrollbars&&(this.options.useTransition=!1),this.options.invertWheelDirection=this.options.invertWheelDirection?-1:1,3===this.options.probeType&&(this.options.useTransition=!1),this.x=0,this.y=0,this.directionX=0,this.directionY=0,this._events={},this._init(),this.refresh(),this.scrollTo(this.options.startX,this.options.startY),this.enable()}function createDefaultScrollbar(direction,interactive,type){var scrollbar=document.createElement("div"),indicator=document.createElement("div");return!0===type&&(scrollbar.style.cssText="position:absolute;z-index:9999",indicator.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);border-radius:3px"),indicator.className="iScrollIndicator","h"===direction?(!0===type&&(scrollbar.style.cssText+=";height:5px;left:2px;right:2px;bottom:0",indicator.style.height="100%"),scrollbar.className="iScrollHorizontalScrollbar"):(!0===type&&(scrollbar.style.cssText+=";width:5px;bottom:2px;top:2px;right:1px",indicator.style.width="100%"),scrollbar.className="iScrollVerticalScrollbar"),scrollbar.style.cssText+=";overflow:hidden",interactive||(scrollbar.style.pointerEvents="none"),scrollbar.appendChild(indicator),scrollbar}function Indicator(scroller,options){for(var i in this.wrapper="string"==typeof options.el?document.querySelector(options.el):options.el,this.wrapperStyle=this.wrapper.style,this.indicator=this.wrapper.children[0],this.indicatorStyle=this.indicator.style,this.scroller=scroller,this.options={listenX:!0,listenY:!0,interactive:!1,resize:!0,defaultScrollbars:!1,shrink:!1,fade:!1,speedRatioX:0,speedRatioY:0},options)this.options[i]=options[i];this.sizeRatioX=1,this.sizeRatioY=1,this.maxPosX=0,this.maxPosY=0,this.options.interactive&&(this.options.disableTouch||(utils.addEvent(this.indicator,"touchstart",this),utils.addEvent(window,"touchend",this)),this.options.disablePointer||(utils.addEvent(this.indicator,utils.prefixPointerEvent("pointerdown"),this),utils.addEvent(window,utils.prefixPointerEvent("pointerup"),this)),this.options.disableMouse||(utils.addEvent(this.indicator,"mousedown",this),utils.addEvent(window,"mouseup",this))),this.options.fade&&(this.wrapperStyle[utils.style.transform]=this.scroller.translateZ,this.wrapperStyle[utils.style.transitionDuration]=utils.isBadAndroid?"0.001s":"0ms",this.wrapperStyle.opacity="0")}IScroll.prototype={version:"5.1.3",_init:function(){this._initEvents(),(this.options.scrollbars||this.options.indicators)&&this._initIndicators(),this.options.mouseWheel&&this._initWheel(),this.options.snap&&this._initSnap(),this.options.keyBindings&&this._initKeys()},destroy:function(){this._initEvents(!0),this._execEvent("destroy")},_transitionEnd:function(e){e.target===this.scroller&&this.isInTransition&&(this._transitionTime(),this.resetPosition(this.options.bounceTime)||(this.isInTransition=!1,this._execEvent("scrollEnd")))},_start:function(e){if((1===utils.eventType[e.type]||0===e.button)&&this.enabled&&(!this.initiated||utils.eventType[e.type]===this.initiated)){!this.options.preventDefault||utils.isBadAndroid||utils.preventDefaultException(e.target,this.options.preventDefaultException)||e.preventDefault();var pos,point=e.touches?e.touches[0]:e;this.initiated=utils.eventType[e.type],this.moved=!1,this.distX=0,this.distY=0,this.directionX=0,this.directionY=0,this.directionLocked=0,this._transitionTime(),this.startTime=utils.getTime(),this.options.useTransition&&this.isInTransition?(this.isInTransition=!1,pos=this.getComputedPosition(),this._translate(Math.round(pos.x),Math.round(pos.y)),this._execEvent("scrollEnd")):!this.options.useTransition&&this.isAnimating&&(this.isAnimating=!1,this._execEvent("scrollEnd")),this.startX=this.x,this.startY=this.y,this.absStartX=this.x,this.absStartY=this.y,this.pointX=point.pageX,this.pointY=point.pageY,this._execEvent("beforeScrollStart")}},_move:function(e){if(this.enabled&&utils.eventType[e.type]===this.initiated){this.options.preventDefault&&e.preventDefault();var newX,newY,absDistX,absDistY,point=e.touches?e.touches[0]:e,deltaX=point.pageX-this.pointX,deltaY=point.pageY-this.pointY,timestamp=utils.getTime();if(this.pointX=point.pageX,this.pointY=point.pageY,this.distX+=deltaX,this.distY+=deltaY,absDistX=Math.abs(this.distX),absDistY=Math.abs(this.distY),!(300<timestamp-this.endTime&&absDistX<10&&absDistY<10)){if(this.directionLocked||this.options.freeScroll||(absDistX>absDistY+this.options.directionLockThreshold?this.directionLocked="h":absDistY>=absDistX+this.options.directionLockThreshold?this.directionLocked="v":this.directionLocked="n"),"h"===this.directionLocked){if("vertical"===this.options.eventPassthrough)e.preventDefault();else if("horizontal"===this.options.eventPassthrough)return void(this.initiated=!1);deltaY=0}else if("v"===this.directionLocked){if("horizontal"===this.options.eventPassthrough)e.preventDefault();else if("vertical"===this.options.eventPassthrough)return void(this.initiated=!1);deltaX=0}deltaX=this.hasHorizontalScroll?deltaX:0,deltaY=this.hasVerticalScroll?deltaY:0,newX=this.x+deltaX,newY=this.y+deltaY,(0<newX||newX<this.maxScrollX)&&(newX=this.options.bounce?this.x+deltaX/3:0<newX?0:this.maxScrollX),(0<newY||newY<this.maxScrollY)&&(newY=this.options.bounce?this.y+deltaY/3:0<newY?0:this.maxScrollY),this.directionX=0<deltaX?-1:deltaX<0?1:0,this.directionY=0<deltaY?-1:deltaY<0?1:0,this.moved||this._execEvent("scrollStart"),this.moved=!0,this._translate(newX,newY),300<timestamp-this.startTime&&(this.startTime=timestamp,this.startX=this.x,this.startY=this.y,1===this.options.probeType&&this._execEvent("scroll")),1<this.options.probeType&&this._execEvent("scroll")}}},_end:function(e){if(this.enabled&&utils.eventType[e.type]===this.initiated){this.options.preventDefault&&!utils.preventDefaultException(e.target,this.options.preventDefaultException)&&e.preventDefault();var momentumX,momentumY,duration=utils.getTime()-this.startTime,newX=Math.round(this.x),newY=Math.round(this.y),distanceX=Math.abs(newX-this.startX),distanceY=Math.abs(newY-this.startY),time=0,easing="";if(this.isInTransition=0,this.initiated=0,this.endTime=utils.getTime(),!this.resetPosition(this.options.bounceTime)){if(this.scrollTo(newX,newY),!this.moved)return this.options.tap&&utils.tap(e,this.options.tap),this.options.click&&utils.click(e),void this._execEvent("scrollCancel");if(this._events.flick&&duration<200&&distanceX<100&&distanceY<100)this._execEvent("flick");else{if(this.options.momentum&&duration<300&&(momentumX=this.hasHorizontalScroll?utils.momentum(this.x,this.startX,duration,this.maxScrollX,this.options.bounce?this.wrapperWidth:0,this.options.deceleration,this):{destination:newX,duration:0},momentumY=this.hasVerticalScroll?utils.momentum(this.y,this.startY,duration,this.maxScrollY,this.options.bounce?this.wrapperHeight:0,this.options.deceleration,this):{destination:newY,duration:0},newX=momentumX.destination,newY=momentumY.destination,time=Math.max(momentumX.duration,momentumY.duration),this.isInTransition=1),this.options.snap){var snap=this._nearestSnap(newX,newY);this.currentPage=snap,time=this.options.snapSpeed||Math.max(Math.max(Math.min(Math.abs(newX-snap.x),1e3),Math.min(Math.abs(newY-snap.y),1e3)),300),newX=snap.x,newY=snap.y,this.directionX=0,this.directionY=0,easing=this.options.bounceEasing}if(newX!==this.x||newY!==this.y)return(0<newX||newX<this.maxScrollX||0<newY||newY<this.maxScrollY)&&(easing=utils.ease.quadratic),void this.scrollTo(newX,newY,time,easing);this._execEvent("scrollEnd")}}}},_resize:function(){var that=this;clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(function(){that.refresh()},this.options.resizePolling)},resetPosition:function(time){var x=this.x,y=this.y;if(time=time||0,!this.hasHorizontalScroll||0<this.x?x=0:this.x<this.maxScrollX&&(x=this.maxScrollX),!this.hasVerticalScroll||0<this.y?y=0:this.y<this.maxScrollY&&(y=this.maxScrollY),x===this.x&&y===this.y)return!1;if(this.options.ptr&&44<this.y&&-1*this.startY<$(window).height()&&!this.ptrLock){y=this.options.ptrOffset||44,this._execEvent("ptr"),this.ptrLock=!0;var self=this;setTimeout(function(){self.ptrLock=!1},500)}return this.scrollTo(x,y,time,this.options.bounceEasing),!0},disable:function(){this.enabled=!1},enable:function(){this.enabled=!0},refresh:function(){this.wrapperWidth=this.wrapper.clientWidth,this.wrapperHeight=this.wrapper.clientHeight,this.scrollerWidth=this.scroller.offsetWidth,this.scrollerHeight=this.scroller.offsetHeight,this.maxScrollX=this.wrapperWidth-this.scrollerWidth,this.maxScrollY=this.wrapperHeight-this.scrollerHeight,this.hasHorizontalScroll=this.options.scrollX&&this.maxScrollX<0,this.hasVerticalScroll=this.options.scrollY&&this.maxScrollY<0,this.hasHorizontalScroll||(this.maxScrollX=0,this.scrollerWidth=this.wrapperWidth),this.hasVerticalScroll||(this.maxScrollY=0,this.scrollerHeight=this.wrapperHeight),this.endTime=0,this.directionX=0,this.directionY=0,this.wrapperOffset=utils.offset(this.wrapper),this._execEvent("refresh"),this.resetPosition()},on:function(type,fn){this._events[type]||(this._events[type]=[]),this._events[type].push(fn)},off:function(type,fn){if(this._events[type]){var index=this._events[type].indexOf(fn);-1<index&&this._events[type].splice(index,1)}},_execEvent:function(type){if(this._events[type]){var i=0,l=this._events[type].length;if(l)for(;i<l;i++)this._events[type][i].apply(this,[].slice.call(arguments,1))}},scrollBy:function(x,y,time,easing){x=this.x+x,y=this.y+y,time=time||0,this.scrollTo(x,y,time,easing)},scrollTo:function(x,y,time,easing){easing=easing||utils.ease.circular,this.isInTransition=this.options.useTransition&&0<time,!time||this.options.useTransition&&easing.style?(this._transitionTimingFunction(easing.style),this._transitionTime(time),this._translate(x,y)):this._animate(x,y,time,easing.fn)},scrollToElement:function(el,time,offsetX,offsetY,easing){if(el=el.nodeType?el:this.scroller.querySelector(el)){var pos=utils.offset(el);pos.left-=this.wrapperOffset.left,pos.top-=this.wrapperOffset.top,!0===offsetX&&(offsetX=Math.round(el.offsetWidth/2-this.wrapper.offsetWidth/2)),!0===offsetY&&(offsetY=Math.round(el.offsetHeight/2-this.wrapper.offsetHeight/2)),pos.left-=offsetX||0,pos.top-=offsetY||0,pos.left=0<pos.left?0:pos.left<this.maxScrollX?this.maxScrollX:pos.left,pos.top=0<pos.top?0:pos.top<this.maxScrollY?this.maxScrollY:pos.top,time=null==time||"auto"===time?Math.max(Math.abs(this.x-pos.left),Math.abs(this.y-pos.top)):time,this.scrollTo(pos.left,pos.top,time,easing)}},_transitionTime:function(time){if(time=time||0,this.scrollerStyle[utils.style.transitionDuration]=time+"ms",!time&&utils.isBadAndroid&&(this.scrollerStyle[utils.style.transitionDuration]="0.001s"),this.indicators)for(var i=this.indicators.length;i--;)this.indicators[i].transitionTime(time)},_transitionTimingFunction:function(easing){if(this.scrollerStyle[utils.style.transitionTimingFunction]=easing,this.indicators)for(var i=this.indicators.length;i--;)this.indicators[i].transitionTimingFunction(easing)},_translate:function(x,y){if(this.options.useTransform?this.scrollerStyle[utils.style.transform]="translate("+x+"px,"+y+"px)"+this.translateZ:(x=Math.round(x),y=Math.round(y),this.scrollerStyle.left=x+"px",this.scrollerStyle.top=y+"px"),this.x=x,this.y=y,this.indicators)for(var i=this.indicators.length;i--;)this.indicators[i].updatePosition()},_initEvents:function(remove){var eventType=remove?utils.removeEvent:utils.addEvent,target=this.options.bindToWrapper?this.wrapper:window;eventType(window,"orientationchange",this),eventType(window,"resize",this),this.options.click&&eventType(this.wrapper,"click",this,!0),this.options.disableMouse||(eventType(this.wrapper,"mousedown",this),eventType(target,"mousemove",this),eventType(target,"mousecancel",this),eventType(target,"mouseup",this)),utils.hasPointer&&!this.options.disablePointer&&(eventType(this.wrapper,utils.prefixPointerEvent("pointerdown"),this),eventType(target,utils.prefixPointerEvent("pointermove"),this),eventType(target,utils.prefixPointerEvent("pointercancel"),this),eventType(target,utils.prefixPointerEvent("pointerup"),this)),utils.hasTouch&&!this.options.disableTouch&&(eventType(this.wrapper,"touchstart",this),eventType(target,"touchmove",this),eventType(target,"touchcancel",this),eventType(target,"touchend",this)),eventType(this.scroller,"transitionend",this),eventType(this.scroller,"webkitTransitionEnd",this),eventType(this.scroller,"oTransitionEnd",this),eventType(this.scroller,"MSTransitionEnd",this)},getComputedPosition:function(){var x,y,matrix=window.getComputedStyle(this.scroller,null);return this.options.useTransform?(x=+((matrix=matrix[utils.style.transform].split(")")[0].split(", "))[12]||matrix[4]),y=+(matrix[13]||matrix[5])):(x=+matrix.left.replace(/[^-\d.]/g,""),y=+matrix.top.replace(/[^-\d.]/g,"")),{x:x,y:y}},_initIndicators:function(){var indicator,interactive=this.options.interactiveScrollbars,customStyle="string"!=typeof this.options.scrollbars,indicators=[],that=this;this.indicators=[],this.options.scrollbars&&(this.options.scrollY&&(indicator={el:createDefaultScrollbar("v",interactive,this.options.scrollbars),interactive:interactive,defaultScrollbars:!0,customStyle:customStyle,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenX:!1},this.wrapper.appendChild(indicator.el),indicators.push(indicator)),this.options.scrollX&&(indicator={el:createDefaultScrollbar("h",interactive,this.options.scrollbars),interactive:interactive,defaultScrollbars:!0,customStyle:customStyle,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenY:!1},this.wrapper.appendChild(indicator.el),indicators.push(indicator))),this.options.indicators&&(indicators=indicators.concat(this.options.indicators));for(var i=indicators.length;i--;)this.indicators.push(new Indicator(this,indicators[i]));function _indicatorsMap(fn){for(var i=that.indicators.length;i--;)fn.call(that.indicators[i])}this.options.fadeScrollbars&&(this.on("scrollEnd",function(){_indicatorsMap(function(){this.fade()})}),this.on("scrollCancel",function(){_indicatorsMap(function(){this.fade()})}),this.on("scrollStart",function(){_indicatorsMap(function(){this.fade(1)})}),this.on("beforeScrollStart",function(){_indicatorsMap(function(){this.fade(1,!0)})})),this.on("refresh",function(){_indicatorsMap(function(){this.refresh()})}),this.on("destroy",function(){_indicatorsMap(function(){this.destroy()}),delete this.indicators})},_initWheel:function(){utils.addEvent(this.wrapper,"wheel",this),utils.addEvent(this.wrapper,"mousewheel",this),utils.addEvent(this.wrapper,"DOMMouseScroll",this),this.on("destroy",function(){utils.removeEvent(this.wrapper,"wheel",this),utils.removeEvent(this.wrapper,"mousewheel",this),utils.removeEvent(this.wrapper,"DOMMouseScroll",this)})},_wheel:function(e){if(this.enabled){e.preventDefault(),e.stopPropagation();var wheelDeltaX,wheelDeltaY,newX,newY,that=this;if(void 0===this.wheelTimeout&&that._execEvent("scrollStart"),clearTimeout(this.wheelTimeout),this.wheelTimeout=setTimeout(function(){that._execEvent("scrollEnd"),that.wheelTimeout=void 0},400),"deltaX"in e)1===e.deltaMode?(wheelDeltaX=-e.deltaX*this.options.mouseWheelSpeed,wheelDeltaY=-e.deltaY*this.options.mouseWheelSpeed):(wheelDeltaX=-e.deltaX,wheelDeltaY=-e.deltaY);else if("wheelDeltaX"in e)wheelDeltaX=e.wheelDeltaX/120*this.options.mouseWheelSpeed,wheelDeltaY=e.wheelDeltaY/120*this.options.mouseWheelSpeed;else if("wheelDelta"in e)wheelDeltaX=wheelDeltaY=e.wheelDelta/120*this.options.mouseWheelSpeed;else{if(!("detail"in e))return;wheelDeltaX=wheelDeltaY=-e.detail/3*this.options.mouseWheelSpeed}if(wheelDeltaX*=this.options.invertWheelDirection,wheelDeltaY*=this.options.invertWheelDirection,this.hasVerticalScroll||(wheelDeltaX=wheelDeltaY,wheelDeltaY=0),this.options.snap)return newX=this.currentPage.pageX,newY=this.currentPage.pageY,0<wheelDeltaX?newX--:wheelDeltaX<0&&newX++,0<wheelDeltaY?newY--:wheelDeltaY<0&&newY++,void this.goToPage(newX,newY);newX=this.x+Math.round(this.hasHorizontalScroll?wheelDeltaX:0),newY=this.y+Math.round(this.hasVerticalScroll?wheelDeltaY:0),0<newX?newX=0:newX<this.maxScrollX&&(newX=this.maxScrollX),0<newY?newY=0:newY<this.maxScrollY&&(newY=this.maxScrollY),this.scrollTo(newX,newY,0),this._execEvent("scroll")}},_initSnap:function(){this.currentPage={},"string"==typeof this.options.snap&&(this.options.snap=this.scroller.querySelectorAll(this.options.snap)),this.on("refresh",function(){var l,n,cx,cy,y,el,i=0,m=0,x=0,stepX=this.options.snapStepX||this.wrapperWidth,stepY=this.options.snapStepY||this.wrapperHeight;if(this.pages=[],this.wrapperWidth&&this.wrapperHeight&&this.scrollerWidth&&this.scrollerHeight){if(!0===this.options.snap)for(cx=Math.round(stepX/2),cy=Math.round(stepY/2);x>-this.scrollerWidth;){for(this.pages[i]=[],y=l=0;y>-this.scrollerHeight;)this.pages[i][l]={x:Math.max(x,this.maxScrollX),y:Math.max(y,this.maxScrollY),width:stepX,height:stepY,cx:x-cx,cy:y-cy},y-=stepY,l++;x-=stepX,i++}else for(l=(el=this.options.snap).length,n=-1;i<l;i++)(0===i||el[i].offsetLeft<=el[i-1].offsetLeft)&&(m=0,n++),this.pages[m]||(this.pages[m]=[]),x=Math.max(-el[i].offsetLeft,this.maxScrollX),y=Math.max(-el[i].offsetTop,this.maxScrollY),cx=x-Math.round(el[i].offsetWidth/2),cy=y-Math.round(el[i].offsetHeight/2),this.pages[m][n]={x:x,y:y,width:el[i].offsetWidth,height:el[i].offsetHeight,cx:cx,cy:cy},x>this.maxScrollX&&m++;this.goToPage(this.currentPage.pageX||0,this.currentPage.pageY||0,0),this.options.snapThreshold%1==0?(this.snapThresholdX=this.options.snapThreshold,this.snapThresholdY=this.options.snapThreshold):(this.snapThresholdX=Math.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].width*this.options.snapThreshold),this.snapThresholdY=Math.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].height*this.options.snapThreshold))}}),this.on("flick",function(){var time=this.options.snapSpeed||Math.max(Math.max(Math.min(Math.abs(this.x-this.startX),1e3),Math.min(Math.abs(this.y-this.startY),1e3)),300);this.goToPage(this.currentPage.pageX+this.directionX,this.currentPage.pageY+this.directionY,time)})},_nearestSnap:function(x,y){if(!this.pages.length)return{x:0,y:0,pageX:0,pageY:0};var i=0,l=this.pages.length,m=0;if(Math.abs(x-this.absStartX)<this.snapThresholdX&&Math.abs(y-this.absStartY)<this.snapThresholdY)return this.currentPage;for(0<x?x=0:x<this.maxScrollX&&(x=this.maxScrollX),0<y?y=0:y<this.maxScrollY&&(y=this.maxScrollY);i<l;i++)if(x>=this.pages[i][0].cx){x=this.pages[i][0].x;break}for(l=this.pages[i].length;m<l;m++)if(y>=this.pages[0][m].cy){y=this.pages[0][m].y;break}return i===this.currentPage.pageX&&((i+=this.directionX)<0?i=0:i>=this.pages.length&&(i=this.pages.length-1),x=this.pages[i][0].x),m===this.currentPage.pageY&&((m+=this.directionY)<0?m=0:m>=this.pages[0].length&&(m=this.pages[0].length-1),y=this.pages[0][m].y),{x:x,y:y,pageX:i,pageY:m}},goToPage:function(x,y,time,easing){easing=easing||this.options.bounceEasing,x>=this.pages.length?x=this.pages.length-1:x<0&&(x=0),y>=this.pages[x].length?y=this.pages[x].length-1:y<0&&(y=0);var posX=this.pages[x][y].x,posY=this.pages[x][y].y;time=void 0===time?this.options.snapSpeed||Math.max(Math.max(Math.min(Math.abs(posX-this.x),1e3),Math.min(Math.abs(posY-this.y),1e3)),300):time,this.currentPage={x:posX,y:posY,pageX:x,pageY:y},this.scrollTo(posX,posY,time,easing)},next:function(time,easing){var x=this.currentPage.pageX,y=this.currentPage.pageY;++x>=this.pages.length&&this.hasVerticalScroll&&(x=0,y++),this.goToPage(x,y,time,easing)},prev:function(time,easing){var x=this.currentPage.pageX,y=this.currentPage.pageY;--x<0&&this.hasVerticalScroll&&(x=0,y--),this.goToPage(x,y,time,easing)},_initKeys:function(){var i,keys={pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40};if("object"==typeof this.options.keyBindings)for(i in this.options.keyBindings)"string"==typeof this.options.keyBindings[i]&&(this.options.keyBindings[i]=this.options.keyBindings[i].toUpperCase().charCodeAt(0));else this.options.keyBindings={};for(i in keys)this.options.keyBindings[i]=this.options.keyBindings[i]||keys[i];utils.addEvent(window,"keydown",this),this.on("destroy",function(){utils.removeEvent(window,"keydown",this)})},_key:function(e){if(this.enabled){var pos,snap=this.options.snap,newX=snap?this.currentPage.pageX:this.x,newY=snap?this.currentPage.pageY:this.y,now=utils.getTime(),prevTime=this.keyTime||0;switch(this.options.useTransition&&this.isInTransition&&(pos=this.getComputedPosition(),this._translate(Math.round(pos.x),Math.round(pos.y)),this.isInTransition=!1),this.keyAcceleration=now-prevTime<200?Math.min(this.keyAcceleration+.25,50):0,e.keyCode){case this.options.keyBindings.pageUp:this.hasHorizontalScroll&&!this.hasVerticalScroll?newX+=snap?1:this.wrapperWidth:newY+=snap?1:this.wrapperHeight;break;case this.options.keyBindings.pageDown:this.hasHorizontalScroll&&!this.hasVerticalScroll?newX-=snap?1:this.wrapperWidth:newY-=snap?1:this.wrapperHeight;break;case this.options.keyBindings.end:newX=snap?this.pages.length-1:this.maxScrollX,newY=snap?this.pages[0].length-1:this.maxScrollY;break;case this.options.keyBindings.home:newY=newX=0;break;case this.options.keyBindings.left:newX+=snap?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.up:newY+=snap?1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.right:newX-=snap?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.down:newY-=snap?1:5+this.keyAcceleration>>0;break;default:return}snap?this.goToPage(newX,newY):(0<newX?(newX=0,this.keyAcceleration=0):newX<this.maxScrollX&&(newX=this.maxScrollX,this.keyAcceleration=0),0<newY?(newY=0,this.keyAcceleration=0):newY<this.maxScrollY&&(newY=this.maxScrollY,this.keyAcceleration=0),this.scrollTo(newX,newY,0),this.keyTime=now)}},_animate:function(destX,destY,duration,easingFn){var that=this,startX=this.x,startY=this.y,startTime=utils.getTime(),destTime=startTime+duration;this.isAnimating=!0,function step(){var newX,newY,easing,now=utils.getTime();if(destTime<=now)return that.isAnimating=!1,that._translate(destX,destY),void(that.resetPosition(that.options.bounceTime)||that._execEvent("scrollEnd"));easing=easingFn(now=(now-startTime)/duration),newX=(destX-startX)*easing+startX,newY=(destY-startY)*easing+startY,that._translate(newX,newY),that.isAnimating&&rAF(step),3===that.options.probeType&&that._execEvent("scroll")}()},handleEvent:function(e){switch(e.type){case"touchstart":case"pointerdown":case"MSPointerDown":case"mousedown":this._start(e);break;case"touchmove":case"pointermove":case"MSPointerMove":case"mousemove":this._move(e);break;case"touchend":case"pointerup":case"MSPointerUp":case"mouseup":case"touchcancel":case"pointercancel":case"MSPointerCancel":case"mousecancel":this._end(e);break;case"orientationchange":case"resize":this._resize();break;case"transitionend":case"webkitTransitionEnd":case"oTransitionEnd":case"MSTransitionEnd":this._transitionEnd(e);break;case"wheel":case"DOMMouseScroll":case"mousewheel":this._wheel(e);break;case"keydown":this._key(e);break;case"click":e._constructed||(e.preventDefault(),e.stopPropagation())}}},Indicator.prototype={handleEvent:function(e){switch(e.type){case"touchstart":case"pointerdown":case"MSPointerDown":case"mousedown":this._start(e);break;case"touchmove":case"pointermove":case"MSPointerMove":case"mousemove":this._move(e);break;case"touchend":case"pointerup":case"MSPointerUp":case"mouseup":case"touchcancel":case"pointercancel":case"MSPointerCancel":case"mousecancel":this._end(e)}},destroy:function(){this.options.interactive&&(utils.removeEvent(this.indicator,"touchstart",this),utils.removeEvent(this.indicator,utils.prefixPointerEvent("pointerdown"),this),utils.removeEvent(this.indicator,"mousedown",this),utils.removeEvent(window,"touchmove",this),utils.removeEvent(window,utils.prefixPointerEvent("pointermove"),this),utils.removeEvent(window,"mousemove",this),utils.removeEvent(window,"touchend",this),utils.removeEvent(window,utils.prefixPointerEvent("pointerup"),this),utils.removeEvent(window,"mouseup",this)),this.options.defaultScrollbars&&this.wrapper.parentNode.removeChild(this.wrapper)},_start:function(e){var point=e.touches?e.touches[0]:e;e.preventDefault(),e.stopPropagation(),this.transitionTime(),this.initiated=!0,this.moved=!1,this.lastPointX=point.pageX,this.lastPointY=point.pageY,this.startTime=utils.getTime(),this.options.disableTouch||utils.addEvent(window,"touchmove",this),this.options.disablePointer||utils.addEvent(window,utils.prefixPointerEvent("pointermove"),this),this.options.disableMouse||utils.addEvent(window,"mousemove",this),this.scroller._execEvent("beforeScrollStart")},_move:function(e){var deltaX,deltaY,newX,newY,point=e.touches?e.touches[0]:e,timestamp=utils.getTime();this.moved||this.scroller._execEvent("scrollStart"),this.moved=!0,deltaX=point.pageX-this.lastPointX,this.lastPointX=point.pageX,deltaY=point.pageY-this.lastPointY,this.lastPointY=point.pageY,newX=this.x+deltaX,newY=this.y+deltaY,this._pos(newX,newY),1===this.scroller.options.probeType&&300<timestamp-this.startTime?(this.startTime=timestamp,this.scroller._execEvent("scroll")):1<this.scroller.options.probeType&&this.scroller._execEvent("scroll"),e.preventDefault(),e.stopPropagation()},_end:function(e){if(this.initiated){if(this.initiated=!1,e.preventDefault(),e.stopPropagation(),utils.removeEvent(window,"touchmove",this),utils.removeEvent(window,utils.prefixPointerEvent("pointermove"),this),utils.removeEvent(window,"mousemove",this),this.scroller.options.snap){var snap=this.scroller._nearestSnap(this.scroller.x,this.scroller.y),time=this.options.snapSpeed||Math.max(Math.max(Math.min(Math.abs(this.scroller.x-snap.x),1e3),Math.min(Math.abs(this.scroller.y-snap.y),1e3)),300);this.scroller.x===snap.x&&this.scroller.y===snap.y||(this.scroller.directionX=0,this.scroller.directionY=0,this.scroller.currentPage=snap,this.scroller.scrollTo(snap.x,snap.y,time,this.scroller.options.bounceEasing))}this.moved&&this.scroller._execEvent("scrollEnd")}},transitionTime:function(time){time=time||0,this.indicatorStyle[utils.style.transitionDuration]=time+"ms",!time&&utils.isBadAndroid&&(this.indicatorStyle[utils.style.transitionDuration]="0.001s")},transitionTimingFunction:function(easing){this.indicatorStyle[utils.style.transitionTimingFunction]=easing},refresh:function(){this.transitionTime(),this.options.listenX&&!this.options.listenY?this.indicatorStyle.display=this.scroller.hasHorizontalScroll?"block":"none":this.options.listenY&&!this.options.listenX?this.indicatorStyle.display=this.scroller.hasVerticalScroll?"block":"none":this.indicatorStyle.display=this.scroller.hasHorizontalScroll||this.scroller.hasVerticalScroll?"block":"none",this.scroller.hasHorizontalScroll&&this.scroller.hasVerticalScroll?(utils.addClass(this.wrapper,"iScrollBothScrollbars"),utils.removeClass(this.wrapper,"iScrollLoneScrollbar"),this.options.defaultScrollbars&&this.options.customStyle&&(this.options.listenX?this.wrapper.style.right="8px":this.wrapper.style.bottom="8px")):(utils.removeClass(this.wrapper,"iScrollBothScrollbars"),utils.addClass(this.wrapper,"iScrollLoneScrollbar"),this.options.defaultScrollbars&&this.options.customStyle&&(this.options.listenX?this.wrapper.style.right="2px":this.wrapper.style.bottom="2px")),this.options.listenX&&(this.wrapperWidth=this.wrapper.clientWidth,this.options.resize?(this.indicatorWidth=Math.max(Math.round(this.wrapperWidth*this.wrapperWidth/(this.scroller.scrollerWidth||this.wrapperWidth||1)),8),this.indicatorStyle.width=this.indicatorWidth+"px"):this.indicatorWidth=this.indicator.clientWidth,this.maxPosX=this.wrapperWidth-this.indicatorWidth,"clip"===this.options.shrink?(this.minBoundaryX=8-this.indicatorWidth,this.maxBoundaryX=this.wrapperWidth-8):(this.minBoundaryX=0,this.maxBoundaryX=this.maxPosX),this.sizeRatioX=this.options.speedRatioX||this.scroller.maxScrollX&&this.maxPosX/this.scroller.maxScrollX),this.options.listenY&&(this.wrapperHeight=this.wrapper.clientHeight,this.options.resize?(this.indicatorHeight=Math.max(Math.round(this.wrapperHeight*this.wrapperHeight/(this.scroller.scrollerHeight||this.wrapperHeight||1)),8),this.indicatorStyle.height=this.indicatorHeight+"px"):this.indicatorHeight=this.indicator.clientHeight,this.maxPosY=this.wrapperHeight-this.indicatorHeight,"clip"===this.options.shrink?(this.minBoundaryY=8-this.indicatorHeight,this.maxBoundaryY=this.wrapperHeight-8):(this.minBoundaryY=0,this.maxBoundaryY=this.maxPosY),this.maxPosY=this.wrapperHeight-this.indicatorHeight,this.sizeRatioY=this.options.speedRatioY||this.scroller.maxScrollY&&this.maxPosY/this.scroller.maxScrollY),this.updatePosition()},updatePosition:function(){var x=this.options.listenX&&Math.round(this.sizeRatioX*this.scroller.x)||0,y=this.options.listenY&&Math.round(this.sizeRatioY*this.scroller.y)||0;this.options.ignoreBoundaries||(x<this.minBoundaryX?("scale"===this.options.shrink&&(this.width=Math.max(this.indicatorWidth+x,8),this.indicatorStyle.width=this.width+"px"),x=this.minBoundaryX):x>this.maxBoundaryX?"scale"===this.options.shrink?(this.width=Math.max(this.indicatorWidth-(x-this.maxPosX),8),this.indicatorStyle.width=this.width+"px",x=this.maxPosX+this.indicatorWidth-this.width):x=this.maxBoundaryX:"scale"===this.options.shrink&&this.width!==this.indicatorWidth&&(this.width=this.indicatorWidth,this.indicatorStyle.width=this.width+"px"),y<this.minBoundaryY?("scale"===this.options.shrink&&(this.height=Math.max(this.indicatorHeight+3*y,8),this.indicatorStyle.height=this.height+"px"),y=this.minBoundaryY):y>this.maxBoundaryY?"scale"===this.options.shrink?(this.height=Math.max(this.indicatorHeight-3*(y-this.maxPosY),8),this.indicatorStyle.height=this.height+"px",y=this.maxPosY+this.indicatorHeight-this.height):y=this.maxBoundaryY:"scale"===this.options.shrink&&this.height!==this.indicatorHeight&&(this.height=this.indicatorHeight,this.indicatorStyle.height=this.height+"px")),this.x=x,this.y=y,this.scroller.options.useTransform?this.indicatorStyle[utils.style.transform]="translate("+x+"px,"+y+"px)"+this.scroller.translateZ:(this.indicatorStyle.left=x+"px",this.indicatorStyle.top=y+"px")},_pos:function(x,y){x<0?x=0:x>this.maxPosX&&(x=this.maxPosX),y<0?y=0:y>this.maxPosY&&(y=this.maxPosY),x=this.options.listenX?Math.round(x/this.sizeRatioX):this.scroller.x,y=this.options.listenY?Math.round(y/this.sizeRatioY):this.scroller.y,this.scroller.scrollTo(x,y)},fade:function(val,hold){if(!hold||this.visible){clearTimeout(this.fadeTimeout),this.fadeTimeout=null;var time=val?250:500,delay=val?0:300;val=val?"1":"0",this.wrapperStyle[utils.style.transitionDuration]=time+"ms",this.fadeTimeout=setTimeout(function(val){this.wrapperStyle.opacity=val,this.visible=+val}.bind(this,val),delay)}}},IScroll.utils=utils,window.IScroll=IScroll}(window),function($){"use strict";var _zeptoMethodCache={scrollTop:$.fn.scrollTop,scrollLeft:$.fn.scrollLeft};$.extend($.fn,{scrollTop:function(top,dur){if(this.length){var scroller=this.data("scroller");return scroller&&scroller.scroller?scroller.scrollTop(top,dur):_zeptoMethodCache.scrollTop.apply(this,arguments)}}}),$.extend($.fn,{scrollLeft:function(left,dur){if(this.length){var scroller=this.data("scroller");return scroller&&scroller.scroller?scroller.scrollLeft(left,dur):_zeptoMethodCache.scrollLeft.apply(this,arguments)}}});var Scroller=function(pageContent,_options){var $pageContent=this.$pageContent=$(pageContent);this.options=$.extend({},this._defaults,_options);var type=this.options.type;if("js"===type||"auto"===type&&$.device.android&&-1<$.compareVersion("4.4.0",$.device.osVersion)||"auto"===type&&$.device.ios&&-1<$.compareVersion("6.0.0",$.device.osVersion)){if(!$pageContent.find(".content-inner")[0])$pageContent.children().length<1?$pageContent.children().wrapAll('<div class="content-inner"></div>'):$pageContent.html('<div class="content-inner">'+$pageContent.html()+"</div>");if($pageContent.hasClass("pull-to-refresh-content")){var minHeight=$(window).height()+($pageContent.prev().hasClass(".bar")?1:61);$pageContent.find(".content-inner").css("min-height",minHeight+"px")}var ptr=$(pageContent).hasClass("pull-to-refresh-content"),useTransform=0===$pageContent.find(".fixed-tab").length,options={probeType:1,mouseWheel:!0,click:$.device.androidChrome,useTransform:useTransform,scrollX:!0};ptr&&(options.ptr=!0,options.ptrOffset=44),this.scroller=new IScroll(pageContent,options),this._bindEventToDomWhenJs(),$.initPullToRefresh=$._pullToRefreshJSScroll.initPullToRefresh,$.pullToRefreshDone=$._pullToRefreshJSScroll.pullToRefreshDone,$.pullToRefreshTrigger=$._pullToRefreshJSScroll.pullToRefreshTrigger,$.destroyToRefresh=$._pullToRefreshJSScroll.destroyToRefresh,$pageContent.addClass("javascript-scroll"),useTransform||$pageContent.find(".content-inner").css({width:"100%",position:"absolute"});var nativeScrollTop=this.$pageContent[0].scrollTop;nativeScrollTop&&(this.$pageContent[0].scrollTop=0,this.scrollTop(nativeScrollTop))}else $pageContent.addClass("native-scroll")};Scroller.prototype={_defaults:{type:"native"},_bindEventToDomWhenJs:function(){if(this.scroller){var self=this;this.scroller.on("scrollStart",function(){self.$pageContent.trigger("scrollstart")}),this.scroller.on("scroll",function(){self.$pageContent.trigger("scroll")}),this.scroller.on("scrollEnd",function(){self.$pageContent.trigger("scrollend")})}},scrollTop:function(top,dur){return this.scroller?void 0===top?-1*this.scroller.getComputedPosition().y:(this.scroller.scrollTo(0,-1*top,dur),this):this.$pageContent.scrollTop(top,dur)},scrollLeft:function(left,dur){return this.scroller?void 0===left?-1*this.scroller.getComputedPosition().x:(this.scroller.scrollTo(-1*left,0),this):this.$pageContent.scrollTop(left,dur)},on:function(event,callback){return this.scroller?this.scroller.on(event,function(){callback.call(this.wrapper)}):this.$pageContent.on(event,callback),this},off:function(event,callback){return this.scroller?this.scroller.off(event,callback):this.$pageContent.off(event,callback),this},refresh:function(){return this.scroller&&this.scroller.refresh(),this},scrollHeight:function(){return this.scroller?this.scroller.scrollerHeight:this.$pageContent[0].scrollHeight}};var old=$.fn.scroller;$.fn.scroller=function(option){var internal_return,args=Array.apply(null,arguments);return args.shift(),this.each(function(){var $this=$(this),options=$.extend({},$this.dataset(),"object"==typeof option&&option),data=$this.data("scroller");if(data||$this.data("scroller",data=new Scroller(this,options)),"string"==typeof option&&"function"==typeof data[option]&&void 0!==(internal_return=data[option].apply(data,args)))return!1}),void 0!==internal_return?internal_return:this},$.fn.scroller.Constructor=Scroller,$.fn.scroller.noConflict=function(){return $.fn.scroller=old,this},$(function(){$('[data-toggle="scroller"]').scroller()}),$.refreshScroller=function(content){content?$(content).scroller("refresh"):$(".javascript-scroll").each(function(){$(this).scroller("refresh")})},$.initScroller=function(option){this.options=$.extend({},"object"==typeof option&&option),$('[data-toggle="scroller"],.content').scroller(option)},$.getScroller=function(content){return(content=content.hasClass("content")?content:content.parents(".content"))?$(content).data("scroller"):$(".content.javascript-scroll").data("scroller")},$.detectScrollerType=function(content){if(content)return $(content).data("scroller")&&$(content).data("scroller").scroller?"js":"native"}}(Zepto),function($){"use strict";var showTab=function(tab,tabLink,force){var newTab=$(tab);if(2===arguments.length&&"boolean"==typeof tabLink&&(force=tabLink),0===newTab.length)return!1;if(newTab.hasClass("active"))return force&&newTab.trigger("show"),!1;var tabs=newTab.parent(".tabs");if(0===tabs.length)return!1;var oldTab=tabs.children(".tab.active").removeClass("active");if(newTab.addClass("active"),newTab.trigger("show"),tabLink?tabLink=$(tabLink):(!(tabLink=$("string"==typeof tab?'.tab-link[href="'+tab+'"]':'.tab-link[href="#'+newTab.attr("id")+'"]'))||tabLink&&0===tabLink.length)&&$("[data-tab]").each(function(){newTab.is($(this).attr("data-tab"))&&(tabLink=$(this))}),0!==tabLink.length){var oldTabLink;if(oldTab&&0<oldTab.length){var oldTabId=oldTab.attr("id");oldTabId&&(oldTabLink=$('.tab-link[href="#'+oldTabId+'"]')),(!oldTabLink||oldTabLink&&0===oldTabLink.length)&&$("[data-tab]").each(function(){oldTab.is($(this).attr("data-tab"))&&(oldTabLink=$(this))})}return tabLink&&0<tabLink.length&&tabLink.addClass("active"),oldTabLink&&0<oldTabLink.length&&oldTabLink.removeClass("active"),tabLink.trigger("active"),!0}},old=$.showTab;$.showTab=showTab,$.showTab.noConflict=function(){return $.showTab=old,this},$(document).on("click",".tab-link",function(e){e.preventDefault();var clicked=$(this);showTab(clicked.data("tab")||clicked.attr("href"),clicked)})}(Zepto),function($){"use strict";$.initFixedTab=function(){0!==$(".fixed-tab").length&&$(".fixed-tab").fixedTab()};var FixedTab=function(pageContent,_options){var $pageContent=this.$pageContent=$(pageContent),shadow=$pageContent.clone(),fixedTop=$pageContent[0].getBoundingClientRect().top;shadow.css("visibility","hidden"),this.options=$.extend({},this._defaults,{fixedTop:fixedTop,shadow:shadow,offset:0},_options),this._bindEvents()};FixedTab.prototype={_defaults:{offset:0},_bindEvents:function(){this.$pageContent.parents(".content").on("scroll",this._scrollHandler.bind(this)),this.$pageContent.on("active",".tab-link",this._tabLinkHandler.bind(this))},_tabLinkHandler:function(ev){var isFixed=0<$(ev.target).parents(".buttons-fixed").length,fixedTop=this.options.fixedTop,offset=this.options.offset;$.refreshScroller(),isFixed&&this.$pageContent.parents(".content").scrollTop(fixedTop-offset)},_scrollHandler:function(ev){var $scroller=$(ev.target),$pageContent=this.$pageContent,shadow=this.options.shadow,offset=this.options.offset;this.options.fixedTop-offset<=$scroller.scrollTop()?(shadow.insertAfter($pageContent),$pageContent.addClass("buttons-fixed").css("top",offset)):(shadow.remove(),$pageContent.removeClass("buttons-fixed").css("top",0))}},$.fn.fixedTab=function(option){Array.apply(null,arguments).shift(),this.each(function(){var $this=$(this),options=$.extend({},$this.dataset(),"object"==typeof option&&option),data=$this.data("fixedtab");data||$this.data("fixedtab",data=new FixedTab(this,options))})},$.fn.fixedTab.Constructor=FixedTab,$(document).on("pageInit",function(){$.initFixedTab()})}(Zepto),function($){"use strict";var refreshTime=0;$._pullToRefreshJSScroll={initPullToRefresh:function(pageContainer){var eventsTarget=$(pageContainer);if(eventsTarget.hasClass("pull-to-refresh-content")||(eventsTarget=eventsTarget.find(".pull-to-refresh-content")),eventsTarget&&0!==eventsTarget.length){var page=eventsTarget.hasClass("content")?eventsTarget:eventsTarget.parents(".content"),scroller=$.getScroller(page[0]);if(scroller){var container=eventsTarget;scroller.on("scroll",handleScroll),scroller.scroller.on("ptr",handleRefresh),eventsTarget[0].destroyPullToRefresh=function(){scroller.off("scroll",handleScroll),scroller.scroller.off("ptr",handleRefresh)}}}function handleScroll(){container.hasClass("refreshing")||(44<=-1*scroller.scrollTop()?container.removeClass("pull-down").addClass("pull-up"):container.removeClass("pull-up").addClass("pull-down"))}function handleRefresh(){container.hasClass("refreshing")||(container.removeClass("pull-down pull-up"),container.addClass("refreshing transitioning"),container.trigger("refresh"),refreshTime=+new Date)}},pullToRefreshDone:function(container){if(0===(container=$(container)).length&&(container=$(".pull-to-refresh-content.refreshing")),0!==container.length){var interval=+new Date-refreshTime,timeOut=1e3<interval?0:1e3-interval,scroller=$.getScroller(container);setTimeout(function(){scroller.refresh(),container.removeClass("refreshing"),container.transitionEnd(function(){container.removeClass("transitioning")})},timeOut)}},pullToRefreshTrigger:function(container){0===(container=$(container)).length&&(container=$(".pull-to-refresh-content")),container.hasClass("refreshing")||(container.addClass("refreshing"),$.getScroller(container).scrollTop(45,200),container.trigger("refresh"))},destroyPullToRefresh:function(pageContainer){var pullToRefreshContent=(pageContainer=$(pageContainer)).hasClass("pull-to-refresh-content")?pageContainer:pageContainer.find(".pull-to-refresh-content");0!==pullToRefreshContent.length&&pullToRefreshContent[0].destroyPullToRefresh&&pullToRefreshContent[0].destroyPullToRefresh()}}}(Zepto),function($){"use strict";$.initPullToRefresh=function(pageContainer){var eventsTarget=$(pageContainer);if(eventsTarget.hasClass("pull-to-refresh-content")||(eventsTarget=eventsTarget.find(".pull-to-refresh-content")),eventsTarget&&0!==eventsTarget.length){var isTouched,isMoved,isScrolling,touchesDiff,container,translate,scrollTop,wasScrolled,triggerDistance,dynamicTriggerDistance,touchesStart={},refresh=!1,useTranslate=!1,startTranslate=0;(container=eventsTarget).attr("data-ptr-distance")?dynamicTriggerDistance=!0:triggerDistance=44,eventsTarget.on($.touchEvents.start,handleTouchStart),eventsTarget.on($.touchEvents.move,handleTouchMove),eventsTarget.on($.touchEvents.end,handleTouchEnd),eventsTarget[0].destroyPullToRefresh=function(){eventsTarget.off($.touchEvents.start,handleTouchStart),eventsTarget.off($.touchEvents.move,handleTouchMove),eventsTarget.off($.touchEvents.end,handleTouchEnd)}}function handleTouchStart(e){if(isTouched){if(!$.device.android)return;if("targetTouches"in e&&1<e.targetTouches.length)return}isTouched=!(isMoved=!1),wasScrolled=isScrolling=void 0,touchesStart.x="touchstart"===e.type?e.targetTouches[0].pageX:e.pageX,touchesStart.y="touchstart"===e.type?e.targetTouches[0].pageY:e.pageY,(new Date).getTime(),container=$(this)}function handleTouchMove(e){if(isTouched){var pageX="touchmove"===e.type?e.targetTouches[0].pageX:e.pageX,pageY="touchmove"===e.type?e.targetTouches[0].pageY:e.pageY;if(void 0===isScrolling&&(isScrolling=!!(isScrolling||Math.abs(pageY-touchesStart.y)>Math.abs(pageX-touchesStart.x))),isScrolling){if(scrollTop=container[0].scrollTop,void 0===wasScrolled&&0!==scrollTop&&(wasScrolled=!0),!isMoved){if(container.removeClass("transitioning"),scrollTop>container[0].offsetHeight)return void(isTouched=!1);dynamicTriggerDistance&&0<=(triggerDistance=container.attr("data-ptr-distance")).indexOf("%")&&(triggerDistance=container[0].offsetHeight*parseInt(triggerDistance,10)/100),startTranslate=container.hasClass("refreshing")?triggerDistance:0,useTranslate=container[0].scrollHeight===container[0].offsetHeight||!$.device.ios,useTranslate=!0}if(isMoved=!0,!(0<(touchesDiff=pageY-touchesStart.y)&&scrollTop<=0||scrollTop<0))return container.removeClass("pull-up pull-down"),void(refresh=!1);$.device.ios&&7<parseInt($.device.osVersion.split(".")[0],10)&&0===scrollTop&&!wasScrolled&&(useTranslate=!0),useTranslate&&(e.preventDefault(),translate=Math.pow(touchesDiff,.85)+startTranslate,container.transform("translate3d(0,"+translate+"px,0)")),useTranslate&&Math.pow(touchesDiff,.85)>triggerDistance||!useTranslate&&2*triggerDistance<=touchesDiff?(refresh=!0,container.addClass("pull-up").removeClass("pull-down")):(refresh=!1,container.removeClass("pull-up").addClass("pull-down"))}else isTouched=!1}}function handleTouchEnd(){if(isTouched&&isMoved){if(translate&&(container.addClass("transitioning"),translate=0),container.transform(""),refresh){if(container.hasClass("refreshing"))return;container.addClass("refreshing"),container.trigger("refresh")}else container.removeClass("pull-down");isMoved=isTouched=!1}else isMoved=isTouched=!1}},$.pullToRefreshDone=function(container){$(window).scrollTop(0),0===(container=$(container)).length&&(container=$(".pull-to-refresh-content.refreshing")),container.removeClass("refreshing").addClass("transitioning"),container.transitionEnd(function(){container.removeClass("transitioning pull-up pull-down")})},$.pullToRefreshTrigger=function(container){0===(container=$(container)).length&&(container=$(".pull-to-refresh-content")),container.hasClass("refreshing")||(container.addClass("transitioning refreshing"),container.trigger("refresh"))},$.destroyPullToRefresh=function(pageContainer){var pullToRefreshContent=(pageContainer=$(pageContainer)).hasClass("pull-to-refresh-content")?pageContainer:pageContainer.find(".pull-to-refresh-content");0!==pullToRefreshContent.length&&pullToRefreshContent[0].destroyPullToRefresh&&pullToRefreshContent[0].destroyPullToRefresh()}}(Zepto),function($){"use strict";function handleInfiniteScroll(){var virtualList,inf=$(this),scroller=$.getScroller(inf),scrollTop=scroller.scrollTop(),scrollHeight=scroller.scrollHeight(),height=inf[0].offsetHeight,distance=inf[0].getAttribute("data-distance"),virtualListContainer=inf.find(".virtual-list"),onTop=inf.hasClass("infinite-scroll-top");if(distance||(distance=50),"string"==typeof distance&&0<=distance.indexOf("%")&&(distance=parseInt(distance,10)/100*height),height<distance&&(distance=height),onTop)scrollTop<distance&&inf.trigger("infinite");else if(scrollHeight-distance<=scrollTop+height){if(0<virtualListContainer.length&&(virtualList=virtualListContainer[0].f7VirtualList)&&!virtualList.reachEnd)return;inf.trigger("infinite")}}$.attachInfiniteScroll=function(infiniteContent){$.getScroller(infiniteContent).on("scroll",handleInfiniteScroll)},$.detachInfiniteScroll=function(infiniteContent){$.getScroller(infiniteContent).off("scroll",handleInfiniteScroll)},$.initInfiniteScroll=function(pageContainer){var infiniteContent=(pageContainer=$(pageContainer)).hasClass("infinite-scroll")?pageContainer:pageContainer.find(".infinite-scroll");0!==infiniteContent.length&&($.attachInfiniteScroll(infiniteContent),pageContainer.forEach(function(v){if($(v).hasClass("infinite-scroll-top")){var height=v.scrollHeight-v.clientHeight;$(v).scrollTop(height)}}),pageContainer.on("pageBeforeRemove",function detachEvents(){$.detachInfiniteScroll(infiniteContent),pageContainer.off("pageBeforeRemove",detachEvents)}))}}(Zepto),function($){"use strict";$(function(){$(document).on("focus",".searchbar input",function(e){$(e.target).parents(".searchbar").addClass("searchbar-active")}),$(document).on("click",".searchbar-cancel",function(e){$(e.target).parents(".searchbar").removeClass("searchbar-active")}),$(document).on("blur",".searchbar input",function(e){$(e.target).parents(".searchbar").removeClass("searchbar-active")})})}(Zepto),function($){"use strict";$.allowPanelOpen=!0,$.openPanel=function(panel){if(!$.allowPanelOpen)return!1;"left"!==panel&&"right"!==panel||(panel=".panel-"+panel);var direction=(panel=panel?$(panel):$(".panel").eq(0)).hasClass("panel-right")?"right":"left";if(0===panel.length||panel.hasClass("active"))return!1;$.closePanel(),$.allowPanelOpen=!1;var effect=panel.hasClass("panel-reveal")?"reveal":"cover";panel.css({display:"block"}).addClass("active"),panel.trigger("open");panel[0].clientLeft;var transitionEndTarget="reveal"===effect?$($.getCurrentPage()):panel;return function panelTransitionEnd(){transitionEndTarget.transitionEnd(function(e){e.target===transitionEndTarget[0]?(panel.hasClass("active")?panel.trigger("opened"):panel.trigger("closed"),$.allowPanelOpen=!0):panelTransitionEnd()})}(),$(document.body).addClass("with-panel-"+direction+"-"+effect),!0},$.closePanel=function(){var activePanel=$(".panel.active");if(0===activePanel.length)return!1;var effect=activePanel.hasClass("panel-reveal")?"reveal":"cover",panelPosition=activePanel.hasClass("panel-left")?"left":"right";activePanel.removeClass("active");var transitionEndTarget="reveal"===effect?$(".page"):activePanel;activePanel.trigger("close"),$.allowPanelOpen=!1,transitionEndTarget.transitionEnd(function(){activePanel.hasClass("active")||(activePanel.css({display:""}),activePanel.trigger("closed"),$("body").removeClass("panel-closing"),$.allowPanelOpen=!0)}),$("body").addClass("panel-closing").removeClass("with-panel-"+panelPosition+"-"+effect)},$(document).on("click",".open-panel",function(e){var panel=$(e.target).data("panel");$.openPanel(panel)}),$(document).on("click",".close-panel, .panel-overlay",function(e){$.closePanel()}),$.initSwipePanels=function(){var panel,side,swipePanel=$.smConfig.swipePanel,swipePanelOnlyClose=$.smConfig.swipePanelOnlyClose;if(swipePanel||swipePanelOnlyClose){var isTouched,isMoved,isScrolling,touchStartTime,touchesDiff,translate,opened,panelWidth,effect,direction,panelOverlay=$(".panel-overlay"),touchesStart={},views=$(".page");$(document).on($.touchEvents.start,function(e){if($.allowPanelOpen&&(swipePanel||swipePanelOnlyClose)&&!isTouched&&!(0<$(".modal-in, .photo-browser-in").length)){if(touchesStart.x="touchstart"===e.type?e.targetTouches[0].pageX:e.pageX,touchesStart.y="touchstart"===e.type?e.targetTouches[0].pageY:e.pageY,0<$(".panel.active").length)side=$(".panel.active").hasClass("panel-left")?"left":"right";else{if(swipePanelOnlyClose)return;side=swipePanel}side&&(panel=$(".panel.panel-"+side))[0]&&(opened=panel.hasClass("active"),isTouched=!(isMoved=!1),isScrolling=void 0,touchStartTime=(new Date).getTime(),direction=void 0)}}),$(document).on($.touchEvents.move,function(e){if(isTouched&&panel[0]&&!e.f7PreventPanelSwipe){var pageX="touchmove"===e.type?e.targetTouches[0].pageX:e.pageX,pageY="touchmove"===e.type?e.targetTouches[0].pageY:e.pageY;if(void 0===isScrolling&&(isScrolling=!!(isScrolling||Math.abs(pageY-touchesStart.y)>Math.abs(pageX-touchesStart.x))),isScrolling)isTouched=!1;else if(!direction&&(direction=pageX>touchesStart.x?"to-right":"to-left","left"===side&&"to-left"===direction&&!panel.hasClass("active")||"right"===side&&"to-right"===direction&&!panel.hasClass("active")))isTouched=!1;else{isMoved||(effect=panel.hasClass("panel-cover")?"cover":"reveal",opened||(panel.show(),panelOverlay.show()),panelWidth=panel[0].offsetWidth,panel.transition(0)),isMoved=!0,e.preventDefault();var threshold=opened?0:-2;"right"===side&&(threshold=-threshold),touchesDiff=pageX-touchesStart.x+threshold,"right"===side?(0<(translate=touchesDiff-(opened?panelWidth:0))&&(translate=0),translate<-panelWidth&&(translate=-panelWidth)):((translate=touchesDiff+(opened?panelWidth:0))<0&&(translate=0),panelWidth<translate&&(translate=panelWidth)),"reveal"===effect?(views.transform("translate3d("+translate+"px,0,0)").transition(0),panelOverlay.transform("translate3d("+translate+"px,0,0)")):panel.transform("translate3d("+translate+"px,0,0)").transition(0)}}}),$(document).on($.touchEvents.end,function(e){if(isTouched&&isMoved){isMoved=isTouched=!1;var action,timeDiff=(new Date).getTime()-touchStartTime,edge=0===translate||Math.abs(translate)===panelWidth;if("swap"==(action=opened?translate===-panelWidth?"reset":timeDiff<300&&0<=Math.abs(translate)||300<=timeDiff&&Math.abs(translate)<=panelWidth/2?"left"===side&&translate===panelWidth?"reset":"swap":"reset":0===translate?"reset":timeDiff<300&&0<Math.abs(translate)||300<=timeDiff&&Math.abs(translate)>=panelWidth/2?"swap":"reset")&&($.allowPanelOpen=!0,opened?($.closePanel(),edge&&(panel.css({display:""}),$("body").removeClass("panel-closing"))):$.openPanel(side),edge&&($.allowPanelOpen=!0)),"reset"===action)if(opened)$.allowPanelOpen=!0,$.openPanel(side);else if($.closePanel(),edge)$.allowPanelOpen=!0,panel.css({display:""});else{var target="reveal"===effect?views:panel;$("body").addClass("panel-closing"),target.transitionEnd(function(){$.allowPanelOpen=!0,panel.css({display:""}),$("body").removeClass("panel-closing")})}"reveal"===effect&&(views.transition(""),views.transform("")),panel.transition("").transform(""),panelOverlay.css({display:""}).transform("")}else isMoved=isTouched=!1})}},$.initSwipePanels()}(Zepto),function($){"use strict";window.CustomEvent||(window.CustomEvent=function(type,config){config=config||{bubbles:!1,cancelable:!1,detail:void 0};var e=document.createEvent("CustomEvent");return e.initCustomEvent(type,config.bubbles,config.cancelable,config.detail),e},window.CustomEvent.prototype=window.Event.prototype);var EVENTS_pageLoadStart="pageLoadStart",EVENTS_pageLoadCancel="pageLoadCancel",EVENTS_pageLoadError="pageLoadError",EVENTS_pageLoadComplete="pageLoadComplete",EVENTS_pageAnimationStart="pageAnimationStart",EVENTS_pageAnimationEnd="pageAnimationEnd",EVENTS_beforePageRemove="beforePageRemove",EVENTS_pageRemoved="pageRemoved",EVENTS_beforePageSwitch="beforePageSwitch",EVENTS_pageInit="pageInitInternal",Util={getUrlFragment:function(url){var hashIndex=url.indexOf("#");return-1===hashIndex?"":url.slice(hashIndex+1)},getAbsoluteUrl:function(url){var link=document.createElement("a");link.setAttribute("href",url);var absoluteUrl=link.href;return link=null,absoluteUrl},getBaseUrl:function(url){var hashIndex=url.indexOf("#");return-1===hashIndex?url.slice(0):url.slice(0,hashIndex)},toUrlObject:function(url){var fullUrl=this.getAbsoluteUrl(url);return{base:this.getBaseUrl(fullUrl),full:fullUrl,original:url,fragment:this.getUrlFragment(url)}},supportStorage:function(){var mod="sm.router.storage.ability";try{return sessionStorage.setItem(mod,mod),sessionStorage.removeItem(mod),!0}catch(e){return!1}}},routerConfig_sectionGroupClass="page-group",routerConfig_curPageClass="page-current",routerConfig_visiblePageClass="page-visible",routerConfig_pageClass="page",DIRECTION_leftToRight="from-left-to-right",DIRECTION_rightToLeft="from-right-to-left",theHistory=window.history,Router=function(){this.sessionNames={currentState:"sm.router.currentState",maxStateId:"sm.router.maxStateId"},this._init(),this.xhr=null,window.addEventListener("popstate",this._onPopState.bind(this))};Router.prototype._init=function(){this.$view=$("body"),this.cache={};var curPageId,$doc=$(document),currentUrl=location.href;this._saveDocumentIntoCache($doc,currentUrl);var $hashSection,currentUrlObj=Util.toUrlObject(currentUrl),$allSection=$doc.find("."+routerConfig_pageClass),$visibleSection=$doc.find("."+routerConfig_curPageClass),$curVisibleSection=$visibleSection.eq(0);if(currentUrlObj.fragment&&($hashSection=$doc.find("#"+currentUrlObj.fragment)),$hashSection&&$hashSection.length?$visibleSection=$hashSection.eq(0):$visibleSection.length||($visibleSection=$allSection.eq(0)),$visibleSection.attr("id")||$visibleSection.attr("id",this._generateRandomId()),$curVisibleSection.length&&$curVisibleSection.attr("id")!==$visibleSection.attr("id")&&$curVisibleSection.removeClass(routerConfig_curPageClass),$visibleSection.addClass(routerConfig_curPageClass),curPageId=$visibleSection.attr("id"),null===theHistory.state){var curState={id:this._getNextStateId(),url:Util.toUrlObject(currentUrl),pageId:curPageId};theHistory.replaceState(curState,"",currentUrl),this._saveAsCurrentState(curState),this._incMaxStateId()}},Router.prototype.load=function(url,ignoreCache){void 0===ignoreCache&&(ignoreCache=!1),this._isTheSameDocument(location.href,url)?this._switchToSection(Util.getUrlFragment(url)):(this._saveDocumentIntoCache($(document),location.href),this._switchToDocument(url,ignoreCache))},Router.prototype.forward=function(){theHistory.forward()},Router.prototype.back=function(){theHistory.back()},Router.prototype.loadPage=Router.prototype.load,Router.prototype._switchToSection=function(sectionId){if(sectionId){var $curPage=this._getCurrentSection(),$newPage=$("#"+sectionId);$curPage!==$newPage&&(this._animateSection($curPage,$newPage,DIRECTION_rightToLeft),this._pushNewState("#"+sectionId,sectionId))}},Router.prototype._switchToDocument=function(url,ignoreCache,isPushState,direction){var baseUrl=Util.toUrlObject(url).base;ignoreCache&&delete this.cache[baseUrl];var cacheDocument=this.cache[baseUrl],context=this;cacheDocument?this._doSwitchDocument(url,isPushState,direction):this._loadDocument(url,{success:function($doc){try{context._parseDocument(url,$doc),context._doSwitchDocument(url,isPushState,direction)}catch(e){location.href=url}},error:function(){location.href=url}})},Router.prototype._doSwitchDocument=function(url,isPushState,direction){void 0===isPushState&&(isPushState=!0);var $hashSection,urlObj=Util.toUrlObject(url),$currentDoc=this.$view.find("."+routerConfig_sectionGroupClass),$newDoc=$($("<div></div>").append(this.cache[urlObj.base].$content).html()),$allSection=$newDoc.find("."+routerConfig_pageClass),$visibleSection=$newDoc.find("."+routerConfig_curPageClass);urlObj.fragment&&($hashSection=$newDoc.find("#"+urlObj.fragment)),$hashSection&&$hashSection.length?$visibleSection=$hashSection.eq(0):$visibleSection.length||($visibleSection=$allSection.eq(0)),$visibleSection.attr("id")||$visibleSection.attr("id",this._generateRandomId());var $currentSection=this._getCurrentSection();$currentSection.trigger(EVENTS_beforePageSwitch,[$currentSection.attr("id"),$currentSection]),$allSection.removeClass(routerConfig_curPageClass),$visibleSection.addClass(routerConfig_curPageClass),this.$view.prepend($newDoc),this._animateDocument($currentDoc,$newDoc,$visibleSection,direction),isPushState&&this._pushNewState(url,$visibleSection.attr("id"))},Router.prototype._isTheSameDocument=function(url,anotherUrl){return Util.toUrlObject(url).base===Util.toUrlObject(anotherUrl).base},Router.prototype._loadDocument=function(url,callback){this.xhr&&this.xhr.readyState<4&&(this.xhr.onreadystatechange=function(){},this.xhr.abort(),this.dispatch(EVENTS_pageLoadCancel)),this.dispatch(EVENTS_pageLoadStart),callback=callback||{};var self=this;this.xhr=$.ajax({url:url,success:$.proxy(function(data,status,xhr){var $doc=$("<html></html>");$doc.append(data),callback.success&&callback.success.call(null,$doc,status,xhr)},this),error:function(xhr,status,err){callback.error&&callback.error.call(null,xhr,status,err),self.dispatch(EVENTS_pageLoadError)},complete:function(xhr,status){callback.complete&&callback.complete.call(null,xhr,status),self.dispatch(EVENTS_pageLoadComplete)}})},Router.prototype._parseDocument=function(url,$doc){if(!$doc.find("."+routerConfig_sectionGroupClass).length)throw new Error("missing router view mark: "+routerConfig_sectionGroupClass);this._saveDocumentIntoCache($doc,url)},Router.prototype._saveDocumentIntoCache=function(doc,url){var urlAsKey=Util.toUrlObject(url).base,$doc=$(doc);this.cache[urlAsKey]={$doc:$doc,$content:$doc.find("."+routerConfig_sectionGroupClass)}},Router.prototype._getLastState=function(){var currentState=sessionStorage.getItem(this.sessionNames.currentState);try{currentState=JSON.parse(currentState)}catch(e){currentState=null}return currentState},Router.prototype._saveAsCurrentState=function(state){sessionStorage.setItem(this.sessionNames.currentState,JSON.stringify(state))},Router.prototype._getNextStateId=function(){var maxStateId=sessionStorage.getItem(this.sessionNames.maxStateId);return maxStateId?parseInt(maxStateId,10)+1:1},Router.prototype._incMaxStateId=function(){sessionStorage.setItem(this.sessionNames.maxStateId,this._getNextStateId())},Router.prototype._animateDocument=function($from,$to,$visibleSection,direction){var sectionId=$visibleSection.attr("id"),$visibleSectionInFrom=$from.find("."+routerConfig_curPageClass);$visibleSectionInFrom.addClass(routerConfig_visiblePageClass).removeClass(routerConfig_curPageClass),$visibleSection.trigger(EVENTS_pageAnimationStart,[sectionId,$visibleSection]),this._animateElement($from,$to,direction),$from.animationEnd(function(){$visibleSectionInFrom.removeClass(routerConfig_visiblePageClass),$(window).trigger(EVENTS_beforePageRemove,[$from]),$from.remove(),$(window).trigger(EVENTS_pageRemoved)}),$to.animationEnd(function(){$visibleSection.trigger(EVENTS_pageAnimationEnd,[sectionId,$visibleSection]),$visibleSection.trigger(EVENTS_pageInit,[sectionId,$visibleSection])})},Router.prototype._animateSection=function($from,$to,direction){var toId=$to.attr("id");$from.trigger(EVENTS_beforePageSwitch,[$from.attr("id"),$from]),$from.removeClass(routerConfig_curPageClass),$to.addClass(routerConfig_curPageClass),$to.trigger(EVENTS_pageAnimationStart,[toId,$to]),this._animateElement($from,$to,direction),$to.animationEnd(function(){$to.trigger(EVENTS_pageAnimationEnd,[toId,$to]),$to.trigger(EVENTS_pageInit,[toId,$to])})},Router.prototype._animateElement=function($from,$to,direction){void 0===direction&&(direction=DIRECTION_rightToLeft);var classForFrom,classForTo,animPageClasses=["page-from-center-to-left","page-from-center-to-right","page-from-right-to-center","page-from-left-to-center"].join(" ");switch(direction){case DIRECTION_rightToLeft:classForFrom="page-from-center-to-left",classForTo="page-from-right-to-center";break;case DIRECTION_leftToRight:classForFrom="page-from-center-to-right",classForTo="page-from-left-to-center";break;default:classForFrom="page-from-center-to-left",classForTo="page-from-right-to-center"}$from.removeClass(animPageClasses).addClass(classForFrom),$to.removeClass(animPageClasses).addClass(classForTo),$from.animationEnd(function(){$from.removeClass(animPageClasses)}),$to.animationEnd(function(){$to.removeClass(animPageClasses)})},Router.prototype._getCurrentSection=function(){return this.$view.find("."+routerConfig_curPageClass).eq(0)},Router.prototype._back=function(state,fromState){if(this._isTheSameDocument(state.url.full,fromState.url.full)){var $newPage=$("#"+state.pageId);if($newPage.length){var $currentPage=this._getCurrentSection();this._animateSection($currentPage,$newPage,DIRECTION_leftToRight),this._saveAsCurrentState(state)}else location.href=state.url.full}else this._saveDocumentIntoCache($(document),fromState.url.full),this._switchToDocument(state.url.full,!1,!1,DIRECTION_leftToRight),this._saveAsCurrentState(state)},Router.prototype._forward=function(state,fromState){if(this._isTheSameDocument(state.url.full,fromState.url.full)){var $newPage=$("#"+state.pageId);if($newPage.length){var $currentPage=this._getCurrentSection();this._animateSection($currentPage,$newPage,DIRECTION_rightToLeft),this._saveAsCurrentState(state)}else location.href=state.url.full}else this._saveDocumentIntoCache($(document),fromState.url.full),this._switchToDocument(state.url.full,!1,!1,DIRECTION_rightToLeft),this._saveAsCurrentState(state)},Router.prototype._onPopState=function(event){var state=event.state;if(state&&state.pageId){var lastState=this._getLastState();lastState?state.id!==lastState.id&&(state.id<lastState.id?this._back(state,lastState):this._forward(state,lastState)):console.error&&console.error("Missing last state when backward or forward")}},Router.prototype._pushNewState=function(url,sectionId){var state={id:this._getNextStateId(),pageId:sectionId,url:Util.toUrlObject(url)};theHistory.pushState(state,"",url),this._saveAsCurrentState(state),this._incMaxStateId()},Router.prototype._generateRandomId=function(){return"page-"+ +new Date},Router.prototype.dispatch=function(event){var e=new CustomEvent(event,{bubbles:!0,cancelable:!0});window.dispatchEvent(e)},$(function(){if($.smConfig.router&&Util.supportStorage())if($("."+routerConfig_pageClass).length){var router=$.router=new Router;$(document).on("click","a",function(e){var $target=$(e.currentTarget);if(function($link){var customRouterFilter=$.smConfig.routerFilter;if($.isFunction(customRouterFilter)){var filterResult=customRouterFilter($link);if("boolean"==typeof filterResult)return filterResult}return!0}($target)&&!function($link){for(var classBlackList=["external","tab-link","open-popup","close-popup","open-panel","close-panel"],i=classBlackList.length-1;0<=i;i--)if($link.hasClass(classBlackList[i]))return!0;var linkEle=$link.get(0),linkHref=linkEle.getAttribute("href");return!!(/^(\w+):/.test(linkHref)&&["http","https"].indexOf(RegExp.$1)<0)||!!linkEle.hasAttribute("external")}($target))if(e.preventDefault(),$target.hasClass("back"))router.back();else{var url=$target.attr("href");if(!url||"#"===url)return;var ignoreCache="true"===$target.attr("data-no-cache");router.load(url,ignoreCache)}})}else{window.console&&window.console.warn&&console.warn("Disable router function because of no .page elements")}})}(Zepto),function($){"use strict";$.lastPosition=function(options){if(sessionStorage){var needMemoryClass=options.needMemoryClass||[];$(window).off("beforePageSwitch").on("beforePageSwitch",function(event,id,arg){!function(id,arg){var positionName=id;needMemoryClass.forEach(function(item,index){0!==$(item).length&&sessionStorage.setItem(positionName,arg.find(item).scrollTop())})}(id,arg)}),$(window).off("pageAnimationStart").on("pageAnimationStart",function(event,id,arg){!function(id,arg){needMemoryClass.forEach(function(item,index){if(0!==$(item).length){var positionName=id,memoryHeight=sessionStorage.getItem(positionName);arg.find(item).scrollTop(parseInt(memoryHeight))}})}(id,arg)})}}}(Zepto),function($){"use strict";var getPage=function(){var $page=$(".page-current");return $page[0]||($page=$(".page").addClass("page-current")),$page};$.initPage=function(page){var $page=getPage();$page[0]||($page=$(document.body));var $content=$page.hasClass("content")?$page:$page.find(".content");$content.scroller(),$.initPullToRefresh($content),$.initInfiniteScroll($content),$.initCalendar($content),$.initSwiper&&$.initSwiper($content)},$.smConfig.showPageLoadingIndicator&&($(window).on("pageLoadStart",function(){$.showIndicator()}),$(window).on("pageAnimationStart",function(){$.hideIndicator()}),$(window).on("pageLoadCancel",function(){$.hideIndicator()}),$(window).on("pageLoadComplete",function(){$.hideIndicator()}),$(window).on("pageLoadError",function(){$.hideIndicator(),$.toast("加载失败")})),$(window).on("pageAnimationStart",function(event,id,page){$.closeModal(),$.closePanel(),$("body").removeClass("panel-closing"),$.allowPanelOpen=!0}),$(window).on("pageInit",function(){$.hideIndicator(),$.lastPosition({needMemoryClass:[".content"]})}),window.addEventListener("pageshow",function(event){event.persisted&&location.reload()}),$.init=function(){var $page=getPage(),id=$page[0].id;$.initPage(),$page.trigger("pageInit",[id,$page])},$(function(){FastClick.attach(document.body),$.smConfig.autoInit&&$.init(),$(document).on("pageInitInternal",function(e,id,page){$.init()})})}(Zepto),function($){"use strict";if($.device.ios){var ScrollFix=function(elem){var startTopScroll;(elem=elem||document.querySelector(elem))&&elem.addEventListener("touchstart",function(event){event.touches[0].pageY,(startTopScroll=elem.scrollTop)<=0&&(elem.scrollTop=1),startTopScroll+elem.offsetHeight>=elem.scrollHeight&&(elem.scrollTop=elem.scrollHeight-elem.offsetHeight-1)},!1)},initScrollFix=function(){var prefix=0<$(".page-current").length?".page-current ":"",scrollable=$(prefix+".content");new ScrollFix(scrollable[0])};$(document).on($.touchEvents.move,".page-current .bar",function(){event.preventDefault()}),$(document).on("pageLoadComplete",function(){initScrollFix()}),$(document).on("pageAnimationEnd",function(){initScrollFix()}),initScrollFix()}}(Zepto);