!function($){var VideoPlayer=function(elem){this.elem=elem,this.videoElem=elem.find("video")[0]};VideoPlayer.prototype.init=function(){this.btnInit(),this.handlebind(),this.onprogress(),this.ontimeupdate(),this.onended(),this.oncanplay()},VideoPlayer.prototype.handlebind=function(){var self=this,elem=self.elem,videoElem=self.videoElem;elem.find(".play").on("click",function(){videoElem.paused?videoElem.play():videoElem.pause(),$(this).toggleClass("icon-bofang icon-bofang1")}),elem.find(".full").on("click",function(){elem.hasClass("video-fullscreen")?(self.exitFullscreen(),elem.removeClass("video-fullscreen")):(self.requestFullScreen(),elem.addClass("video-fullscreen"))}),elem.find(".bar").on("click",function(e){var current=e.offsetX/$(this).width()*videoElem.duration;videoElem.currentTime=current});var proW=0,proX=0,proL=0;elem.find(".video-rang").on("touchstart",function(e){proW=$(this).parent().width(),proL=$(this).position().left,proX=e.touches[0].pageX}),elem.find(".video-volume").on("touchmove",function(e){var volume,percent=((proL+(e.touches[0].pageX-proX))/proW).toFixed(2),moveX=100*percent;moveX<0?percent=moveX=0:100<moveX&&(moveX=100,percent=1),volume=(1*percent).toFixed(2),$(".video-volume-progress").css("width",moveX+"%"),$(".video-rang").css("left",moveX+"%"),0==(videoElem.volume=volume)?$(".volume").removeClass("icon-zengdayinliang").addClass("icon-guanbiyinliang"):$(".volume").removeClass("icon-guanbiyinliang").addClass("icon-zengdayinliang")}),elem.find(".volume").on("click",function(e){$(this).hasClass("icon-zengdayinliang")?(videoElem.muted=!0,$(this).removeClass("icon-zengdayinliang").addClass("icon-guanbiyinliang"),$(".video-volume-progress").css("width","0%"),$(".video-rang").css("left","0%")):(videoElem.muted=!1,$(this).removeClass("icon-guanbiyinliang").addClass("icon-zengdayinliang"),videoElem.volume=.5,$(".video-volume-progress").css("width","50%"),$(".video-rang").css("left","50%"))})},VideoPlayer.prototype.ontimeupdate=function(){var self=this,elem=self.elem,videoElem=self.videoElem;videoElem.ontimeupdate=function(e){if(!e.target.paused){var current=e.target.currentTime,result=self.getResult(current);elem.find(".currentTime").html(result);var percent=current/videoElem.duration*100+"%";elem.find(".elapse").css("width",percent)}}},VideoPlayer.prototype.onprogress=function(){var elem=this.elem;this.videoElem.onprogress=function(e){if(0<e.target.buffered.length&&!0!==e.target.paused){var videoTarget=e.target,duration=1*Math.round(videoTarget.duration),bufferedEnd=1*Math.round(videoTarget.buffered.end(0));elem.find(".loaded").css("width",100*(bufferedEnd/duration).toFixed(2)+"%")}}},VideoPlayer.prototype.onended=function(){var elem=this.elem;this.videoElem.onended=function(e){e.target.currentTime=0,elem.find(".play").removeClass("icon-bofang1").addClass("icon-bofang")}},VideoPlayer.prototype.oncanplay=function(){var self=this,elem=self.elem;self.videoElem.oncanplay=function(e){var total=e.target.duration,result=self.getResult(total);elem.find(".totalTime").html(result)}},VideoPlayer.prototype.getResult=function(time){var hour=Math.floor(time/3600);hour=hour<10?"0"+hour:hour;var minute=Math.floor(time%3600/60);minute=minute<10?"0"+minute:minute;var second=Math.floor(time%60);return hour+":"+minute+":"+(second=second<10?"0"+second:second)},VideoPlayer.prototype.requestFullScreen=function(){var de=this.videoElem;de.requestFullscreen?de.requestFullscreen():de.mozRequestFullScreen?de.mozRequestFullScreen():de.webkitRequestFullScreen&&de.webkitRequestFullScreen()},VideoPlayer.prototype.exitFullscreen=function(){var de=this.videoElem;de.exitFullscreen?de.exitFullscreen():de.mozCancelFullScreen?de.mozCancelFullScreen():de.webkitCancelFullScreen&&de.webkitCancelFullScreen()},VideoPlayer.prototype.stopVideo=function(){this.videoElem.pause()},VideoPlayer.prototype.btnInit=function(){var elem=this.elem;elem.find(".elapse").css("width","0%"),elem.find(".play").removeClass("icon-bofang1").addClass("icon-bofang"),elem.find(".loaded").css("width","0%")},$.fn.videoPlayer=function(){var videoPlayer=new VideoPlayer(this);return videoPlayer.init(),videoPlayer}}(Zepto);