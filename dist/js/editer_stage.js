var Editer={},Editer_stage={};function IsPC(){for(var userAgentInfo=navigator.userAgent,Agents=new Array("Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"),flag=!0,v=0;v<Agents.length;v++)if(0<userAgentInfo.indexOf(Agents[v])){flag=!1;break}return flag}function is_define(value){return null!==value&&""!==value&&void 0!==value&&void 0!==value&&0!==value&&""!=(value=(value+="").replace(/\s/g,""))}Editer.extend=function(destination,source){for(var property in source)destination[property]=source[property];return destination},Editer_stage.tool={percentName:"#range-value",uiSliderName:".noUiSlider",resolutionName:"#thisResolution",editareaName:".editerCanvas-main",wrapName:".editerCanvas",programWidthName:"#programWidthPoints",programHeightName:"#programHeightPoints",pageBgVal:"#page-bg",picDefaultUrl:PublicUrl.ip+PublicUrl.resources,pageTimeVal:"#page-pauseTime"},Editer_stage.tool.calculateZoom=function(zoom){return zoom/100},Editer_stage.tool.showLayout=function(obj){var $layout=$(".custom-overlay");$layout.show(),$layout.attr("data-flag",obj),setTimeout(function(){$layout.addClass("fade-in")},50)},Editer_stage.tool.hideLayout=function(){var $layout=$(".custom-overlay");$layout.addClass("fade-out"),setTimeout(function(){$layout.hide(),$layout.removeClass("fade-out")},300)},Editer_stage.tool.setZoom=function(val){$(this.percentName).val(val)},Editer_stage.tool.setTopSlider=function(val){$(this.uiSliderName).slider("value",val)},Editer_stage.tool.getZoom=function(){return $(this.percentName).val()},Editer_stage.tool.conversion=function(W,H,L,T){var editareaW=Editer_stage.tool.getEditerSize().width,editareaH=Editer_stage.tool.getEditerSize().height,allPageResolution=Editer_stage.tool.getProgramResolution(),resolution=Editer_stage.tool.getViewResolution(allPageResolution);return{width:Math.round(W/editareaW*resolution.width),height:Math.round(H/editareaH*resolution.height),left:Math.round(L/editareaW*resolution.width),top:Math.round(T/editareaH*resolution.height)}},Editer_stage.tool.getProgramResolutionWidth=function(){return $(this.programWidthName).text()},Editer_stage.tool.getProgramResolutionHeight=function(){return $(this.programHeightName).text()},Editer_stage.tool.getProgramResolution=function(){return Editer_stage.tool.getProgramResolutionWidth()+"X"+Editer_stage.tool.getProgramResolutionHeight()},Editer_stage.tool.setViewResolution=function(w,h){$(this.programWidthName).text(w),$(this.programHeightName).text(h)},Editer_stage.tool.getViewResolution=function(resolution){if(resolution){var arry=resolution.split("X");return{width:parseInt(arry[0]),height:parseInt(arry[1])}}},Editer_stage.tool.getEditerArea=function(){return $(this.editareaName)[0]},Editer_stage.tool.getEditerSize=function(){return{width:Editer_stage.tool.getEditerArea().offsetWidth,height:Editer_stage.tool.getEditerArea().offsetHeight}},Editer_stage.tool.getWrap=function(){return $(this.wrapName)[0]},Editer_stage.tool.getWrapSize=function(){var panel=Editer_stage.tool.getWrap();return{width:panel.offsetWidth,height:panel.offsetHeight}},Editer_stage.tool.gcd=function(a,b){var temp;for(a<b&&(temp=a,a=b,b=temp);0!=b;)temp=a%b,a=b,b=temp;return a},Editer_stage.tool.getEditorSize=function(h,f){for(var k=h.width,g=h.height,a=f.width,d=f.height,c=(Math.max(a,d),Editer_stage.tool.gcd(k,g)),j=k,e=g;c<=j&&j%c==0&&c<=e&&e%c==0&&1!=c;)j/=c,e/=c;var b=0;d<(b=a/j)*e&&(b=d/e);var l={min:0,max:100,current:parseInt(b*j/h.width*100)};return l.current>l.max&&(l.max=l.current),{width:b*j,height:b*e,zoom:l}},Editer_stage.tool.clearEditerAreaData=function(){$(this.editareaName).html(""),Editer_stage.tool.clearEditerAreaBgData()},Editer_stage.tool.clearEditerAreaBgData=function(){$(this.pageBgVal).val(""),$(this.editareaName).css("background-image","")},Editer_stage.tool.addEditerAreaData=function(shtml){$(this.editareaName).append(shtml)},Editer_stage.tool.intEditerAreaBg=function(data){if(is_define(data.pageEle)){data.pageEle[0].bgImg;var editerBgColor=data.pageEle[0].bgColor;data.pageEle[0].bgName;editerBgColor=editerBgColor||"",Editer_stage.tool.setEditerAreaBg()}},Editer_stage.tool.setEditerAreaBg=function(){var data=editerDataStore.returnData().pageEle[0],bgImg=data.bgImg,bgColor=data.bgColor,bgName=data.bgName;$(this.editareaName).css("background-color",bgColor),$(this.editareaName).css({"background-image":bgImg?"url("+this.picDefaultUrl+bgImg+")":"","background-size":"cover"}),$(this.pageBgVal).val(bgName),$("#page-color").val(bgColor.replace(/(#)+/,""))},Editer_stage.tool.setEditerAreaSize=function(W,H){$(Editer_stage.tool.getEditerArea()).css({width:W,height:H})},Editer_stage.tool.setEditerAreaLocation=function(L,R){$(Editer_stage.tool.getEditerArea()).css({left:L,top:R})},Editer_stage.tool.siderbuildEditerArea=function(zoom){zoom=Editer_stage.tool.calculateZoom(zoom);var wrapSize=Editer_stage.tool.getWrapSize(),allPageResolution=Editer_stage.tool.getProgramResolution(),resolution=Editer_stage.tool.getViewResolution(allPageResolution),editAreaWidth=resolution.width*zoom,editAreaHeight=resolution.height*zoom,left=Math.round((wrapSize.width-editAreaWidth)/2),top=Math.round((wrapSize.height-editAreaHeight)/2),width=Math.round(editAreaWidth),height=Math.round(editAreaHeight);Editer_stage.tool.setEditerAreaSize(width,height),Editer_stage.tool.setEditerAreaLocation(left,top),Editer_stage.tool.setItemSize(zoom)},Editer_stage.tool.setItemSize=function(zoom){$(this.editareaName).find(".item").each(function(){var itemData=editerDataStore.getMediaData($(this).attr("data-id"));Editer_stage.tool.setMainZoom($(this),itemData,zoom)})},Editer_stage.tool.setMainZoom=function(obj,itemData,zoom){var itemWidth=Math.round(itemData.width*zoom),itemHeight=Math.round(itemData.height*zoom),itemLeft=Math.round(itemData.left*zoom),itemTop=Math.round(itemData.top*zoom);if(obj.css({left:itemLeft,top:itemTop,width:itemWidth,height:itemHeight}),"15"===obj.attr("data-type"))for(var mapDataArry=obj.find(".map-data"),i=0;i<itemData.srcGroup.length;i++)for(var groupItem=itemData.srcGroup[i],dataItemId=groupItem.id,dataItemWidth=groupItem.width,dataItemHeight=groupItem.height,dataItemLeft=groupItem.left,dataItemTop=groupItem.top,j=0;j<mapDataArry.length;j++)$(mapDataArry[j]).attr("data-id")==dataItemId&&$(mapDataArry[j]).css({left:Math.round(dataItemLeft*zoom),top:Math.round(dataItemTop*zoom),width:Math.round(dataItemWidth*zoom),height:Math.round(dataItemHeight*zoom)})},Editer_stage.tool.changeEditareaItemPrivate=function(flag,id){var $objItem=$("#controlItem_"+id),itemData=editerDataStore.getMediaData(id),itemType=itemData.type,itemFlag=Editer_stage.tool.checkItemFlag(flag),itemDataVal=itemData[flag];if("font-size"!==itemFlag&&"width"!==itemFlag||(itemDataVal+="px"),!("borderSW"!==flag&&"borderType"!==flag||0!=itemType&&1!=itemType&&2!=itemType&&3!=itemType&&4!=itemType&&5!=itemType&&6!=itemType&&7!=itemType&&8!=itemType&&9!=itemType&&11!=itemType&&12!=itemType&&13!=itemType)){var $lineBox=$objItem.find("#line_box_"+id),findObj="";0==itemType||1==itemType||4==itemType||5==itemType||6==itemType||7==itemType||8==itemType||9==itemType||12==itemType||13==itemType?findObj="img":2==itemType&&(findObj=".textCont"),"borderSW"===flag&&(1==itemDataVal?($objItem.find(findObj).css("padding","3px"),$lineBox.show()):($objItem.find(findObj).css("padding","0"),$lineBox.hide())),"borderType"===flag&&($lineBox.removeClass(),$lineBox.addClass("lineType"+itemDataVal))}if(2==itemType)"text"===flag?(itemDataVal=itemData.textGroup[0][flag],$objItem.find(".textCont").text(itemDataVal)):void 0!==itemFlag&&$objItem.find(".textCont").css(itemFlag,itemDataVal);else if(3==itemType)if("bgColor"===flag)$objItem.find("div").css(itemFlag,itemDataVal);else if("fontSize"===flag||"fontColor"===flag)$objItem.find(".weather_day").css(itemFlag,itemDataVal);else if("rowType"===flag){if(1==itemDataVal)var msgHtml=Editer_stage.tool.setWeatherHtmlTempA(itemData);else if(2==itemDataVal)msgHtml=Editer_stage.tool.setWeatherHtmlTempB(itemData);else if(3==itemDataVal)msgHtml=Editer_stage.tool.setWeatherHtmlTempC(itemData);else if(4==itemDataVal)msgHtml=Editer_stage.tool.setWeatherHtmlTempD(itemData);$objItem.find(".weather_content>tbody").html(""),$objItem.find(".weather_content>tbody").html(msgHtml)}else if("todayShow"===flag){var nowDisplay=1==itemDataVal?"table-cell":"none";$objItem.find(".todayShow").css("display",nowDisplay)}else if("tomShow"===flag){nowDisplay=1==itemDataVal?"table-cell":"none";$objItem.find(".tomShow").css("display",nowDisplay)}else if("afterShow"===flag){nowDisplay=1==itemDataVal?"table-cell":"none";$objItem.find(".afterShow").css("display",nowDisplay)}else if("scale"===flag){nowDisplay=1==itemDataVal?"inline-block":"none";$objItem.find(".scale").css("display",nowDisplay),"none"===nowDisplay&&"none"===$objItem.find(".wind").css("display")?$objItem.find(".windLine").css("display","none"):$objItem.find(".windLine").css("display","block")}else if("wind"===flag){nowDisplay=1==itemDataVal?"inline-block":"none";$objItem.find(".wind").css("display",nowDisplay),"none"===nowDisplay&&"none"===$objItem.find(".scale").css("display")?$objItem.find(".windLine").css("display","none"):$objItem.find(".windLine").css("display","block")}else if("hum"===flag){nowDisplay=1==itemDataVal?"block":"none";$objItem.find(".hum").css("display",nowDisplay)}else if("air"===flag){nowDisplay=1==itemDataVal?"inline-block":"none";$objItem.find(".air").css("display",nowDisplay),"none"===nowDisplay&&"none"===$objItem.find(".pm").css("display")?$objItem.find(".airLine").css("display","none"):$objItem.find(".airLine").css("display","block")}else if("pm"===flag){nowDisplay=1==itemDataVal?"inline-block":"none";$objItem.find(".pm").css("display",nowDisplay),"none"===nowDisplay&&"none"===$objItem.find(".air").css("display")?$objItem.find(".airLine").css("display","none"):$objItem.find(".airLine").css("display","block")}else if("icon"===flag){nowDisplay=1==itemDataVal?"table-cell":"none";$objItem.find(".weather_icon").css("display",nowDisplay)}else if("fontFamily"===flag)$objItem.find(".weather_day").css(itemFlag,itemDataVal);else if("temperature"===flag){nowDisplay=1==itemDataVal?"inline-block":"none";$objItem.find(".temperature").css("display",nowDisplay),"none"===nowDisplay&&"none"===$objItem.find(".state").css("display")?$objItem.find(".stateLine").css("display","none"):$objItem.find(".stateLine").css("display","block")}else if("state"===flag){nowDisplay=1==itemDataVal?"inline-block":"none";$objItem.find(".state").css("display",nowDisplay),"none"===nowDisplay&&"none"===$objItem.find(".temperature").css("display")?$objItem.find(".stateLine").css("display","none"):$objItem.find(".stateLine").css("display","block")}else if("area"===flag){nowDisplay=1==itemDataVal?"block":"none";$objItem.find(".city").css("display",nowDisplay)}else if("date"===flag){nowDisplay=1==itemDataVal?"block":"none";$objItem.find(".weather_date").css("display",nowDisplay)}else"iconSize"===flag&&(itemDataVal+="px",$objItem.find("img").css({width:itemDataVal,height:itemDataVal}));else if(4==itemType)if("font-weight"===itemFlag&&(itemDataVal=1==itemDataVal?"bold":""),"fontFamily"===flag||"fontColor"===flag)$objItem.find(".clock").css(itemFlag,itemDataVal);else if("dateFontSize"===flag)$objItem.find(".date").css(itemFlag,itemDataVal);else if("timeFontSize"===flag)$objItem.find(".digits").css(itemFlag,itemDataVal);else if("dateWeight"===flag)$objItem.find(".date_a").css(itemFlag,itemDataVal);else if("weekWeight"===flag)$objItem.find(".date_b").css(itemFlag,itemDataVal);else if("timeWeight"===flag)$objItem.find(".digits").css(itemFlag,itemDataVal);else if("clockW"===flag)$objItem.find(".clockimg").css(itemFlag,itemDataVal);else if("weekFormat"===flag){"1"===itemDataVal?"星期一":"2"===itemDataVal?"周一":"3"===itemDataVal&&"Mon",$objItem.find(".date_b").text(dataHtml)}else if("dateFormat"===flag){var dataHtml="";dataHtml=Editer_stage.tool.setClockHtmlTempA(itemData),$objItem.find(".date_a").html(dataHtml)}else if("timeFormat"===flag){var timeHtml="";"1"===itemDataVal?timeHtml="00:00:00":"2"===itemDataVal&&(timeHtml="00:00"),$objItem.find(".digits").text(timeHtml)}else if("yearShow"===flag){nowDisplay=1==itemDataVal?"inline-block":"none";$objItem.find(".date_year").css("display",nowDisplay),$objItem.find(".markYear").css("display",nowDisplay)}else if("monthShow"===flag){nowDisplay=1==itemDataVal?"inline-block":"none";$objItem.find(".date_month").css("display",nowDisplay),$objItem.find(".markMonth").css("display",nowDisplay)}else if("dateShow"===flag){nowDisplay=1==itemDataVal?"inline-block":"none";$objItem.find(".date_date").css("display",nowDisplay)}else if("hourShow"===flag){nowDisplay=1==itemDataVal?"inline-block":"none";$objItem.find(".date_hours").css("display",nowDisplay)}else if("minutesShow"===flag){nowDisplay=1==itemDataVal?"inline-block":"none";$objItem.find(".date_minutes").css("display",nowDisplay)}else if("secondsShow"===flag){nowDisplay=1==itemDataVal?"inline-block":"none";$objItem.find(".date_seconds").css("display",nowDisplay)}else if("weekShow"===flag){nowDisplay=1==itemDataVal?"inline-block":"none";$objItem.find(".date_week").css("display",nowDisplay)}else"clockType"===flag&&($objItem.find(".clockDigital").css("display",1==itemDataVal?"inline-block":"none"),$objItem.find(".clockSimulation").css("display",0==itemDataVal?"inline-block":"none"))},Editer_stage.tool.checkItemFlag=function(flag){switch(flag){case"background":return"background";case"fontColor":return"color";case"fontFamily":return"font-family";case"fontSize":return"font-size";case"text":return"text";case"textAlign":return"text-align";case"fontStyle":return"font-style";case"fontWeight":return"font-weight";case"textDecoration":return"text-decoration";case"bgColor":return"background";case"refreshTime":return"refreshTime";case"tomShow":return"tomShow";case"todayShow":return"todayShow";case"afterShow":return"afterShow";case"dateFontSize":return"font-size";case"weekFormat":return"weekFormat";case"dateFormat":return"dateFormat";case"timeFontSize":return"font-size";case"timeFormat":return"timeFormat";case"dateWeight":case"weekWeight":case"timeWeight":return"font-weight";case"clockW":return"width";case"clockShow":return"clockShow";case"dateShow":return"dateShow";case"weekShow":return"weekShow";case"timeShow":return"timeShow";case"rowType":return"rowType"}},Editer_stage.tool.setMinicolors=function(obj,objVal,defColor){var bEmpty=!0;"#hue-demo"!==obj&&"#fontColor"!==obj&&"#hue-weatherFontColor"!==obj&&"#hue-clock"!==obj||(bEmpty=!1),$(obj).spectrum({flat:!0,allowEmpty:bEmpty,color:defColor,showInput:!0,containerClassName:"full-spectrum",showInitial:!1,showPalette:!0,showSelectionPalette:!1,showAlpha:!1,maxPaletteSize:10,preferredFormat:"hex",localStorageKey:"spectrum.demo",inputClass:objVal,move:function(color){color?($(objVal).val(color.toHexString()),$(objVal).css("background-color",color.toHexString()),$(objVal).change()):$(objVal).removeAttr("style")},palette:[["rgb(0, 0, 0)","rgb(67, 67, 67)","rgb(102, 102, 102)","rgb(153, 153, 153)","rgb(183, 183, 183)","rgb(204, 204, 204)","rgb(217, 217, 217)","rgb(239, 239, 239)","rgb(243, 243, 243)","rgb(255, 255, 255)","rgb(152, 0, 0)","rgb(255, 0, 0)","rgb(255, 153, 0)","rgb(255, 255, 0)","rgb(0, 255, 255)","rgb(74, 134, 232)","rgb(0, 0, 255)","rgb(153, 0, 255)","rgb(255, 0, 255)","rgb(50, 205, 50)","rgb(0, 255, 0)","rgb(34, 139, 34)","rgb(0, 128, 0)","rgb(70, 130, 180)","rgb(135, 206, 250)","rgb(135, 206, 235)","rgb(0, 191, 255)","rgb(173, 216, 230)","rgb(176, 224, 230)"]]})},Editer_stage.tool.noUiSlider=function(){$(this.uiSliderName).slider({range:"max",min:0,max:500,step:10,slide:function(event,ui){var values=ui.value;Editer_stage.tool.setZoom(values),Editer_stage.tool.siderbuildEditerArea(values)}})},Editer_stage.tool.showItemMsg=function(dateId,typeId){for(var editerDataMediaEle=editerDataStore.returnData().mediaEle,jsonLen=editerDataMediaEle.length,i=0;i<jsonLen;i++)if(editerDataMediaEle[i].id==dateId){var editerDataItem=editerDataMediaEle[i],thisId=editerDataItem.id,thisLeft=editerDataItem.left,thisTop=editerDataItem.top,thisWidth=editerDataItem.width,thisHeight=editerDataItem.height,thisTypeName=Editer_stage.tool.getMediaType(typeId);0!==typeId&&1!==typeId||(Editer_stage.areaDataShow.showLeftSideBar(thisTypeName),Editer_stage.areaDataShow.publicItem(thisTypeName,thisId,i,thisWidth,thisHeight,thisLeft,thisTop),Editer_stage.areaDataShow.showItemPrivateMsg(thisId,typeId,editerDataItem),Editer_stage.tool.showItemListMsg(editerDataItem,typeId,thisId))}},Editer_stage.tool.setMapLoca=function(obj){var $obj=$(obj),width=$obj.attr("data-width"),height=$obj.attr("data-height"),left=$obj.attr("data-left"),top=$obj.attr("data-top"),id=$obj.attr("data-id"),itemid=$obj.attr("data-itemid"),name=$obj.find("input").val();$("#map-item-left").val(left),$("#map-item-top").val(top),$("#map-item-width").val(width),$("#map-item-height").val(height),$("#map-set-data").text(name),$(".map-tool input").attr("data-id",id),$(".map-tool input").attr("data-itemid",itemid)},Editer_stage.tool.setMapInitData=function(type,val,itemId){var zoom=Editer_stage.tool.calculateZoom(Editer_stage.tool.getZoom());$("#map-list li[data-itemid="+itemId+"]").attr("data-"+type,val),$("#map-data"+itemId).css(type,val*zoom+"px"),"height"===type&&$("#map-data"+itemId).css("line-height",val*zoom+"px")},Editer_stage.tool.getItemListHtml=function(data,typeId,id,index){var itemSuffix=data.name.substring(data.name.lastIndexOf("."),data.name.length),itemGroupName=data.editName?data.editName+itemSuffix:data.name,itemGroupSize=(data.src,Public.formatFileSize(data.size)),imgIndex=(data.id,data.time,1==typeId?$("#controlItem_"+id).find("img").attr("data-imgindex"):""),className=(Editer_stage.tool.getMediaType(typeId),0===index?"active":""),shtml="";return imgIndex&&(className=imgIndex==index?"active":""),shtml+='<li class="'+className+'" data-editName="'+itemGroupName+'" data-itemIndex="'+index+'" data-itemSuffix='+itemSuffix+" data-json='"+JSON.stringify(data)+'\'>                <span class="title"> '+itemGroupName+(0===typeId?'</span ><span class="size">('+itemGroupSize+")</span>":"")+"            </li >"},Editer_stage.tool.showItemListMsg=function(jsonData,typeId,id){for(var itemGroup=jsonData.srcGroup,itemGroupLen=itemGroup.length,typeName=Editer_stage.tool.getMediaType(typeId),shtml="",$list=$("#editer-"+typeName+"-list"),i=0;i<itemGroupLen;i++){var itemData=itemGroup[i];shtml+=Editer_stage.tool.getItemListHtml(itemData,typeId,id,i),0===typeId&&($("input[data-flag=videoName]").val(""),$("input[data-flag=videoName]").removeAttr("data-itemid"))}$list.html(""),$list.append(shtml)},Editer_stage.tool.showItemListControl=function(typeId,obj){var $parent=$(obj).parent("li");if(0==typeId){var thisSize=formatFileSize($parent.attr("data-size")),thisName=$parent.attr("data-editName"),thisItemId=$parent.attr("data-itemid"),thisSuffix=$parent.attr("data-suffix"),thisIndex=$parent.index();Editer_stage.tool.videoEditObj=$parent,$("#video-size").text(thisSize),$("#video-name").val(thisName),$("#video-name").attr("data-itemid",thisItemId),$("#video-name").attr("data-itemIndex",thisIndex),$("#video-name").attr("data-suffix",thisSuffix)}else if(1==typeId){var thisSrc=$parent.attr("data-src"),thisId=$parent.attr("data-id");thisSize=getPicSize(thisSrc);$("#photo-size").text(thisSize),$("#controlItem_"+thisId).find("img").attr("src",thisSrc)}else if(10==typeId){thisSize=formatFileSize($parent.attr("data-size"));$("#audio-size").text(thisSize)}},Editer_stage.tool.getMediaType=function(typeNum){switch(typeNum){case 0:return"video";case 1:return"photo";case 2:return"text";case 3:return"weather";case 4:return"clock";case 5:return"mixed";case 6:return"word";case 7:return"ppt";case 8:return"pdf";case 9:return"webpage";case 10:return"audio";case 11:return"number";case 12:return"streamMedia";case 13:return"rtf";case 14:return"information";case 15:return"map"}},Editer_stage.tool.getModalName=function(typeId){switch(typeId){case 0:return"#editerAddVideo";case 1:return"#editerAddPic";case 5:return"#editerAddMixed";case 6:return"#editerAddword";case 7:return"#editerAddppt";case 8:return"#editerAddpdf";case 10:return"#editerAddaudio";case 13:return"#editerAddRtf"}},Editer_stage.tool.judgeMediaType=function(obj,typeId,editerType){var modalName=Editer_stage.tool.getModalName(typeId);if(0===editerType){if(10==typeId){var dataAudioId=editerDataStore.judgeAudio();if(0!=dataAudioId)return void Editer_stage.tool.showItemMsg(dataAudioId,10)}Editer_stage.tool.openModal(modalName,{typeId:typeId,editerType:editerType})}else if(1===editerType){var id=$(obj).attr("data-id");Editer_stage.tool.openModal(modalName,{id:id,typeId:typeId,editerType:editerType})}},Editer_stage.tool.openModal=function(obj,attrItem){$(obj).modal("show");var count=0;$(obj).on("shown.bs.modal",function(event){var _this=$(this);if(1==++count)if(attrItem){var id=attrItem.id,listItemId=attrItem.listItemId,listItemIndex=attrItem.listItemIndex,typeId=attrItem.typeId,editerType=attrItem.editerType;void 0!==id&&_this.attr("data-id",id),void 0!==listItemId&&_this.attr("data-listitemid",listItemId),void 0!==listItemIndex&&_this.attr("data-listItemindex",listItemIndex),void 0!==editerType&&_this.attr("data-editertype",editerType),void 0!==typeId&&_this.attr("data-typeid",typeId),0==typeId?videoModalBindEvent(_this):1==typeId?picModalBindEvent(_this):5==typeId?mixedModalBindEvent(_this):6==typeId?wordModalBindEvent(_this):7==typeId?pptModalBindEvent(_this):8==typeId?pdfModalBindEvent(_this):10==typeId?audioModalBindEvent(_this):13==typeId?rtfModalBindEvent(_this):15==typeId&&mapModalBindEvent(_this)}else addBgModalBindEvent(_this)})},Editer_stage.tool.listItemEditer=function(obj,typeId){var listItem=$(obj).parents("ul").find("li"),listItemIndex=0,id=$(obj).attr("data-id"),listItemId=$(obj).attr("data-itemid");listItem.removeAttr("data-flag"),$(obj).parents("li").attr("data-flag","0");for(var i=0,len=listItem.length;i<len;i++)$(listItem[i]).attr("data-flag")&&(listItemIndex=i);var modalName=Editer_stage.tool.getModalName(typeId),attrItem={id:id,listItemId:listItemId,listItemIndex:listItemIndex,typeId:typeId,editerType:2};Editer_stage.tool.openModal(modalName,attrItem)},Editer_stage.tool.listItemShow=function(obj){var url=$(obj).parents("li").attr("data-src"),type=(url.substring(0,url.lastIndexOf(".")),url.substring(url.lastIndexOf("."),url.length)),path=url.substring(0,url.lastIndexOf("."));path+=".mp4"==type?"_copy.mp4":".mp4",$("#showVideoPlayConl").attr("src",path),$("#showVideoPlay").modal("show")},Editer_stage.tool.listSortUp=function(list){var c=list.find("li.active");if(0!=c.prev("li").length){var b=c.clone();c.prev("li").eq(0).before(b),c.remove()}},Editer_stage.tool.listSortDown=function(list){var c=list.find("li.active");if(0!=c.next("li").length){var b=c.clone();c.next("li").eq(0).after(b),c.remove()}},Editer_stage.tool.listSortRemove=function(list){var b=list.find("li.active"),index=b.index(),liLen=list.find("li").length;0===index&&0<liLen-1?b.next("li").addClass("active").siblings().removeClass("active"):(index<liLen-1||index===liLen-1)&&b.prev("li").addClass("active").siblings().removeClass("active"),b.remove()},Editer_stage.tool.listSortUpDataSingle=function(id,itemIndex,itemId,name){for(var dataStoreMediaLen=editerDataStore.data.mediaEle.length,i=0;i<dataStoreMediaLen;i++){var dataMediaEle=editerDataStore.data.mediaEle[i];if(dataMediaEle.id==id)for(var dataMediaEleGroupLen=dataMediaEle.srcGroup.length,e=0;e<dataMediaEleGroupLen;e++)dataMediaEle.srcGroup[e].id==itemId&&e==itemIndex&&(dataMediaEle.srcGroup[e].editName=name)}},Editer_stage.tool.listMapRemove=function(obj){for(var b=$(obj).parent().parent(),id=1*$(obj).attr("data-id"),itemId=1*$(obj).attr("data-itemid"),removeItemNum=0,$removeItem=$("#map-data"+itemId),i=0,len=editerDataStore.data.mediaEle.length;i<len;i++)if(editerDataStore.data.mediaEle[i].id===id){for(var mediaEle=editerDataStore.data.mediaEle[i],j=0,jLen=mediaEle.srcGroup.length;j<jLen;j++)mediaEle.srcGroup[j].id===itemId&&(removeItemNum=j);mediaEle.srcGroup.splice(removeItemNum,1)}b.remove(),$removeItem.remove()},Editer_stage.tool.listSortUpData=function(obj,id,typeName){console.log(obj);for(var liObjs=obj.find("li"),liObjsLen=liObjs.length,newSrcGroup=[],editerItemObjs=$(".editerCanvas-main").find(".item"),mediaTime=0,deleteMediaIndex=-1,i=0;i<liObjsLen;i++){var newSrc={},$li=$(liObjs[i]),dataJson=JSON.parse($li.attr("data-json")),name=dataJson.name,src=dataJson.src,size=dataJson.size,itemId=dataJson.id;if("video"===typeName){var time=1*dataJson.time;mediaTime+=newSrc.time=time}newSrc.name=name,newSrc.src=src,newSrc.size=size,newSrc.id=itemId,newSrcGroup.push(newSrc)}for(var j=0,dataStoreMediaLen=editerDataStore.data.mediaEle.length;j<dataStoreMediaLen;j++){var dataMediaEle=editerDataStore.data.mediaEle[j];dataMediaEle.type,dataMediaEle.pauseTime;if(dataMediaEle.id==id&&(dataMediaEle.srcGroup=newSrcGroup,"video"===typeName&&(dataMediaEle.pauseTime=mediaTime),0===dataMediaEle.srcGroup.length)){deleteMediaIndex=j;for(var e=0;e<editerItemObjs.length;e++){$(editerItemObjs[e]).attr("data-id")===id&&($(editerItemObjs[e]).remove(),Editer_stage.areaDataShow.hideLeftSideBar(".editer-area-msg"),Editer_stage.tool.hideLayout(),Editer_stage.tool.hideAreaTool())}}}-1!==deleteMediaIndex&&editerDataStore.deleteMediaDataItem(deleteMediaIndex),editerDataStore.getMediaMaxTime()},Editer_stage.tool.setListItemData=function(typeName,editerId,editerItemId,editerItemIndex,srcGroupsItem){for(var liList=$("#editer-"+typeName+"-list li"),i=0;i<liList.length;i++){var jsonData=$(liList[i]).attr("data-json");if(JSON.parse(jsonData).id==editerItemId&&editerItemIndex==i){var $liList=$(liList[i]),item=srcGroupsItem[0],name=item.name,itemsuffix=name.substring(name.lastIndexOf("."),name.length),src=PublicUrl.ip+PublicUrl.resources+item.src;$liList.attr("data-editname",name).attr("data-itemindex",editerItemIndex).attr("data-itemsuffix",itemsuffix).attr("data-json",JSON.stringify(item)),$liList.find(".title").text(name),"photo"===typeName&&$("#controlItem_"+editerId).find("img").attr("src",src)}}},Editer_stage.tool.changeEditareaItem=function(id){var $objItem=$("#controlItem_"+id),itemData=editerDataStore.getMediaData(id),zoom=Editer_stage.tool.calculateZoom(Editer_stage.tool.getZoom());Editer_stage.tool.setMainZoom($objItem,itemData,zoom)},Editer_stage.tool.mobileItemImgName=function(type){var imgName="";switch(type){case 2:imgName="default_text";break;case 3:imgName="default_weather";break;case 4:imgName="default_clock";break;case 5:imgName="default_mix";break;case 6:imgName="default_world";break;case 7:imgName="default_ppt";break;case 8:imgName="default_pdf";break;case 9:imgName="default_web";break;case 10:imgName="default_audio";break;case 12:imgName="default_stream";break;case 14:imgName="default_db";break;case 15:imgName="default_traffic"}return imgName},Editer_stage.tool.initEditareaItem=function(itemData){var shtml="",itemId=itemData.id,itemType=1*itemData.type,itemTop=itemData.top,itemLeft=itemData.left,itemWidth=itemData.width,itemHeight=itemData.height,itemZindex=itemData.zIndex,iteBorderShow=itemData.borderSW,itemBorderType=void 0!==itemData.borderType?itemData.borderType:"0";if(10==itemType)return"";if(shtml+='<div id="controlItem_'+itemId+'" class="item" data-drag="true" data-type="'+itemType+'" data-id="'+itemId+'" style="position: absolute; top:'+itemTop+"px; left: "+itemLeft+"px; width: "+itemWidth+"px; height: "+itemHeight+"px;z-index:"+itemZindex+';overflow:hidden;"><div id="line_box_'+itemId+'" class="lineType'+itemBorderType+'" style="display:'+(1==iteBorderShow?"inline-block":"none")+';"><div class="line line_t line_X"></div><div class="line line_l line_y"></div><div class="line line_r line_y"></div><div class="line line_b line_X"></div></div>',0===itemType||13===itemType)shtml+='<img style="width: 100%;height: 100%;vertical-align: top;" onerror= "this.src=\'./../images/default.jpg\'" src="'+Editer_stage.tool.editerAreaImg(itemType)+'" alt="">';else if(1===itemType){var firstImg=0<itemData.srcGroup.length?itemData.srcGroup[0].src:"./../images/default.jpg",imgId=itemData.srcGroup[0].id;shtml+='<img style="width: 100%;height: 100%;vertical-align: top;" onerror= "this.src=\'./../images/default.jpg\'" data-imgIndex="'+editerDataStore.setItemListGroupDataIndex(itemId,imgId)+'"  src="'+this.picDefaultUrl+firstImg+'" alt="">'}else shtml+='<img style="width: 100%;height: 100%;vertical-align: top;" onerror= "this.src=\'./../images/default.jpg\'"  src="./../images/'+Editer_stage.tool.mobileItemImgName(itemType)+'.jpg" alt="">';return shtml+="</div>"},Editer_stage.tool.mapHtml=function(groupItem){return'<div class="map-data" id="map-data'+groupItem.id+'" style="width:'+groupItem.width+"px;height:"+groupItem.height+"px;overflow:hidden;line-height:"+groupItem.height+"px;left:"+groupItem.left+"px;top:"+groupItem.top+'px;" data-id="'+groupItem.id+'" data-val="'+groupItem.dataVal+'">'+groupItem.dataVal+"</div>"},Editer_stage.tool.editerAreaImg=function(type){switch(type){case 0:return"./../images/default_video.jpg";case 5:return"./../images/default_mix.jpg";case 6:return"./../images/default_world.jpg";case 7:return"./../images/default_ppt.jpg";case 8:return"./../images/default_pdf.jpg";case 9:return"./../images/default_web.jpg";case 12:return"./../images/default_stream.jpg";case 13:return"./../images/default_rtf.jpg"}},Editer_stage.tool.setClockHtmlTempA=function(data){var dateFormat=data.dateFormat,yearShow=data.yearShow,monthShow=data.monthShow,yearStyle=1==yearShow?"display:inline-block;":"display:none;",monthStyle=1==monthShow?"display:inline-block;":"display:none;",dateshowStyle=1==data.dateShow?"display:inline-block;":"display:none;",yearShtml="",monthShtml="",dateShtml="",markYearShtml='<span class="markYear" style="'+(1==yearShow?"display:inline-block;":"display:none;")+'">',markMonthShtml='<span class="markMonth" style="'+(1==monthShow?"display:inline-block;":"display:none;")+'">';return 1==dateFormat?(markYearShtml+=".",markMonthShtml+=".",yearShtml='<span class="date_year" style="'+yearStyle+'">2017</span>',monthShtml='<span class="date_month" style="'+monthStyle+'">07</span>',dateShtml='<span class="date_date" style="'+dateshowStyle+'">18</span>'):2==dateFormat&&(markYearShtml+="-",markMonthShtml+="-",yearShtml='<span class="date_year" style="'+yearStyle+'">2017</span>',monthShtml='<span class="date_month" style="'+monthStyle+'">07</span>',dateShtml='<span class="date_date" style="'+dateshowStyle+'">18</span>'),yearShtml+(markYearShtml+="</span>")+monthShtml+(markMonthShtml+="</span>")+dateShtml},Editer_stage.tool.getWeatherData=function(data){var weatherData={},wind=0==data.wind?"none":"inline-block",scale=0==data.scale?"none":"inline-block",hum=0==data.hum?"none":"block",air=0==data.air?"none":"inline-block",pm=0==data.pm?"none":"inline-block",icon=0==data.icon?"none":"table-cell",fontFamily=data.fontFamily,fontColor=data.fontColor,fontSize=data.fontSize,todayShow=data.todayShow,afterShow=(data.tomShow,data.afterShow),iconSize=data.iconSize,dayName=[lang.today,lang.tomorrow,lang.afterTomorrow];return weatherData.wind=wind,weatherData.scale=scale,weatherData.hum=hum,weatherData.air=air,weatherData.pm=pm,weatherData.icon=icon,weatherData.lineShow01="block",weatherData.lineShow02="block",weatherData.fontFamily=fontFamily,weatherData.fontColor=fontColor,weatherData.fontSize=fontSize,weatherData.todayShow=todayShow,weatherData.afterShow=afterShow,weatherData.iconSize=iconSize,weatherData.dayName=dayName,0==data.wind&&0==data.scale&&(weatherData.lineShow01="none"),0==data.pm&&0==data.air&&(weatherData.lineShow02="none"),0==data.state&&0==data.temperature&&(weatherData.lineShow03="none"),weatherData},Editer_stage.tool.setWeatherHtmlTempA=function(data){var weatherData=Editer_stage.tool.getWeatherData(data),shtml="",publicMsgHtml='<p style="margin: 0px;white-space:nowrap; text-align: right;padding-top: 6px;display:'+weatherData.area+'" class="city">'+lang.district+'</p><p style="margin: 0px;white-space:nowrap;text-align:right;padding-top: 6px;display:'+weatherData.lineShow03+'" class="stateLine"><span class="state" style="display:'+weatherData.state+'">'+lang.sunny+'</span> <span class="temperature" style="display:'+weatherData.temperature+'">14℃~23℃</span></p><p style="margin: 0px;text-align: right;white-space:nowrap;padding-top: 6px;display:'+weatherData.lineShow01+'" class="windLine"><span class="wind" style="display:'+weatherData.wind+'">'+lang.northWind+'</span> <span class="scale" style="display:'+weatherData.scale+'">'+lang.breeze+'<span></p><p style="margin: 0px;text-align: right;white-space:nowrap;padding-top: 6px;display:'+weatherData.hum+'" class="hum">'+lang.humidity+' 65%</p><p style="text-align: right;white-space:nowrap;padding-top: 6px;display:'+weatherData.lineShow02+'" class="airLine"><span class="pm" style="display:'+weatherData.pm+'">PM2.5 16</span> <span class="air" style="display:'+weatherData.air+'">'+lang.optimal+"</span></p>";shtml+="<tr>";for(var i=0,len=weatherData.dayName.length;i<len;i++){var state="",className="";0===i?(className="todayShow",state=1==weatherData.todayShow?"table-cell":"none"):1===i?(className="tomShow",state=1==weatherData.tomShow?"table-cell":"none"):2===i&&(className="afterShow",state=1==weatherData.afterShow?"table-cell":"none"),shtml+='<td class="weather_day clearfix '+className+'" style="font-family:'+weatherData.fontFamily+";color:"+weatherData.fontColor+";font-size:"+weatherData.fontSize+"px;display:"+state+';"><table style="width:100%; height:100%;"><tbody><tr><td class="weather_pic weather_icon" style="padding-left:8px;display:'+weatherData.icon+'"><img src="./images/weather.png" style="width:'+weatherData.iconSize+"px;height:"+weatherData.iconSize+'px;" border="0" alt=""></td><td class="weater_text"><p style="margin: 0px;white-space:nowrap; text-align: right;padding-top: 6px;display:'+weatherData.date+'" class="weather_date">'+weatherData.dayName[i]+"</p>"+publicMsgHtml+"</td></tr></tbody></table></td>"}return shtml+="</tr>"},Editer_stage.tool.setWeatherHtmlTempB=function(data){for(var weatherData=Editer_stage.tool.getWeatherData(data),shtml="",publicMsgHtml='<div><p style="margin: 0px;white-space:nowrap;display:'+weatherData.temperature+'" class="temperature">13 / 23℃</p></div><div><p style="margin: 0px;white-space:nowrap;display:'+weatherData.state+'" class="state">'+lang.sunny+'</p></div><div><p style="margin: 0px;white-space:nowrap;display:'+weatherData.lineShow01+'" class="windLine"><span class="wind" style="display:'+weatherData.wind+'">'+lang.northWind+'</span> <span class="scale" style="display:'+weatherData.scale+'">'+lang.breeze+'<span></p></div><div><p style="margin: 0px;white-space:nowrap;display:'+weatherData.hum+'" class="hum">'+lang.humidity+' 65%</p></div><div><p style="margin: 0px;white-space:nowrap;display:'+weatherData.lineShow02+'" class="airLine"><span class="pm" style="display:'+weatherData.pm+'">PM2.5 16</span> <span class="air" style="display:'+weatherData.air+'">'+lang.optimal+"</span></p></div>",i=0,len=weatherData.dayName.length;i<len;i++){var state="",className="";0===i?(className="todayShow",state=1==weatherData.todayShow?"table-cell":"none"):1===i?(className="tomShow",state=1==weatherData.tomShow?"table-cell":"none"):2===i&&(className="afterShow",state=1==weatherData.afterShow?"table-cell":"none"),shtml+="<tr>",shtml+='<td class="weather_day '+className+'" align="center" style="font-family:'+weatherData.fontFamily+";color:"+weatherData.fontColor+";font-size:"+weatherData.fontSize+"px;display:"+state+'"><div class="weather_pic" style="margin-bottom:10px;"><p style="margin: 0px;white-space:nowrap;"><span class="city" style="display:'+weatherData.area+'">'+lang.district+'</span><p class="day_name weather_date" style="margin:0px;">'+weatherData.dayName[i]+'</p></p><img src="./images/weather.png" class="weather_icon" style="width:'+weatherData.iconSize+"px;height:"+weatherData.iconSize+"px;display:"+weatherData.icon+'" border="0" alt="">'+publicMsgHtml+"</div></td>",shtml+="</tr>"}return shtml},Editer_stage.tool.setWeatherHtmlTempC=function(data){var weatherData=Editer_stage.tool.getWeatherData(data),shtml="",publicMsgHtml='<p style="margin: 0px;white-space:nowrap;display:'+weatherData.temperature+'" class="temperature">13 / 23℃</p><p style="margin: 0px;white-space:nowrap;display:'+weatherData.state+'" class="state">'+lang.sunny+'</p><p style="margin: 0px;white-space:nowrap;display:'+weatherData.lineShow01+'"class="windLine"><span class="wind" style="display:'+weatherData.wind+'">'+lang.northWind+'</span> <span class="scale" style="display:'+weatherData.scale+'">'+lang.breeze+'<span></p><p style="margin: 0px;white-space:nowrap;display:'+weatherData.hum+'" class="hum">'+lang.humidity+' 65%</p><p style="margin: 0px;white-space:nowrap;display:'+weatherData.lineShow02+'" class="airLine"><span class="pm" style="display:'+weatherData.pm+'">PM2.5 16</span> <span class="air" style="display:'+weatherData.air+'">'+lang.optimal+"</span></p>";shtml+="<tr>";for(var i=0,len=weatherData.dayName.length;i<len;i++){var state="",className="";0===i?(className="todayShow",state=1==weatherData.todayShow?"table-cell":"none"):1===i?(className="tomShow",state=1==weatherData.tomShow?"table-cell":"none"):2===i&&(className="afterShow",state=1==weatherData.afterShow?"table-cell":"none"),shtml+='<td class="weather_day '+className+'" align="center" style="font-family:'+weatherData.fontFamily+";color:"+weatherData.fontColor+";font-size:"+weatherData.fontSize+"px;display:"+state+'"><div class="weather_pic" style="margin-bottom:10px;"><p style="margin: 0px;white-space:nowrap;"><span class="city" style="display:'+weatherData.area+'">'+lang.district+'</span><span class="day_name weather_date" style="display:'+weatherData.date+">"+weatherData.dayName[i]+'</span></p><img src="./images/weather.png" style="width:'+weatherData.iconSize+"px;height:"+weatherData.iconSize+"px;display:"+weatherData.icon+'" border="0" alt="">'+publicMsgHtml+"</div></td>"}return shtml+="</tr>"},Editer_stage.tool.setWeatherHtmlTempD=function(data){var weatherData=Editer_stage.tool.getWeatherData(data),shtml="",publicMsgHtml='<p style="margin: 0px;white-space:nowrap;display:'+weatherData.temperature+'" class="temperature">13 / 23℃</p><p style="margin: 0px;white-space:nowrap;display:'+weatherData.state+'">'+lang.sunny+'</p><p style="margin: 0px;white-space:nowrap;display:'+weatherData.lineShow01+'"><span style="display:'+weatherData.wind+'">'+lang.northWind+'</span> <span style="display:'+weatherData.scale+'">'+lang.breeze+'<span></p><p style="margin: 0px;white-space:nowrap;display:'+weatherData.hum+'">'+lang.humidity+' 65%</p><p style="margin: 0px;white-space:nowrap;display:'+weatherData.lineShow02+'"><span style="display:'+weatherData.pm+'">PM2.5 16</span> <span style="display:'+weatherData.air+'">'+lang.optimal+"</span></p>";shtml+="<tr>";for(var i=0,len=weatherData.dayName.length;i<len;i++){var state="",className="";0===i?(className="todayShow",state=1==weatherData.todayShow?"table-cell":"none"):1===i?(className="tomShow",state=1==weatherData.tomShow?"table-cell":"none"):2===i&&(className="afterShow",state=1==weatherData.afterShow?"table-cell":"none"),shtml+='<td class="weather_day '+className+'" align="center" style="font-family:'+weatherData.fontFamily+";color:"+weatherData.fontColor+";font-size:"+weatherData.fontSize+"px;display:"+state+'"><div class="weather_pic"><p style="margin: 0px;white-space:nowrap;"><span class="city" style="display:'+weatherData.area+'">'+lang.district+'</span><span class="day_name weather_date">'+weatherData.dayName[i]+"</span>"+publicMsgHtml+"</p></div></td>"}return shtml+="</tr>"},Editer_stage.tool.setMaxPageTime=function(time){$(this.pageTimeVal).val(time)},Editer_stage.tool.removeEditerItem=function(obj){obj.remove()},Editer_stage.tool.removeEditerItemSelect=function(){for(var dataAllId=editerDataStore.getDataArryId(),dataAllIdLen=dataAllId.length,i=0;i<dataAllIdLen;i++){var $elem=$("#controlItem_"+dataAllId[i]);dragResize.deleteSelectPoint($elem)}},Editer_stage.tool.removeDataAudio=function(obj){var itemId=$(obj).attr("data-id");editerDataStore.deleteMediaDataItemById(itemId),Editer_stage.areaDataShow.hideLeftSideBar(".editer-area-msg")},Editer_stage.tool.chageEditerItemImg=function(id,thisSrc){$("#controlItem_"+id).find("img").attr("src",thisSrc)},Editer_stage.tool.editerItemData=function(obj){var el="#controlItem_"+$(obj).parents(".left-sideBar-tab").attr("data-id"),lineNum=1*$("#information-line").val(),columnNum=1*$("#information-column").val();$(obj).addClass("disabled"),$("#informationCancle").removeClass("disabled"),$("#information-inputList").find("input,select").each(function(){$(this).removeAttr("disabled")}),dragResize.lock(),dnyTableObj=new DnyTable({el:el,lineNum:lineNum,columnNum:columnNum}),$(el).attr("data-edit","1"),dnyTableObj.init()},Editer_stage.tool.cancelItemData=function(){dragResize.unlock(),dnyTableObj&&($("#information-inputList").find("input,select").each(function(){$(this).attr("disabled",!0)}),$("#informationEditer").removeClass("disabled"),$("#informationCancle").addClass("disabled"),dnyTableObj.saveTable(),dnyTableObj.deleteBind(),dnyTableObj=null)},Editer_stage.tool.mergeCellBtn=function(){dnyTableObj&&dnyTableObj.judgeDnyTable()&&dnyTableObj.mergeCell()},Editer_stage.tool.deleteMergeCellBtn=function(){dnyTableObj&&dnyTableObj.judgeDnyTable()&&dnyTableObj.deleteMergeCell()},Editer_stage.tool.editerMapItemData=function(obj){var el="#controlItem_"+$(obj).parents(".left-sideBar-tab").attr("data-id");$(obj).addClass("disabled"),$("#mapCancle").removeClass("disabled"),$("#map-inputList").find("input,select").each(function(){$(this).removeAttr("disabled")}),dragResize.lock(),mapFigure=new Editer_stage.MapFigure({elem:el}),$(el).attr("data-edit","1"),mapFigure.init()},Editer_stage.tool.cancelMapItemData=function(){mapFigure&&(dragResize.unlock(),$("#map-inputList").find("input,select").each(function(){$(this).attr("disabled",!0)}),$("#mapEditer").removeClass("disabled"),$("#mapCancle").addClass("disabled"),mapFigure.deleteBind(),mapFigure=null)},Editer_stage.tool.addMapData=function(obj){var id=$("#material-tab-map").attr("data-id"),srcGroupsItem={id:(new Date).getTime(),dataVal:"dataVal",left:0,top:0,width:50,height:50},shtml="";shtml+=Editer_stage.tool.getItemListHtml(srcGroupsItem,15,id),$("#map-list").append(shtml),$("#controlItem_"+id).find(".map").append(Editer_stage.tool.mapHtml(srcGroupsItem)),editerDataStore.setItemListGroupData(id,srcGroupsItem)},Editer_stage.tool.mapInputKeyUp=function(obj){var $this=$(obj),id=$this.attr("data-id"),itemId=$this.attr("data-itemid"),val=$this.val();$("#map-data"+itemId).text(val),editerDataStore.setMapMediaData(id,val,"","",itemId)},Editer_stage.tool.deepClone=function(origin,target){target=target||{};var toStr=Object.prototype.toString;for(var prop in origin)origin.hasOwnProperty(prop)&&("object"==typeof origin[prop]&&"null"!==origin[prop]?("[object Array]"===toStr.call(origin[prop])?target[prop]=[]:target[prop]={},Editer_stage.tool.deepClone(origin[prop],target[prop])):target[prop]=origin[prop]);return target},Editer_stage.tool.addEvent=function(obj,ev,fn){obj.attachEvent?obj.attachEvent("on"+ev,fn):obj.addEventListener(ev,fn,!1)},Editer_stage.tool.pxToRem=function(pxVal){return pxVal/20*1+"rem"},Editer_stage.tool.toast=function(msg){Popup.toast(msg,1e3)},Editer_stage.tool.showLoading=function(msg){Popup.showLoading(msg)},Editer_stage.tool.hideLoading=function(msg){Popup.close()},Editer_stage.tool.confirm=function(msg,sureCallBack,cancelCallBack){Popup.confirm(msg,[{name:"取消",ac:cancelCallBack||""},{name:"确定",ac:sureCallBack||""}])},Editer_stage.tool.setPageInfoList=function(list){for(var shtml="",i=0,len=list.length;i<len;i++){var className="",pageName=list[i].pageName,pageId=list[i].pageId,pagePlaytime=list[i].pagePlaytime;nowPageId?nowPageId==pageId&&(className="active"):className=0===i?"active":"",shtml+="<li data-json="+JSON.stringify(list[i])+" data-pageid="+pageId+" class="+className+'>                    <span class="title">'+pageName+"</span>                </li>",0===i&&(Editer_stage.tool.setPageInfo(pageName,pagePlaytime),$("#page-name").attr("data-index",i))}$("#editer-page-list").append(shtml)},Editer_stage.tool.setPageMsg=function(color){$("#page-color").val(color.replace(/(#)+/,"")),$("#page-color").css("background-color",color)},Editer_stage.tool.setPageInfo=function(pageName,pagePlaytime){$("#page-name").val(pageName),$("#page-pauseTime").val(pagePlaytime)},Editer_stage.tool.getPageJsonData=function(json,name){return json?JSON.parse(json)[name]:""},Editer_stage.tool.showAreaTool=function(){var $tool=$(".editer-area-tool");$tool.hasClass("show-in")||$tool.addClass("show-in")},Editer_stage.tool.hideAreaTool=function(){var $tool=$(".editer-area-tool");$tool.hasClass("show-in")&&($tool.removeClass("show-in").addClass("show-out"),setTimeout(function(){$tool.removeClass("show-out")},300))},Editer_stage.tool.showAreaBorderTool=function(){$("#canvas-layer").show()},Editer_stage.tool.hideAreaBorderTool=function(){$("#canvas-layer").hide()},Editer_stage.tool.setAreaZindex=function(val){$("#current-positionZ").text(val)},Editer_stage.editAreaData=function(data){this.dataArryId=[],data&&(this.data=data)},Editer_stage.editAreaData.prototype.setMediaData=function(itemId,w,h,l,t){$.each(this.data.mediaEle,function(index,item){item.id==itemId&&(2!=item.type&&13!=item.type||(item.isEdit=!0),""!==w&&(item.width=w),""!==h&&(item.height=h),""!==l&&(item.left=l),""!==t&&(item.top=t),dragResize.setOnElemInfo(itemId))})},Editer_stage.editAreaData.prototype.returnCloneData=function(){var editerData=this.data,cloneData={};Editer_stage.tool.deepClone(editerData,cloneData);for(var i=0,len=cloneData.mediaEle.length;i<len;i++)cloneData.mediaEle[i].srcGroup=[];return cloneData.width=Editer_stage.tool.getProgramResolutionWidth(),cloneData.height=Editer_stage.tool.getProgramResolutionHeight(),cloneData},Editer_stage.editAreaData.prototype.setMapMediaData=function(itemId,val,l,t,w,h,dataId){$.each(this.data.mediaEle,function(index,item){if(item.id==itemId)for(var i=0,len=item.srcGroup.length;i<len;i++){var groupItem=item.srcGroup[i];dataId==groupItem.id&&(""!==l&&(groupItem.left=l),""!==t&&(groupItem.top=t),""!==w&&(groupItem.width=w),""!==h&&(groupItem.height=h),""!==val&&(groupItem.dataVal=val))}})},Editer_stage.editAreaData.prototype.setMediaProjectData=function(id,project,val){var _this=this;$.each(_this.data.mediaEle,function(index,item){item.id==id&&(2!=item.type&&13!=item.type||(item.isEdit=!0),"text"===project?item.textGroup[0][project]=val:void 0!==project&&""!==project&&(item[project]=val),"pauseTime"===project&&_this.getMediaMaxTime())})},Editer_stage.editAreaData.prototype.setDataBg=function(param){var bgName=param.bgName,bgImg=param.bgImg,bgColor=param.bgColor,resolution=param.resolution,eqType=param.eqType,pageTime=param.pageTime;void 0!==bgImg&&(this.data.pageEle[0].bgImg=bgImg),void 0!==bgColor&&(this.data.pageEle[0].bgColor=bgColor),void 0!==resolution&&(this.data.pageEle[0].resolution=resolution),void 0!==eqType&&(this.data.pageEle[0].eqType=eqType),void 0!==pageTime&&(this.data.pageEle[0].pageTime=pageTime),void 0!==bgName&&(this.data.pageEle[0].bgName=bgName)},Editer_stage.editAreaData.prototype.getMediaMaxTime=function(){for(var dataMediaEleLen=this.data.mediaEle.length,maxPageTime=0,i=0;i<dataMediaEleLen;i++){var dataMediaEle=this.data.mediaEle[i],dataPauseTime=1*dataMediaEle.pauseTime,dataType=dataMediaEle.type,dataSrcGrounp=dataMediaEle.srcGroup;if(dataSrcGrounp){var dataSrcGrounpLen=dataMediaEle.srcGroup.length;if(0==dataType){for(var videoMaxTime=0,e=0;e<dataSrcGrounpLen;e++)videoMaxTime+=1*dataSrcGrounp[e].time;maxPageTime=maxPageTime<videoMaxTime?videoMaxTime:maxPageTime}else if(1==dataType){var picMaxTime;maxPageTime=maxPageTime<(picMaxTime=dataPauseTime*dataSrcGrounpLen)?picMaxTime:maxPageTime}else if(5==dataType){for(var mixedMaxTime=0,z=0;z<dataSrcGrounpLen;z++){var itemType=dataSrcGrounp[z].type;0==itemType?mixedMaxTime+=1*dataSrcGrounp[z].time:1==itemType&&(mixedMaxTime+=dataPauseTime)}maxPageTime=maxPageTime<mixedMaxTime?mixedMaxTime:maxPageTime}else if(6==dataType){var wordMaxTime;maxPageTime=maxPageTime<(wordMaxTime=dataPauseTime*dataSrcGrounpLen)?wordMaxTime:maxPageTime}else if(7==dataType){var pptMaxTime;maxPageTime=maxPageTime<(pptMaxTime=dataPauseTime*dataSrcGrounpLen)?pptMaxTime:maxPageTime}else if(8==dataType){var pdfMaxTime;maxPageTime=maxPageTime<(pdfMaxTime=dataPauseTime*dataSrcGrounpLen)?pdfMaxTime:maxPageTime}else if(10==dataType){for(var audioMaxTime=0,d=0;d<dataSrcGrounpLen;d++)audioMaxTime+=1*dataSrcGrounp[d].time;maxPageTime=maxPageTime<audioMaxTime?audioMaxTime:maxPageTime}}}return(maxPageTime=Math.round(maxPageTime))<10&&(maxPageTime=10),Editer_stage.tool.setMaxPageTime(maxPageTime),this.setDataBg({pageTime:maxPageTime}),maxPageTime},Editer_stage.editAreaData.prototype.setItemListData=function(id,listItemId,index,selectData){for(var mediaEle=this.data.mediaEle,mediaEleLen=mediaEle.length,i=0;i<mediaEleLen;i++)if(mediaEle[i].id==id){var thisType=mediaEle[i].type;if(0==thisType||10==thisType){var initPauseTime=mediaEle[i].pauseTime;initPauseTime-=1*mediaEle[i].srcGroup[index].time}mediaEle[i].srcGroup[index].id=selectData.id,mediaEle[i].srcGroup[index].name=selectData.name,mediaEle[i].srcGroup[index].src=selectData.src,mediaEle[i].srcGroup[index].size=selectData.size,mediaEle[i].srcGroup[index].time=selectData.time,0!=thisType&&10!=thisType||(initPauseTime+=1*selectData.time,mediaEle[i].pauseTime=initPauseTime)}},Editer_stage.editAreaData.prototype.setItemListGroupData=function(id,data){for(var i=0,len=this.data.mediaEle.length;i<len;i++)this.data.mediaEle[i].id==id&&this.data.mediaEle[i].srcGroup.push(data)},Editer_stage.editAreaData.prototype.setItemListGroupDataIndex=function(id,itemId){for(var i=0,len=this.data.mediaEle.length;i<len;i++)if(this.data.mediaEle[i].id==id)for(var scrGroups=this.data.mediaEle[i].srcGroup,gLen=scrGroups.length,e=0;e<gLen;e++){if(scrGroups[e].id===itemId)return e}},Editer_stage.editAreaData.prototype.getMediaData=function(id){for(var mediaEle=this.data.mediaEle,len=mediaEle.length,i=0;i<len;i++)if(mediaEle[i].id==id)return mediaEle[i]},Editer_stage.editAreaData.prototype.getDataArryId=function(){var dataLen=this.data.mediaEle.length;if(0<dataLen)for(var i=0;i<dataLen;i++)this.dataArryId.push(this.data.mediaEle[i].id);return this.dataArryId},Editer_stage.editAreaData.prototype.getDataMaxId=function(){this.getDataArryId();var maxId=this.dataArryId[0],dataArryLen=this.dataArryId.length;if(0<dataArryLen)for(var i=1;i<dataArryLen;i++)this.dataArryId[i]>maxId&&(maxId=this.dataArryId[i]);else maxId=0;return maxId},Editer_stage.editAreaData.prototype.getMaxZindex=function(){var maxZindex=0,dataLen=this.data.mediaEle.length;if(0<dataLen)for(var i=0;i<dataLen;i++){var thisZindex=1*this.data.mediaEle[i].zIndex;maxZindex=thisZindex<maxZindex?maxZindex:thisZindex}return maxZindex},Editer_stage.editAreaData.prototype.addItemToData=function(itemType,srcGroup,pauseTime){var maxId=this.getDataMaxId(),maxZindex=this.getMaxZindex(),minWidth=Math.round(.2*Editer_stage.tool.getViewResolution(Editer_stage.tool.getProgramResolution()).width),minHeight=Math.round(.2*Editer_stage.tool.getViewResolution(Editer_stage.tool.getProgramResolution()).height),newMediaData=null;if(0==itemType||1==itemType||6==itemType||7==itemType||8==itemType?newMediaData={id:maxId+1,type:itemType,top:0,left:0,width:minWidth,height:minHeight,zIndex:maxZindex,siderType:"6",pauseTime:pauseTime,borderSW:0,borderType:1,borderEffect:1,borderSpeed:1,rotation:0,srcGroup:srcGroup}:2==itemType?newMediaData={id:maxId+1,type:itemType,top:0,left:0,width:minWidth,height:minHeight,zIndex:maxZindex,siderType:"0",siderDirection:"0",pauseTime:"5",text:"请输入文字",fontSize:"12",fontWeight:"",textDecoration:"",fontStyle:"",textAlign:"",fontFamily:"Arial",fontColor:"#ff0000",lineHeight:"20",background:"",listType:"",textShow:"0",scrollSpeed:"0",isEdit:!1,borderSW:0,borderType:1,borderEffect:1,borderSpeed:1,textGroup:[{id:0,name:"字幕",text:"请输入文字"}]}:3==itemType?newMediaData={id:maxId+1,type:itemType,top:0,left:0,width:minWidth,height:minHeight,zIndex:maxZindex,fontFamily:"Arial",fontSize:"12",fontColor:"#e80000",bgColor:"#ffffff",bgColorShow:"0",refreshTime:2,rowType:1,todayShow:"1",tomShow:"0",afterShow:"0",scale:0,wind:0,hum:0,air:0,pm:0,icon:0,date:1,area:1,state:1,temperature:1,iconSize:80,borderSW:0,borderType:1,borderEffect:1,borderSpeed:1}:4==itemType?newMediaData={id:maxId+1,type:itemType,top:0,left:0,width:minWidth,height:minHeight,zIndex:maxZindex,dateFontSize:"12",timeFontSize:"12",timeFormat:"1",dateFormat:"2",weekFormat:"3",dateWeight:"0",weekWeight:"0",timeWeight:"0",fontFamily:"Arial",fontColor:"#000000",clockW:"80",yearShow:"1",monthShow:"1",dateShow:"1",hourShow:"1",minutesShow:"1",secondsShow:"1",weekShow:"1",borderSW:0,borderType:1,borderEffect:1,borderSpeed:1,clockType:1}:5==itemType?newMediaData={id:maxId+1,type:itemType,top:0,left:0,width:minWidth,height:minHeight,zIndex:maxZindex,siderType:"0",pauseTime:pauseTime,borderSW:0,borderType:1,borderEffect:1,borderSpeed:1,srcGroup:srcGroup}:9==itemType?newMediaData={id:maxId+1,type:itemType,top:0,left:0,width:minWidth,height:minHeight,zIndex:maxZindex,refreshTime:"0",refreshType:"0",href:"http://www.168led.com",borderSW:0,borderType:1,borderEffect:1,borderSpeed:1}:10==itemType?newMediaData={id:maxId+1,type:itemType,top:0,left:0,width:minWidth,height:minHeight,pauseTime:pauseTime,srcGroup:srcGroup,audioSW:1}:11==itemType?newMediaData={id:maxId+1,type:itemType,top:0,left:0,width:minWidth,height:minHeight,zIndex:maxZindex,refreshTime:"5",row:"5",titleShow:"1",titleText:"12121",titleFamily:"Arial",titleFontSize:"14",titleFontWeight:"normal",titleColor:"#ffffff",titleBg:"#ba0000",textFamily:"Arial",textFontSize:"14",textFontWeight:"normal",textColor:"#ffffff",textBg:"#858585",statemenTemplate01:"",statemenTemplate02:"号请到",statemenTemplate03:"号窗口办理",borderSW:0,borderType:1,borderEffect:1,borderSpeed:1}:12==itemType?newMediaData={id:maxId+1,type:itemType,top:0,left:0,width:minWidth,height:minHeight,zIndex:maxZindex,href:"http://www.168led.com",borderSW:0,borderType:1,borderEffect:1,borderSpeed:1}:13==itemType?newMediaData={id:maxId+1,type:itemType,top:0,left:0,width:minWidth,height:minHeight,zIndex:maxZindex,siderType:"0",siderDirection:"0",pauseTime:"5",textAlign:"",scrollSpeed:"0",listType:"",textShow:"0",isEdit:!1,borderSW:0,borderType:1,borderEffect:1,borderSpeed:1,srcGroup:srcGroup}:14==itemType?newMediaData={id:maxId+1,type:itemType,top:0,left:0,width:minWidth,height:minHeight,zIndex:maxZindex,fontFamily:"Arial",fontSize:14,lineNum:3,lineHeight:30,column:5,borderWidth:1,borderColor:"#f00",borderWrapSw:1,borderType:0,headerSw:1,dataUrl:"",refreshTime:60,html:'<table border="1" bordercolor="#f00" style="width:100%;border-collapse: collapse; border-color:#f00;line-height:30px;"><caption>我的标题</caption><tbody><tr><td style="height:30px;"></td><td style="height:30px;"></td><td style="height:30px;"></td><td style="height:30px;"></td><td style="height:30px;"></td></tr><tr><td style="height:30px;"></td><td style="height:30px;"></td><td style="height:30px;"></td><td style="height:30px;"></td><td  style="height:30px;"></td></tr><tr><td style="height:30px;"></td><td style="height:30px;"></td><td style="height:30px;"></td><td style="height:30px;"></td><td style="height:30px;"></td></tr></tbody></table>'}:15==itemType&&(newMediaData={id:maxId+1,type:itemType,top:0,left:0,width:minWidth,height:minHeight,zIndex:maxZindex,fontFamily:"Arial",fontColor:"#ff0000",fontSize:14,bgName:"",bgImg:"",dataUrl:"",refreshTime:60,srcGroup:[{id:(new Date).getTime(),dataVal:"dataName",left:50,top:50,width:100,height:30}]}),this.data.mediaEle.push(newMediaData),this.dataArryId.push(newMediaData.id),10!=itemType){var shtml=Editer_stage.tool.initEditareaItem(newMediaData);Editer_stage.tool.addEditerAreaData(shtml),Editer_stage.tool.changeEditareaItem(newMediaData.id),Editer_stage.areaDataShow.hideLeftSideBar(".editer-area-msg"),Editer_stage.tool.removeEditerItemSelect(),dragResize.addSelectPoint($("#controlItem_"+newMediaData.id)),dragResize.changeControlElemen($("#controlItem_"+newMediaData.id))}else 10==itemType&&Editer_stage.tool.showItemMsg(newMediaData.id,10)},Editer_stage.editAreaData.prototype.deleteMediaDataItem=function(index){this.data.mediaEle.splice(index,1)},Editer_stage.editAreaData.prototype.deleteMediaDataItemById=function(itemId){for(var mediaEle=this.data.mediaEle,len=mediaEle.length,itemIndex=null,i=0;i<len;i++){mediaEle[i].id==itemId&&(itemIndex=i)}null!==itemIndex&&this.deleteMediaDataItem(itemIndex)},Editer_stage.editAreaData.prototype.returnData=function(){return this.data},Editer_stage.editAreaData.prototype.judgeAudio=function(){for(var mediaEle=this.data.mediaEle,len=mediaEle.length,audioId=0,i=0;i<len;i++)10==mediaEle[i].type&&(audioId=mediaEle[i].id);return audioId},Editer_stage.editAreaData.prototype.returnDataAreaLen=function(){return this.data.mediaEle.length},Editer_stage.areaDataShow={editerInfo:"#editer-info-"},Editer_stage.areaDataShow.publicItem=function(typeName,dataId,arryIndex,w,h,l,t){var $leftSider=$(this.editerInfo+typeName);""!==dataId&&$leftSider.attr("data-id",dataId),""!==typeName&&$leftSider.attr("data-type",typeName),""!==arryIndex&&$leftSider.attr("data-arry",arryIndex),""!==w&&$leftSider.find("input[data-flag=width]").val(w),""!==h&&$leftSider.find("input[data-flag=height]").val(h),""!==l&&$leftSider.find("input[data-flag=left]").val(l),""!==t&&$leftSider.find("input[data-flag=top]").val(t)},Editer_stage.areaDataShow.judgeItemDataSize=function(flag,val,thisId){var maxWidth=1*Editer_stage.tool.getProgramResolutionWidth(),maxHeight=1*Editer_stage.tool.getProgramResolutionHeight(),returnVal=0,initData=editerDataStore.getMediaData(thisId),initWidth=1*initData.width,initLeft=(initData.height,1*initData.left),initTop=1*initData.top;if("width"===flag)returnVal=val+initLeft<maxWidth?val:maxWidth-initLeft;else if("height"===flag){returnVal=val+initTop<maxHeight?val:maxHeight-initTop}else if("left"===flag){returnVal=val+initWidth<maxWidth?val:maxWidth-initWidth}else"top"===flag&&(returnVal=val);return returnVal},Editer_stage.areaDataShow.judgeInputType=function(flag){switch(flag){case"tomShow":case"todayShow":case"afterShow":case"dateWeight":case"weekWeight":case"timeWeight":case"clockShow":case"dateShow":case"weekShow":case"timeShow":case"scale":case"wind":case"hum":case"air":case"pm":case"date":case"area":case"state":case"temperature":case"icon":case"yearShow":case"monthShow":case"dateShow":case"hourShow":case"minutesShow":case"secondsShow":case"weekShow":return!0}return!1},Editer_stage.areaDataShow.showLeftSideBar=function(typeName){var $leftSider=$(this.editerInfo+typeName);$leftSider.find("input").prop("checked",!1),Editer_stage.tool.showLayout("area"),$leftSider.addClass("active").siblings(".item").removeClass("active"),$(".editer-area-msg").addClass("silde-in"),$leftSider.find("input[name=changeVal]").unbind("input change").bind("input change",function(e){var $this=$(this),objParents=$this.parents("#editer-info-"+typeName),thisId=objParents.attr("data-id"),thisType=objParents.attr("data-type"),thisFlag=$this.attr("data-flag"),thisVal=$this.val();"information"===thisType?dnyTableObj&&dnyTableObj.inputChange(thisFlag,thisVal):"map"===thisType&&mapFigure&&mapFigure.inputChange(thisFlag,thisVal),editerDataStore.setMediaProjectData(thisId,thisFlag,thisVal),Editer_stage.tool.changeEditareaItemPrivate(thisFlag,thisId)}),$leftSider.find("input[name=inputVal]").unbind("input propertychange").bind("input propertychange",function(e){var $this=$(this),objParents=$this.parents("#editer-info-"+typeName),thisId=objParents.attr("data-id"),thisType=objParents.attr("data-type"),thisFlag=$this.attr("data-flag"),thisVal=$this.val(),itemId=$this.attr("data-itemid");if("clockType"===thisFlag);else if("videoName"===thisFlag){var mListItemId=$this.attr("data-itemid"),itemIndex=$this.attr("data-itemIndex"),itemSuffix=$this.attr("data-itemsuffix");""===thisVal&&(thisVal="未命名"),Editer_stage.tool.videoEditObj&&(Editer_stage.tool.videoEditObj.find(".title").text(thisVal+itemSuffix),Editer_stage.tool.videoEditObj.attr("data-editName",thisVal)),Editer_stage.tool.listSortUpDataSingle(thisId,itemIndex,mListItemId,thisVal)}else if("left"===thisFlag||"top"===thisFlag||"width"===thisFlag||"height"===thisFlag)thisVal=Editer_stage.areaDataShow.judgeItemDataSize(thisFlag,1*thisVal,thisId);else if("dataVal"===thisFlag){if("1"===$("#information-dataType").val()&&thisVal.match(/[^a-zA-Z]/g))return void layerOutAutoHid(lang.enterLetter)}else"mapItemLeft"===thisFlag?(editerDataStore.setMapMediaData(thisId,"",1*thisVal,"","","",itemId),Editer_stage.tool.setMapInitData("left",thisVal,itemId)):"mapItemTop"===thisFlag?(editerDataStore.setMapMediaData(thisId,"","",1*thisVal,"","",itemId),Editer_stage.tool.setMapInitData("top",thisVal,itemId)):"mapItemWidth"===thisFlag?(editerDataStore.setMapMediaData(thisId,"","","",1*thisVal,"",itemId),Editer_stage.tool.setMapInitData("width",thisVal,itemId)):"mapItemHeight"===thisFlag&&(editerDataStore.setMapMediaData(thisId,"","","","",1*thisVal,itemId),Editer_stage.tool.setMapInitData("height",thisVal,itemId));"information"===thisType?dnyTableObj&&dnyTableObj.inputChange(thisFlag,thisVal):"map"===thisType&&mapFigure&&mapFigure.inputChange(thisFlag,thisVal),editerDataStore.setMediaProjectData(thisId,thisFlag,thisVal),"left"!==thisFlag&&"top"!==thisFlag&&"width"!==thisFlag&&"height"!==thisFlag||Editer_stage.tool.changeEditareaItem(thisId),Editer_stage.tool.changeEditareaItemPrivate(thisFlag,thisId)}),$leftSider.find("select").unbind().change(function(){var $this=$(this),objParents=$this.parents("#editer-info-"+typeName),thisId=objParents.attr("data-id"),thisType=objParents.attr("data-type"),thisFlag=$this.attr("data-flag"),thisVal=$this.val();("text"===typeName&&"siderType"===thisFlag||"rtf"===typeName&&"siderType"===thisFlag)&&("0"===thisVal?(hideTextSelect("#"+typeName+"-scrollSpeed"),showTextSelect("#"+typeName+"-pauseTime")):"2"===thisVal||"4"===thisVal?(showTextSelect("#"+typeName+"-scrollSpeed"),hideTextSelect("#"+typeName+"-pauseTime")):(showTextSelect("#"+typeName+"-scrollSpeed"),showTextSelect("#"+typeName+"-pauseTime"))),"information"===thisType?dnyTableObj&&dnyTableObj.inputChange(thisFlag,thisVal):"map"===thisType&&mapFigure&&mapFigure.inputChange(thisFlag,thisVal),editerDataStore.setMediaProjectData(thisId,thisFlag,thisVal),Editer_stage.tool.changeEditareaItemPrivate(thisFlag,thisId)})},Editer_stage.areaDataShow.hideLeftSideBar=function(obj){var $article=$(obj);$article.removeClass("silde-in").addClass("silde-out"),setTimeout(function(){$article.removeClass("silde-out")},200)},Editer_stage.areaDataShow.showItemPrivateMsg=function(id,typeId,data){var thisTypeName=Editer_stage.tool.getMediaType(typeId),$leftSider=$(this.editerInfo+thisTypeName),$siderTypeInput=$leftSider.find("input[data-flag=siderType]"),$pauseTimeInput=$leftSider.find("input[data-flag=pauseTime]"),$rotationInput=$leftSider.find("select[data-flag=rotation]");if(0===typeId){var itemRotation=data.rotation;$rotationInput.val(itemRotation)}else if(1===typeId){var itemSiderType=data.siderType,itemPauseTime=data.pauseTime;itemRotation=data.rotation;$siderTypeInput.val(itemSiderType),$pauseTimeInput.val(itemPauseTime),$rotationInput.val(itemRotation)}},Editer_stage.dragResize=function(param){this.offSetX=0,this.offSetY=0,this.initX=0,this.initY=0,this.initW=0,this.initH=0,this.initL=0,this.initT=0,this.isMove=!1,this.resizeElement=!1,this.moevElement=!1,this.editerAreaIsMove=!1,this.editerArea=param.editerArea,this.panel=param.panel,this.resizeDirection=["dragResize-n","dragResize-s","dragResize-w","dragResize-e","dragResize-ne","dragResize-nw","dragResize-se","dragResize-sw"],this.objContextmenu=param.objContextmenu,this.resolutionWidth=1*param.resolutionWidth,this.resolutionHeight=1*param.resolutionHeight,this.eventDown=param.eventDown,this.eventUp=param.eventUp,this.eventMove=param.eventMove,this.touchtime=(new Date).getTime(),this.currentX="#current-positionX",this.currentY="#current-positionY",this.currentW="#current-positionW",this.currentH="#current-positionH",this.currentZ="#current-positionZ"},Editer_stage.dragResize.prototype.findMoveElement=function(elem){for(var moveElem,resizeElem;elem;)if(elem.className&&-1<elem.className.indexOf("dragResize"))for(resizeElem=elem;elem;){if("item"===elem.className){moveElem=elem;break}elem=elem.parentNode}else{if("item"===elem.className){moveElem=elem;break}if("editerCanvas-main"===elem.className||"editerCanvas"===elem.className){moveElem="editerCanvas"===elem.className?$(elem).find(".editerCanvas-main")[0]:elem;break}elem=elem.parentNode}return{moveElement:moveElem,resizeElement:resizeElem}},Editer_stage.dragResize.prototype.findControlElement=function(elem){for(var obj;elem;){if($(elem).attr("data-type")){obj=elem;break}elem=elem.parentNode}return{controlElement:obj}},Editer_stage.dragResize.prototype.changeControlElemen=function(elem){this.moevElement=elem},Editer_stage.dragResize.prototype.addMouseDown=function(){var objElem,_this=this;$(_this.panel).off(_this.eventDown).on(_this.eventDown,function(elem){var moveElement,resizeElement,elemTarget=(elem=_this.getEvent(elem)).target,$moveElem=null;if(moveElement=(objElem=_this.findMoveElement(elemTarget)).moveElement,resizeElement=objElem.resizeElement,($moveElem=$(moveElement))&&_this.moevElement[0]!==$moveElem[0]&&_this.deleteSelectPoint(_this.moevElement),moveElement){var moveElementName=moveElement.className;if("item"===moveElementName){var dataDrag=$moveElem.attr("data-drag"),type=$moveElem.attr("data-type");_this.moevElement=$moveElem,_this.isMove="false"!==dataDrag,0===$moveElem.find(".dragResize").length&&_this.addSelectPoint($moveElem),_this.isMove&&$moveElem.css({cursor:"move",opacity:.9}),_this.setOnElemInfo($moveElem.attr("data-id")),Editer_stage.tool.showAreaTool(),"0"===type||"1"===type||"2"===type||"13"===type?Editer_stage.tool.showAreaBorderTool():Editer_stage.tool.hideAreaBorderTool()}else"editerCanvas-main"!==moveElementName&&"editerCanvas"!==moveElementName||(_this.editerAreaIsMove=!0,_this.moevElement="editerCanvas"===moveElementName?$moveElem.find(".editerCanvas-main"):$moveElem,$(".current-text").text(0),Editer_stage.tool.hideAreaTool(),Editer_stage.tool.hideAreaBorderTool());_this.initW=Math.round($moveElem.width()),_this.initH=Math.round($moveElem.height()),_this.initT=Math.round($moveElem[0].offsetTop),_this.initL=Math.round($moveElem[0].offsetLeft),_this.initX=Math.round(_this.getPageX(elem)),_this.initY=Math.round(_this.getPageY(elem)),_this.offsetX=_this.initX-_this.initL,_this.offsetY=_this.initY-_this.initT}else $(".current-text").text(0),_this.moevElement&&(_this.deleteSelectPoint(_this.moevElement),_this.moevElement=!1),Editer_stage.tool.hideAreaTool(),Editer_stage.tool.hideAreaBorderTool();_this.resizeElement=resizeElement||!1,_this.preventDefault(elem)})},Editer_stage.dragResize.prototype.getPageX=function(elem){var pageX=0;return elem&&(pageX=IsPC()?elem.pageX:elem.touches[0].pageX),pageX},Editer_stage.dragResize.prototype.getPageY=function(elem){var pageY=0;return elem&&(pageY=IsPC()?elem.pageY:elem.touches[0].pageY),pageY},Editer_stage.dragResize.prototype.addMouseMove=function(){var _this=this;$(_this.panel).off(_this.eventMove).on(_this.eventMove,function(elem){elem=_this.getEvent(elem);var x=_this.getPageX(elem)-_this.initX,y=_this.getPageY(elem)-_this.initY,editerAreaW=$(_this.editerArea).width(),editerAreaH=$(_this.editerArea).height();if(_this.isMove&&_this.moevElement){var thisTypeName=Editer_stage.tool.getMediaType(1*_this.moevElement.attr("data-type")),thisId=_this.moevElement.attr("data-id"),thisArryIndex=_this.moevElement.attr("data-arry");if(_this.resizeElement){var resizeElementName=_this.resizeElement.className,moveElemTop=_this.moevElement.position().top,editAreaTop=(_this.moevElement.position().left,Math.round($(_this.editerArea).position().top)),editAreaLeft=Math.round($(_this.editerArea).position().left);if(0<=resizeElementName.indexOf("dragResize-n")||0<=resizeElementName.indexOf("dragResize-nw")||0<=resizeElementName.indexOf("dragResize-ne")){var storNum=0;(dragT=_this.getPageY(elem)-_this.offsetY)<0&&(dragT=0),dragT<_this.initT+_this.initH&&(dragT<_this.initT?storNum=_this.initH+(_this.initT-dragT):moveElemTop<dragT&&(storNum=_this.initH-(dragT-_this.initT)),0<storNum&&(_this.initH=storNum),_this.initT=dragT)}if(0<=resizeElementName.indexOf("dragResize-nw")||0<=resizeElementName.indexOf("dragResize-w")||0<=resizeElementName.indexOf("dragResize-sw")){storNum=0;(dragL=_this.getPageX(elem)-_this.offsetX)<0&&(dragL=0),dragL<_this.initL+_this.initW&&(dragL<_this.initL?storNum=_this.initW+(_this.initL-dragL):dragL>_this.initL&&(storNum=_this.initW-(dragL-_this.initL)),0<storNum&&(_this.initW=storNum),_this.initL=dragL)}if(0<=resizeElementName.indexOf("dragResize-ne")||0<=resizeElementName.indexOf("dragResize-se")||0<=resizeElementName.indexOf("dragResize-e")){var dragW=_this.getPageX(elem)-editAreaLeft;storNum=0;editerAreaW<dragW&&(dragW=editerAreaW),0<(storNum=dragW-_this.initL)&&(_this.initW=storNum)}if(0<=resizeElementName.indexOf("dragResize-s")||0<=resizeElementName.indexOf("dragResize-se")||0<=resizeElementName.indexOf("dragResize-sw")){var dragH=_this.getPageY(elem)-editAreaTop;storNum=0;editerAreaH<dragH&&(dragH=editerAreaH),0<(storNum=dragH-_this.initT)&&(_this.initH=storNum)}var conversionData=Editer_stage.tool.conversion(_this.initW,_this.initH,_this.initL,_this.initT);Editer_stage.areaDataShow.publicItem(thisTypeName,thisId,thisArryIndex,conversionData.width,conversionData.height,conversionData.left,conversionData.top),conversionData&&editerDataStore.setMediaData(thisId,conversionData.width,conversionData.height,conversionData.left,conversionData.top),_this.moevElement.css({left:_this.initL,top:_this.initT,height:_this.initH,width:_this.initW})}else{var dragL=_this.initL+x,dragT=_this.initT+y,maxL=editerAreaW-_this.initW,maxT=editerAreaH-_this.initH;dragL<0&&(dragL=0),maxL<dragL&&(dragL=maxL),dragT<0&&(dragT=0),maxT<dragT&&(dragT=maxT);conversionData=Editer_stage.tool.conversion(_this.initW,_this.initH,dragL,dragT);Editer_stage.areaDataShow.publicItem(thisTypeName,thisId,thisArryIndex,"","",conversionData.left,conversionData.top),conversionData&&editerDataStore.setMediaData(thisId,"","",conversionData.left,conversionData.top),_this.moevElement.css({top:dragT,left:dragL})}_this.setOnElemInfo(thisId)}if(_this.editerAreaIsMove){dragL=_this.initL+x,dragT=_this.initT+y;_this.moevElement.css({top:dragT,left:dragL})}_this.preventDefault(elem)})},Editer_stage.dragResize.prototype.addMouseUp=function(){var _this=this;$(_this.panel).unbind(_this.eventUp).bind(_this.eventUp,function(elem){elem=_this.getEvent(elem),_this.isMove&&_this.moevElement&&(_this.isMove=!1,_this.moevElement.css({cursor:"pointer",opacity:1})),_this.editerAreaIsMove&&(_this.editerAreaIsMove=!1,_this.moevElement.css("cursor","pointer")),_this.preventDefault(elem)})},Editer_stage.dragResize.prototype.addDbClick=function(){var _this=this,touchtime=0,touchStarTime=0;$(_this.panel).bind("touchstart",function(elem){var elemTarget=(elem=_this.getEvent(elem)).target,moveElement=_this.findMoveElement(elemTarget).moveElement;"controlItem"!==moveElement.className&&"item"!==moveElement.className||(touchStarTime=(new Date).getTime())}),$(_this.panel).bind("touchend",function(elem){var nowClick=(new Date).getTime(),elemTarget=(elem=_this.getEvent(elem)).target,moveElement=_this.findMoveElement(elemTarget).moveElement;if(600<=nowClick-touchStarTime&&nowClick-touchStarTime<=1e3){moveElement&&"controlItem"===moveElement.className&&(Editer.extend(moveElement,dragResize.findControlElement(elemTarget)),moveElement.event=elem,touchStarTime=0)}else{if(nowClick-touchtime<=300)if(moveElement)if("item"===moveElement.className){var moveElementId=$(moveElement).attr("data-id"),moveElementTypeId=1*$(moveElement).attr("data-type");0===moveElementTypeId||1===moveElementTypeId?Editer_stage.tool.showItemMsg(moveElementId,moveElementTypeId):Editer_stage.tool.toast("暂不支持编辑")}touchtime=nowClick}})},Editer_stage.dragResize.prototype.getElemByBorder=function(){return this.moevElement},Editer_stage.dragResize.prototype.addSelectPoint=function(elem){0<$(elem).find(".dragResize").length&&$(elem).find(".dragResize").remove();for(var i=0,len=this.resizeDirection.length;i<len;i++){var setPoint=$('<div class="dragResize '+this.resizeDirection[i]+'"></div>');$(elem).append(setPoint)}},Editer_stage.dragResize.prototype.deleteSelectPoint=function(elem){0<$(elem).find(".dragResize").length&&$(elem).find(".dragResize").remove()},Editer_stage.dragResize.prototype.addContextMenu=function(elem){var _this=this;$(_this.panel).unbind("contextmenu").bind("contextmenu",function(elem){var elemTarget=(elem=elem||window.event).target,moveElement=_this.findMoveElement(elemTarget).moveElement;moveElement&&("controlItem"===moveElement.className&&(Editer.extend(moveElement,_this.findControlElement(elemTarget)),moveElement.event=elem,_this.objContextmenu&&_this.objContextmenu(moveElement)));_this.preventDefault(elem)})},Editer_stage.dragResize.prototype.addHandler=function(element,type,handler){element.addEventListener?element.addEventListener(type,handler,!1):element.attachEvent?element.attachEvent("on"+type,handler):element["on"+type]=handler},Editer_stage.dragResize.prototype.removeHandler=function(element,type,handler){element.removeEventListener?element.removeEventListener(type,handler,!1):element.detachEvent?element.detachEvent("on"+type,handler):element["on"+type]=null},Editer_stage.dragResize.prototype.getTarget=function(event){return event.target||event.srcElement},Editer_stage.dragResize.prototype.getWheelDelta=function(event){return event.wheelDelta?event.wheelDelta:40*-event.detail},Editer_stage.dragResize.prototype.onWheel=function(event){var _this=Editer_stage.dragResize.prototype;event=_this.getEvent(event);var curElem=_this.getTarget(event),delta=(parseInt(curElem.value),_this.getWheelDelta(event)),thisZoom=Editer_stage.tool.getZoom();if(0<delta){if(curElem.value=10,0<thisZoom&&thisZoom<500){var changeZoom=1*thisZoom+1*curElem.value;Editer_stage.tool.siderbuildEditerArea(changeZoom),Editer_stage.tool.setZoom(changeZoom),Editer_stage.tool.setTopSlider(changeZoom)}}else if(curElem.value=-10,10<thisZoom){changeZoom=1*thisZoom+1*curElem.value;Editer_stage.tool.siderbuildEditerArea(changeZoom),Editer_stage.tool.setZoom(changeZoom),Editer_stage.tool.setTopSlider(changeZoom)}_this.preventDefault(event)},Editer_stage.dragResize.prototype.setOnElemInfo=function(id){var jsonData=editerDataStore.getMediaData(id),left=jsonData.left,top=jsonData.top,width=jsonData.width,height=jsonData.height,zIndex=jsonData.zIndex;$(this.currentX).text(left),$(this.currentY).text(top),$(this.currentW).text(width),$(this.currentH).text(height),$(this.currentZ).text(zIndex)},Editer_stage.dragResize.prototype.getEvent=function(event){return event||window.event},Editer_stage.dragResize.prototype.preventDefault=function(event){event&&event.preventDefault?event.preventDefault():event.returnValue=!1},Editer_stage.dragResize.prototype.delete=function(){var elem=this.moevElement,itemId=this.moevElement.attr("data-id");editerDataStore.deleteMediaDataItemById(itemId),Editer_stage.tool.removeEditerItem(elem)},Editer_stage.dragResize.prototype.lock=function(){this.moevElement.attr("data-drag","false")},Editer_stage.dragResize.prototype.unlock=function(){this.moevElement.attr("data-drag","true")},Editer_stage.dragResize.prototype.upZindex=function(){var zIndex=this.moevElement.css("z-index"),thisItemId=this.moevElement.attr("data-id");zIndex=(zIndex=1*zIndex+1)<0?0:zIndex,this.moevElement.css("z-index",zIndex),Editer_stage.tool.setAreaZindex(zIndex),editerDataStore.setMediaProjectData(thisItemId,"zIndex",zIndex)},Editer_stage.dragResize.prototype.downZindex=function(){var zIndex=this.moevElement.css("z-index"),thisItemId=this.moevElement.attr("data-id");zIndex=(zIndex=1*zIndex-1)<0?0:zIndex,this.moevElement.css("z-index",zIndex),Editer_stage.tool.setAreaZindex(zIndex),editerDataStore.setMediaProjectData(thisItemId,"zIndex",zIndex)},Editer_stage.dragResize.prototype.fullScreen=function(){var thisItemId=this.moevElement.attr("data-id"),nowZoom=Editer_stage.tool.calculateZoom(Editer_stage.tool.getZoom()),thisItemWidth=this.resolutionWidth*nowZoom,thisItemHeight=this.resolutionHeight*nowZoom,thisItemTypeId=1*this.moevElement.attr("data-type"),thisItemTypeName=Editer_stage.tool.getMediaType(thisItemTypeId);this.moevElement.css({width:thisItemWidth+"px",height:thisItemHeight+"px",left:"0px",top:"0px"}),editerDataStore.setMediaProjectData(thisItemId,"width",this.resolutionWidth),editerDataStore.setMediaProjectData(thisItemId,"height",this.resolutionHeight),editerDataStore.setMediaProjectData(thisItemId,"left",0),editerDataStore.setMediaProjectData(thisItemId,"top",0),Editer_stage.areaDataShow.publicItem(thisItemTypeName,"","",this.resolutionWidth,this.resolutionHeight,0,0)},Editer_stage.dragResize.prototype.alignLeft=function(){var thisItemId=this.moevElement.attr("data-id"),thisItemTypeId=1*this.moevElement.attr("data-type"),thisItemTypeName=Editer_stage.tool.getMediaType(thisItemTypeId);this.moevElement.css("left","0px"),editerDataStore.setMediaProjectData(thisItemId,"left",0),Editer_stage.areaDataShow.publicItem(thisItemTypeName,"","","","",0,"")},Editer_stage.dragResize.prototype.alignRight=function(){var thisItemId=this.moevElement.attr("data-id"),thisItemWidth=1*editerDataStore.getMediaData(thisItemId).width,nowZoom=Editer_stage.tool.calculateZoom(Editer_stage.tool.getZoom()),thisItemLeft=this.resolutionWidth-thisItemWidth,thisItemEditerLeft=parseInt(thisItemLeft*nowZoom)+"px",thisItemTypeId=1*this.moevElement.attr("data-type"),thisItemTypeName=Editer_stage.tool.getMediaType(thisItemTypeId);this.moevElement.css("left",thisItemEditerLeft),editerDataStore.setMediaProjectData(thisItemId,"left",thisItemLeft),Editer_stage.areaDataShow.publicItem(thisItemTypeName,"","","","",thisItemLeft,"")},Editer_stage.dragResize.prototype.alignXCenter=function(){var thisItemId=this.moevElement.attr("data-id"),thisItemWidth=1*editerDataStore.getMediaData(thisItemId).width,nowZoom=Editer_stage.tool.calculateZoom(Editer_stage.tool.getZoom()),thisItemLeft=(this.resolutionWidth-thisItemWidth)/2,thisItemEditerLeft=parseInt(thisItemLeft*nowZoom)+"px",thisItemTypeId=1*this.moevElement.attr("data-type"),thisItemTypeName=Editer_stage.tool.getMediaType(thisItemTypeId);this.moevElement.css("left",thisItemEditerLeft),editerDataStore.setMediaProjectData(thisItemId,"left",thisItemLeft),Editer_stage.areaDataShow.publicItem(thisItemTypeName,"","","","",thisItemLeft,"")},Editer_stage.dragResize.prototype.alignYCenter=function(){var thisItemId=this.moevElement.attr("data-id"),thisItemHeight=editerDataStore.getMediaData(thisItemId).height,nowZoom=Editer_stage.tool.calculateZoom(Editer_stage.tool.getZoom()),thisItemTop=(this.resolutionHeight-thisItemHeight)/2,thisItemEditerTop=parseInt(thisItemTop*nowZoom)+"px",thisItemTypeId=1*this.moevElement.attr("data-type"),thisItemTypeName=Editer_stage.tool.getMediaType(thisItemTypeId);this.moevElement.css("top",thisItemEditerTop),editerDataStore.setMediaProjectData(thisItemId,"top",thisItemTop),Editer_stage.areaDataShow.publicItem(thisItemTypeName,"","","","","",thisItemTop)},Editer_stage.dragResize.prototype.alignTop=function(){var thisItemId=this.moevElement.attr("data-id"),thisItemTypeId=1*this.moevElement.attr("data-type"),thisItemTypeName=Editer_stage.tool.getMediaType(thisItemTypeId);this.moevElement.css("top","0px"),editerDataStore.setMediaProjectData(thisItemId,"top",0),Editer_stage.areaDataShow.publicItem(thisItemTypeName,"","","","","",0)},Editer_stage.dragResize.prototype.alignBottom=function(){var thisItemId=this.moevElement.attr("data-id"),thisItemHeight=1*editerDataStore.getMediaData(thisItemId).height,nowZoom=Editer_stage.tool.calculateZoom(Editer_stage.tool.getZoom()),thisItemTop=this.resolutionHeight-thisItemHeight,thisItemEditerTop=parseInt(thisItemTop*nowZoom)+"px",thisItemTypeId=1*this.moevElement.attr("data-type"),thisItemTypeName=Editer_stage.tool.getMediaType(thisItemTypeId);this.moevElement.css("top",thisItemEditerTop),editerDataStore.setMediaProjectData(thisItemId,"top",thisItemTop),Editer_stage.areaDataShow.publicItem(thisItemTypeName,"","","","","",thisItemTop)},Editer_stage.dragResize.prototype.upToFirst=function(){var zIndex=this.moevElement.css("z-index"),thisItemId=this.moevElement.attr("data-id"),areaLen=editerDataStore.returnDataAreaLen(),areaMaxIndex=editerDataStore.getMaxZindex();zIndex==areaMaxIndex&&areaLen<areaMaxIndex?Editer_stage.tool.toast("当前已处于最顶层！"):(zIndex=areaMaxIndex+1,Editer_stage.tool.setAreaZindex(zIndex),this.moevElement.css("z-index",zIndex),editerDataStore.setMediaProjectData(thisItemId,"zIndex",zIndex))},Editer_stage.dragResize.prototype.upToLast=function(){var thisItemId=this.moevElement.attr("data-id");this.moevElement.css("z-index",0),Editer_stage.tool.setAreaZindex(0),editerDataStore.setMediaProjectData(thisItemId,"zIndex",0)},Editer_stage.dragResize.prototype.addMouseListener=function(){this.addMouseDown(),this.addMouseUp(),this.addMouseMove(),this.addContextMenu(),this.addDbClick()};